{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83d\udcca Bienvenue au Cours SQL","text":"<p>Bienvenue dans le parcours d'apprentissage SQL structur\u00e9 en cinq modules progressifs. Chaque module explore des concepts cl\u00e9s \u00e0 travers des exercices pratiques et des bases de donn\u00e9es r\u00e9elles.</p>"},{"location":"#contenu-du-cours","title":"\ud83d\uddc2\ufe0f Contenu du Cours","text":""},{"location":"#cours-1-les-fondamentaux-du-sql","title":"\ud83d\udcd6 Cours 1 : Les Fondamentaux du SQL","text":"<ul> <li>Objectif : Ma\u00eetriser les bases essentielles du SQL et comprendre les concepts fondamentaux.</li> <li>Th\u00e8mes abord\u00e9s :<ul> <li>Requ\u00eates de base (SELECT, FROM, WHERE)</li> <li>Filtrage et tri des donn\u00e9es (ORDER BY, LIMIT)</li> <li>Op\u00e9rateurs de comparaison et logiques</li> </ul> </li> <li>Exercices pratiques :<ul> <li>Cyberchase : Premiers pas avec SELECT</li> <li>Normals : Filtrage et analyse de donn\u00e9es m\u00e9t\u00e9o</li> <li>Players : Tri et filtrage de donn\u00e9es sportives</li> <li>Views : Introduction aux vues SQL</li> </ul> </li> </ul>"},{"location":"#cours-2-requetes-avancees-et-agregations","title":"\ud83d\udcca Cours 2 : Requ\u00eates Avanc\u00e9es et Agr\u00e9gations","text":"<ul> <li>Objectif : Ma\u00eetriser les fonctions d'agr\u00e9gation et les jointures.</li> <li>Th\u00e8mes abord\u00e9s :<ul> <li>Fonctions d'agr\u00e9gation (COUNT, SUM, AVG, MAX, MIN)</li> <li>Groupement de donn\u00e9es (GROUP BY, HAVING)</li> <li>Jointures (INNER JOIN, LEFT JOIN, RIGHT JOIN)</li> </ul> </li> <li>Exercices pratiques :<ul> <li>DESE : Analyse de donn\u00e9es \u00e9ducatives</li> <li>Moneyball : Statistiques avanc\u00e9es baseball</li> <li>Packages : Gestion de d\u00e9pendances</li> </ul> </li> </ul>"},{"location":"#cours-3-modelisation-et-performance","title":"\ud83d\udcc8 Cours 3 : Mod\u00e9lisation et Performance","text":"<ul> <li>Objectif : Optimiser les requ\u00eates et concevoir des sch\u00e9mas efficaces.</li> <li>Th\u00e8mes abord\u00e9s :<ul> <li>Conception de sch\u00e9mas de base de donn\u00e9es</li> <li>Indexation et optimisation des performances</li> <li>Contraintes et int\u00e9grit\u00e9 des donn\u00e9es</li> </ul> </li> <li>Exercices pratiques :<ul> <li>ATL : Optimisation de requ\u00eates a\u00e9roportuaires</li> <li>Connect : Mod\u00e9lisation relationnelle</li> <li>Doghnut : Indexation et performance</li> </ul> </li> </ul>"},{"location":"#cours-4-manipulation-avancee-des-donnees","title":"\ud83d\udd0d Cours 4 : Manipulation Avanc\u00e9e des Donn\u00e9es","text":"<ul> <li>Objectif : Ma\u00eetriser les op\u00e9rations complexes sur les donn\u00e9es.</li> <li>Th\u00e8mes abord\u00e9s :<ul> <li>Sous-requ\u00eates et requ\u00eates corr\u00e9l\u00e9es</li> <li>Fen\u00eatrage (WINDOW functions)</li> <li>Transactions et gestion des erreurs</li> </ul> </li> <li>Exercices pratiques :<ul> <li>Don't Panic : Gestion d'incidents syst\u00e8me</li> <li>M\u00e9t\u00e9orites : Analyse de donn\u00e9es scientifiques</li> </ul> </li> </ul>"},{"location":"#cours-5-projet-final-et-cas-pratiques","title":"\ud83d\ude80 Cours 5 : Projet Final et Cas Pratiques","text":"<ul> <li>Objectif : Appliquer l'ensemble des comp\u00e9tences acquises sur un projet complet.</li> <li>Th\u00e8mes abord\u00e9s :<ul> <li>Conception compl\u00e8te d'une base de donn\u00e9es</li> <li>Optimisation globale des performances</li> <li>Mise en place de bonnes pratiques</li> </ul> </li> <li>Projet final :<ul> <li>Cr\u00e9ation d'un syst\u00e8me de gestion de donn\u00e9es</li> <li>D\u00e9veloppement de requ\u00eates complexes</li> <li>Documentation et maintenance</li> </ul> </li> </ul>"},{"location":"#instructions-generales","title":"\ud83d\udccc Instructions G\u00e9n\u00e9rales","text":"<ol> <li>Suivez les modules dans l'ordre propos\u00e9 pour une progression optimale</li> <li>Chaque exercice inclut :</li> <li>Une base de donn\u00e9es d'exemple</li> <li>Des instructions d\u00e9taill\u00e9es</li> <li>Des solutions comment\u00e9es</li> <li>Pratiquez r\u00e9guli\u00e8rement avec les exercices fournis</li> <li>N'h\u00e9sitez pas \u00e0 revenir sur les concepts pr\u00e9c\u00e9dents si n\u00e9cessaire</li> </ol> <p>Bon apprentissage ! \ud83c\udfaf</p>"},{"location":"cours1/","title":"Cours 1 : Query","text":"<ul> <li> <p>Introduction</p> </li> <li> <p>Qu'est-ce qu'une base de donn\u00e9es ?</p> </li> <li> <p>SQL</p> </li> <li> <p>D\u00e9marrer avec SQLite</p> </li> <li> <p>Conseils pour le terminal</p> </li> <li> <p><code>SELECT</code></p> </li> <li> <p><code>LIMIT</code></p> </li> <li> <p><code>WHERE</code></p> </li> <li> <p><code>NULL</code></p> </li> <li> <p><code>LIKE</code></p> </li> <li> <p><code>BETWEEN</code></p> </li> <li> <p><code>ORDER BY</code></p> </li> <li> <p>Fonctions d'agr\u00e9gation</p> </li> </ul>"},{"location":"cours1/#video-en-anglais-facultatif","title":"Vid\u00e9o en anglais (facultatif)","text":""},{"location":"cours1/#introduction","title":"Introduction","text":"<ul> <li> <p>Les bases de donn\u00e9es (et SQL) sont des outils qui peuvent \u00eatre utilis\u00e9s pour interagir avec, stocker et g\u00e9rer des informations. </p> </li> <li> <p>Un tableau stocke un ensemble d'informations</p> </li> <li>Chaque ligne d'un tableau stocke un \u00e9l\u00e9ment de cet ensemble</li> <li> <p>Chaque colonne a un attribut de cet \u00e9l\u00e9ment</p> </li> <li> <p>Consid\u00e9rons maintenant un contexte moderne. Disons que vous \u00eates biblioth\u00e9caire et que vous devez organiser des informations sur les titres de livres et les auteurs dans ce diagramme.</p> </li> </ul> <p></p> <ul> <li>Une fa\u00e7on d'organiser les informations serait d'avoir chaque titre de livre suivi de son auteur, comme ci-dessous.</li> </ul> <p></p> <ul> <li>Notez que chaque livre est maintenant une ligne dans ce tableau.</li> <li>Chaque ligne a deux colonnes - chacune un attribut diff\u00e9rent du livre (titre du livre et auteur).</li> <li>\u00c0 l'\u00e8re de l'information d'aujourd'hui, nous pouvons stocker nos tableaux en utilisant des logiciels comme Google Sheets au lieu de papier\ud83d\udcdd ou de tablettes en pierre\ud83e\udea8. Cependant, dans ce cours, nous parlerons de bases de donn\u00e9es et non de feuilles de calcul.</li> <li>Trois raisons de passer des feuilles de calcul aux bases de donn\u00e9es sont :<ul> <li>\u00c9chelle : Les bases de donn\u00e9es peuvent stocker non seulement des \u00e9l\u00e9ments se comptant par dizaines de milliers, mais aussi des millions et des milliards.</li> <li>Capacit\u00e9 de mise \u00e0 jour : Les bases de donn\u00e9es sont capables de g\u00e9rer plusieurs mises \u00e0 jour de donn\u00e9es par seconde.</li> <li>Vitesse : Les bases de donn\u00e9es permettent une recherche plus rapide des informations. Cela est d\u00fb au fait que les bases de donn\u00e9es nous donnent acc\u00e8s \u00e0 diff\u00e9rents algorithmes pour r\u00e9cup\u00e9rer des informations. En revanche, les feuilles de calcul qui permettent uniquement l'utilisation de Ctrl+F ou Cmd+F pour parcourir les r\u00e9sultats un par un.</li> </ul> </li> </ul>"},{"location":"cours1/#base-de-donnees","title":"Base de donn\u00e9es","text":"<ul> <li>Une base de donn\u00e9es est un moyen d'organiser des donn\u00e9es de mani\u00e8re \u00e0 pouvoir effectuer quatre op\u00e9rations CRUD:<ul> <li>CREATE</li> <li>READ</li> <li>UPDATE</li> <li>DELETE</li> </ul> </li> <li>Un syst\u00e8me de gestion de base de donn\u00e9es (DBMS: DataBase Managment System) est un moyen d'interagir avec une base de donn\u00e9es en utilisant une interface graphique ou un langage textuel.</li> <li>Exemples de DBMS : MySQL, Oracle, PostgreSQL, SQLite, Microsoft Access, MongoDB, etc.</li> <li>Le choix d'un DBMS repose sur des facteurs tels que :<ul> <li>Co\u00fbt : logiciel propri\u00e9taire vs logiciel gratuit,</li> <li>Quantit\u00e9 de support : les logiciels libres et open source comme MySQL, PostgreSQL et SQLite ont l'inconv\u00e9nient de devoir configurer la base de donn\u00e9es soi-m\u00eame,</li> <li>Poids : les syst\u00e8mes plus complets comme MySQL ou PostgreSQL sont plus lourds et n\u00e9cessitent plus de calcul pour fonctionner que les syst\u00e8mes comme SQLite.</li> </ul> </li> <li>Dans ce cours, nous commencerons par SQLite.</li> </ul>"},{"location":"cours1/#sql","title":"SQL","text":"<ul> <li>SQL signifie Structured Query Language. C'est un langage utilis\u00e9 pour interagir avec les bases de donn\u00e9es, par lequel vous pouvez cr\u00e9er, lire, mettre \u00e0 jour et supprimer des donn\u00e9es dans une base de donn\u00e9es. Quelques points importants sur SQL :<ul> <li>il est structur\u00e9, comme nous le verrons dans ce cours,</li> <li>il a certains mots-cl\u00e9s qui peuvent \u00eatre utilis\u00e9s pour interagir avec la base de donn\u00e9es, et</li> <li>c'est un langage de requ\u00eate - il peut \u00eatre utilis\u00e9 pour poser des questions sur les donn\u00e9es \u00e0 l'int\u00e9rieur d'une base de donn\u00e9es.</li> </ul> </li> <li>Dans cette le\u00e7on, nous allons apprendre \u00e0 \u00e9crire quelques requ\u00eates SQL simples.</li> </ul>"},{"location":"cours1/#questions","title":"Questions","text":"<p>Existe-t-il des sous-ensembles de SQL ?</p> <ul> <li>SQL est une norme \u00e0 la fois de l'American National Standards Institute (ANSI) et de l'Organisation internationale de normalisation (ISO). La plupart des DBMS supportent un sous-ensemble du langage SQL. Par exemple, pour SQLite, nous utilisons un sous-ensemble de SQL qui est support\u00e9 par SQLite. Si nous voulions porter notre code vers un autre syst\u00e8me comme MySQL, il est probable que nous devrions changer une partie de la syntaxe.</li> </ul>"},{"location":"cours1/#sqlite","title":"SQLite","text":"<ul> <li>Il est utile de noter que SQLite n'est pas seulement quelque chose que nous utilisons pour ce cours, mais une base de donn\u00e9es utilis\u00e9e dans de nombreuses autres applications, y compris les t\u00e9l\u00e9phones, les applications de bureau et les sites web.</li> </ul>"},{"location":"cours1/#terminal","title":"Terminal","text":"<p>Voici quelques conseils utiles pour \u00e9crire du code SQL sur le terminal.</p> <ul> <li>Pour effacer l'\u00e9cran du terminal, appuyez sur Ctrl + L.</li> <li>Pour obtenir la ou les instructions pr\u00e9c\u00e9demment ex\u00e9cut\u00e9es sur le terminal, appuyez sur la touche fl\u00e9ch\u00e9e vers le haut.</li> <li>Si votre requ\u00eate SQL est trop longue et s'enroule autour du terminal, vous pouvez appuyer sur Entr\u00e9e et continuer \u00e0 \u00e9crire la requ\u00eate sur la ligne suivante.</li> <li>Pour quitter une base de donn\u00e9es ou l'environnement SQLite, utilisez <code>.quit</code>.</li> <li>Pour visualiser les diff\u00e9rents tableaux dans la base de donn\u00e9es utilisiez <code>.tables</code></li> <li><code>.mode column</code> permet une visualisation plus facile.</li> </ul>"},{"location":"cours1/#select","title":"<code>SELECT</code>","text":"<ul> <li>Quelles donn\u00e9es sont r\u00e9ellement dans notre base de donn\u00e9es ? Pour r\u00e9pondre \u00e0 cette question, nous allons utiliser notre premier mot-cl\u00e9 SQL, <code>SELECT</code>, qui nous permet de s\u00e9lectionner certaines (ou toutes) lignes d'un tableau \u00e0 l'int\u00e9rieur de la base de donn\u00e9es.</li> <li>Dans l'environnement SQLite, ex\u00e9cutez :</li> </ul> <pre><code>SELECT *\nFROM \"nom_du_tableau\";\n</code></pre> <p>Cela s\u00e9lectionne toutes les lignes du tableau appel\u00e9 <code>nom_du_tableau</code>. - La sortie que nous obtenons contient toutes les colonnes de toutes les lignes de ce tableau, ce qui fait beaucoup de donn\u00e9es. Nous pouvons la simplifier en s\u00e9lectionnant une colonne particuli\u00e8re, par exemple le titre, du tableau. Essayons :</p> <pre><code>SELECT \"nom_de_la_colonne\"\nFROM \"nom_du_tableau\";\n</code></pre> <ul> <li>Maintenant, nous voyons une liste des titres dans ce tableau. Mais que faire si nous voulons voir les titres et les auteurs dans nos r\u00e9sultats de recherche ? Pour cela, nous ex\u00e9cutons :</li> </ul> <pre><code>SELECT \"colonne1\", \"colonne2\"\nFROM nom_du_tableau;\n</code></pre>"},{"location":"cours1/#questions_1","title":"Questions","text":"<p>Est-il n\u00e9cessaire d'utiliser les doubles guillemets (\u201c) autour des noms de tableaux et de colonnes ?</p> <ul> <li>Il est bon d'utiliser des doubles guillemets autour des noms de tableaux et de colonnes, qui sont appel\u00e9s identificateurs SQL. SQL a \u00e9galement des cha\u00eenes de caract\u00e8res (string en anglais) et nous utilisons des guillemets simples autour des cha\u00eenes de caract\u00e8res pour les diff\u00e9rencier des identificateurs.</li> </ul> <p>Comment savons-nous quels tableaux et colonnes se trouvent dans une base de donn\u00e9es ?</p> <ul> <li>Le sch\u00e9ma de la base de donn\u00e9es contient la structure de la base de donn\u00e9es, y compris les noms des tableaux et des colonnes.  Dans le terminal, on utilise la commande <code>.schema</code></li> </ul> <p>SQLite 3 est-il sensible \u00e0 la casse ? Pourquoi certaines parties de la requ\u00eate sont-elles en majuscules et d'autres en minuscules ?</p> <ul> <li>SQLite n'est pas sensible \u00e0 la casse. Cependant, nous suivons certaines conventions de style. Observez cette requ\u00eate :</li> </ul> <pre><code>SELECT *\nFROM \"tableau\";\n</code></pre> <p>Les mots-cl\u00e9s SQL sont \u00e9crits en majuscules. Cela est particuli\u00e8rement utile pour am\u00e9liorer la lisibilit\u00e9 des requ\u00eates plus longues. Les noms de tableaux et de colonnes sont en minuscules.</p>"},{"location":"cours1/#limit","title":"<code>LIMIT</code>","text":"<ul> <li>Si une base de donn\u00e9es contient des millions de lignes, il ne serait peut-\u00eatre pas judicieux de s\u00e9lectionner toutes ses lignes. Au lieu de cela, nous pourrions simplement vouloir jeter un coup d'\u0153il aux donn\u00e9es qu'elle contient. Nous utilisons le mot-cl\u00e9 SQL <code>LIMIT</code> pour sp\u00e9cifier le nombre de lignes dans la sortie de la requ\u00eate.</li> </ul> <pre><code>  SELECT title, air_date \n  FROM episodes \n  LIMIT 5;\n</code></pre> title air_date Lost My Marbles 2002-01-21 Castleblanca 2002-01-22 R-Fair City 2002-01-23 Snow Day to be Exact 2002-01-24 Sensible Flats 2002-01-25 <p>Cette requ\u00eate nous donne les 5 premiers titres et data de la base de donn\u00e9es. Les titres sont ordonn\u00e9s de la m\u00eame mani\u00e8re dans la sortie de cette requ\u00eate que dans la base de donn\u00e9es.</p>"},{"location":"cours1/#where","title":"<code>WHERE</code>","text":"<ul> <li>Le mot-cl\u00e9 <code>WHERE</code> est utilis\u00e9 pour s\u00e9lectionner des lignes en fonction d'une condition ; il affichera les lignes pour lesquelles la condition sp\u00e9cifi\u00e9e est vraie.</li> <li><code>sql   SELECT \"title\"   FROM \"episodes\"   WHERE \"season\" = 1;</code> |                title                | |-------------------------------------| | Lost My Marbles                     | | Castleblanca                        | | R-Fair City                         | | Snow Day to be Exact                | | Sensible Flats                      | | Zeus on the Loose                   | | The Poddleville Case                | | And They Counted Happily Ever After | | Clock Like An Egyptian              | | Secrets of Symmetria                | | A Day at the Spa                    | | Of All The Luck                     | | Eureeka                             | | Cool It                             | | Find Those Gleamers                 | | Codename: Icky                      | | Return to Sensible Flats            | | Problem Solving in Shangri-La       | | Send in the Clones                  | | Trading Places                      | | Less Than Zero                      | | Model Behavior                      | | Fortress of Attitude                | | Size Me Up                          | | A Battle of Equals                  | | Out of Sync                         |</li> </ul> <p>Cela nous donne les titres des \u00e9pisodes de la saison 1. Notez que <code>1</code> n'est pas entre guillemets car c'est un entier, et non une cha\u00eene de caract\u00e8res ou un identificateur. - Les op\u00e9rateurs qui peuvent \u00eatre utilis\u00e9s pour sp\u00e9cifier des conditions en SQL sont <code>=</code> (\u201c\u00e9gal \u00e0\u201d), <code>!=</code> (\u201cdiff\u00e9rent de\u201d) et <code>&lt;&gt;</code> (\u00e9galement \u201cdiff\u00e9rent de\u201d).</p> <pre><code>- Notez qu'il faut utiliser les guillemets sumple pour faire une comparison avec une cha\u00eene de caract\u00e8res en SQL (et les guillemets doubles si nom de colonne).\n</code></pre> <p>On peut aussi utiliser le mot-cl\u00e9 SQL <code>NOT</code>. Une requ\u00eate serait :</p> <pre><code>SELECT \"title\nFROM \"episodes\"\nWHERE NOT \"season\" = 1;\n</code></pre> <ul> <li>Pour combiner des conditions, nous pouvons utiliser les mots-cl\u00e9s SQL <code>AND</code> et <code>OR</code>. Nous pouvons \u00e9galement utiliser des parenth\u00e8ses pour indiquer comment combiner les conditions dans une instruction conditionnelle compos\u00e9e.</li> <li>Pour s\u00e9lectionner les titres et les auteurs des livres pr\u00e9s\u00e9lectionn\u00e9s en 2022 ou 2023 :</li> </ul> <pre><code>SELECT \"title\", \"air_date\" \nfrom \"episodes\" \nwhere \n    \"season\"=1 \n    OR \n    \"season\"=2;\n</code></pre> <ul> <li>Pour s\u00e9lectionner les livres pr\u00e9s\u00e9lectionn\u00e9s en 2022 ou 2023 qui n'\u00e9taient pas des reliures cartonn\u00e9es :</li> </ul> <pre><code>SELECT \"title\", \"topic\"\nFROM \"episodes\"\nWHERE (\"season\" = 1 OR \"season\" = 2) AND \"topic\" != 'Navigation';\n</code></pre> <p>Ici, les parenth\u00e8ses indiquent que la clause <code>OR</code> doit \u00eatre \u00e9valu\u00e9e avant la clause <code>AND</code>.</p>"},{"location":"cours1/#null","title":"<code>NULL</code>","text":"<ul> <li>Il est possible que les tableaux aient des donn\u00e9es manquantes. <code>NULL</code> est un type utilis\u00e9 pour indiquer que certaines donn\u00e9es n'ont pas de valeur, ou n'existent pas dans le tableau.</li> <li>Les conditions utilis\u00e9es avec <code>NULL</code> sont <code>IS NULL</code> et <code>IS NOT NULL</code>.</li> </ul> <pre><code>SELECT \"title\",\nFROM \"episodes\"\nWHERE \"topic\" IS NULL;\n</code></pre> <ul> <li>Essayons l'inverse : s\u00e9lectionner les \u00e9pisodes pour lesquels il n'y a pas de topic</li> </ul> <pre><code>SELECT \"title\",\nFROM \"episodes\"\nWHERE \"topic\" IS NOT NULL;\n</code></pre>"},{"location":"cours1/#like","title":"<code>LIKE</code>","text":"<ul> <li>Ce mot-cl\u00e9 est utilis\u00e9 pour s\u00e9lectionner des donn\u00e9es qui correspondent approximativement \u00e0 la cha\u00eene de caract\u00e8res sp\u00e9cifi\u00e9e. Par exemple, <code>LIKE</code> pourrait \u00eatre utilis\u00e9 pour s\u00e9lectionner des livres qui ont un certain mot ou une certaine phrase dans leur titre.</li> <li><code>LIKE</code> est combin\u00e9 avec les op\u00e9rateurs <code>%</code> (correspond \u00e0 n'importe quels caract\u00e8res autour d'une cha\u00eene de caract\u00e8res donn\u00e9e) et <code>_</code> (correspond \u00e0 un seul caract\u00e8re).</li> <li>Pour s\u00e9lectionner les \u00e9pisodes avec le mot \u201clove\u201d dans leurs titres, nous pouvons ex\u00e9cuter :</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"title\" LIKE '%love%';\n</code></pre> <p><code>%</code> correspond \u00e0 0 ou plusieurs caract\u00e8res, donc cette requ\u00eate correspondra aux titres de livres qui ont 0 ou plusieurs caract\u00e8res avant et apr\u00e8s \u201clove\u201d - c'est-\u00e0-dire, les titres qui contiennent \u201clove\u201d. - Pour s\u00e9lectionner les livres dont le titre commence par \u201cThe\u201d, nous pouvons ex\u00e9cuter :</p> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"title\" LIKE 'The%';\n</code></pre> <ul> <li>La requ\u00eate ci-dessus pourrait \u00e9galement retourner des \u00e9pisodes dont les titres commencent par \u201cTheir\u201d ou \u201cThey\u201d. Pour s\u00e9lectionner uniquement les \u00e9pisodes dont les titres commencent par le mot \u201cThe\u201d, nous pouvons ajouter un espace.</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"title\" LIKE 'The %';\n</code></pre>"},{"location":"cours1/#questions_2","title":"Questions","text":"<p>Pouvons-nous utiliser plusieurs symboles <code>%</code> ou <code>_</code> dans une requ\u00eate ?</p> <ul> <li>Oui, nous pouvons ! Exemple 1 : Si nous voulions s\u00e9lectionner des \u00e9pisodes dont les titres commencent par \u201cThe\u201d et ont \u201cof\u201d quelque part au milieu, nous pourrions ex\u00e9cuter :</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"title\" LIKE 'The%love%';\n</code></pre> <ul> <li>Exemple 2 : Si nous savions qu'il y a un \u00e9pisode dans le tableau dont le titre commence par \u201cT\u201d et contient 9 lettres, nous pouvons essayer de le trouver en ex\u00e9cutant :</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"title\" LIKE 'T______';';\n</code></pre> <p>La comparaison des cha\u00eenes de caract\u00e8res est-elle sensible \u00e0 la casse en SQL ?</p> <ul> <li>Dans SQLite, la comparaison des cha\u00eenes de caract\u00e8res avec <code>LIKE</code> est par d\u00e9faut insensible \u00e0 la casse, tandis que la comparaison des cha\u00eenes de caract\u00e8res avec <code>=</code> est sensible \u00e0 la casse. (Notez que, dans d'autres DBMS, la configuration de votre base de donn\u00e9es peut changer cela !)</li> </ul>"},{"location":"cours1/#ranges","title":"Ranges","text":"<ul> <li>Nous pouvons \u00e9galement utiliser les op\u00e9rateurs <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> et <code>&gt;=</code> dans nos conditions pour correspondre \u00e0 une plage de valeurs. </li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"season\" &gt;= 2 AND \"season\" &lt; 5;\n</code></pre> <ul> <li>Une autre fa\u00e7on d'obtenir les m\u00eames r\u00e9sultats est d'utiliser les mots-cl\u00e9s <code>BETWEEN</code> et <code>AND</code> pour sp\u00e9cifier des plages inclusives. Nous pouvons ex\u00e9cuter :</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nWHERE \"season\" BETWEEN 2 AND 4;\n</code></pre>"},{"location":"cours1/#questions_3","title":"Questions","text":"<p>Pour les op\u00e9rateurs de plage comme <code>&lt;</code> et <code>&gt;</code>, les valeurs de la base de donn\u00e9es doivent-elles \u00eatre des entiers ?</p> <ul> <li>Non, les valeurs peuvent \u00eatre des entiers ou des nombres \u00e0 virgule flottante (c'est-\u00e0-dire, \u201cd\u00e9cimaux\u201d ou \u201cr\u00e9els\u201d). Lors de la cr\u00e9ation d'une base de donn\u00e9es, il existe des moyens de d\u00e9finir ces types de donn\u00e9es pour les colonnes.</li> </ul>"},{"location":"cours1/#order-by","title":"<code>ORDER BY</code>","text":"<ul> <li>Le mot-cl\u00e9 <code>ORDER BY</code> nous permet d'organiser les lignes retourn\u00e9es dans un certain ordre sp\u00e9cifi\u00e9.</li> <li>La requ\u00eate suivante s\u00e9lectionne les 10 livres les moins bien not\u00e9s de notre base de donn\u00e9es.</li> </ul> <pre><code>SELECT \"title\",\"air_date\"\nFROM \"episodes\"\nORDER BY \"air_date\" LIMIT 10;\n</code></pre> <ul> <li>Notez que l'ordre est croissant par d\u00e9faut.</li> <li>Au lieu de cela, pour s\u00e9lectionner les 10 derniers \u00e9l\u00e9ments :</li> </ul> <pre><code>SELECT \"title\", \"air_date\"\nFROM \"episodes\"\nORDER BY \"air_date\" DESC LIMIT 10;\n</code></pre> <p>Notez l'utilisation du mot-cl\u00e9 SQL <code>DESC</code> pour sp\u00e9cifier l'ordre d\u00e9croissant. <code>ASC</code> peut \u00eatre utilis\u00e9 pour sp\u00e9cifier explicitement l'ordre croissant. - Comme crit\u00e8re de d\u00e9partage, nous pouvons ex\u00e9cuter un deuxi\u00e8me <code>ORDER BY</code>:</p> <pre><code>SELECT * \nfrom episodes \nORDER BY \n    season DESC, \n    episode_in_season ASC;\n</code></pre> <p>Notez que pour chaque colonne dans la clause <code>ORDER BY</code>, nous sp\u00e9cifions l'ordre croissant ou d\u00e9croissant.</p>"},{"location":"cours1/#questions_4","title":"Questions","text":"<p>Pour trier les livres par \u00e9pisodes par ordre alphab\u00e9tique, pouvons-nous utiliser <code>ORDER BY</code> ?</p> <ul> <li>Oui, nous pouvons. La requ\u00eate serait :</li> </ul> <pre><code>SELECT \"title\"\nFROM \"episodes\"\nORDER BY \"title\";\n</code></pre>"},{"location":"cours1/#fonctions-dagregation","title":"Fonctions d'agr\u00e9gation","text":"<ul> <li><code>COUNT</code>, <code>AVG</code>, <code>MIN</code>, <code>MAX</code>, et <code>SUM</code> sont appel\u00e9es fonctions d'agr\u00e9gation et nous permettent d'effectuer les op\u00e9rations correspondantes sur plusieurs lignes de donn\u00e9es. Par leur nature m\u00eame, chacune des fonctions d'agr\u00e9gation suivantes ne retournera qu'une seule sortie - la valeur agr\u00e9g\u00e9e.</li> <li>Pour trouver la note moyenne de tous les livres dans la base de donn\u00e9es :</li> </ul> <pre><code>SELECT AVG(\"rating\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Pour arrondir la note moyenne \u00e0 2 d\u00e9cimales :</li> </ul> <pre><code>SELECT ROUND(AVG(\"rating\"), 2)\nFROM \"longlist\";\n</code></pre> <ul> <li>Pour renommer la colonne dans laquelle les r\u00e9sultats sont affich\u00e9s :</li> </ul> <pre><code>SELECT ROUND(AVG(\"rating\"), 2) AS \"note moyenne\"\nFROM \"longlist\";\n</code></pre> <p>Notez l'utilisation du mot-cl\u00e9 SQL <code>AS</code> pour renommer les colonnes. - Pour s\u00e9lectionner la note maximale dans la base de donn\u00e9es :</p> <pre><code>SELECT MAX(\"rating\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Pour s\u00e9lectionner la note minimale dans la base de donn\u00e9es :</li> </ul> <pre><code>SELECT MIN(\"rating\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Pour compter le nombre total de votes dans la base de donn\u00e9es :</li> </ul> <pre><code>SELECT SUM(\"votes\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Pour compter le nombre de livres dans notre base de donn\u00e9es :</li> </ul> <pre><code>SELECT COUNT(*)\nFROM \"longlist\";\n</code></pre> <ul> <li>Souvenez-vous que nous avons utilis\u00e9 <code>*</code> pour s\u00e9lectionner chaque ligne et colonne de la base de donn\u00e9es. Dans ce cas, nous essayons de compter chaque ligne de la base de donn\u00e9es et donc nous utilisons le <code>*</code>.</li> <li>Pour compter le nombre de traducteurs :</li> </ul> <pre><code>SELECT COUNT(\"translator\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Nous observons que le nombre de traducteurs est inf\u00e9rieur au nombre de lignes dans la base de donn\u00e9es. C'est parce que la fonction <code>COUNT</code> ne compte pas les valeurs <code>NULL</code>.</li> <li>Pour compter le nombre d'\u00e9diteurs dans la base de donn\u00e9es :</li> </ul> <pre><code>SELECT COUNT(\"publisher\")\nFROM \"longlist\";\n</code></pre> <ul> <li>Comme pour les traducteurs, cette requ\u00eate comptera le nombre de valeurs d'\u00e9diteurs qui ne sont pas <code>NULL</code>. Cependant, cela peut inclure des doublons. Un autre mot-cl\u00e9 SQL, <code>DISTINCT</code>, peut \u00eatre utilis\u00e9 pour s'assurer que seules les valeurs distinctes sont compt\u00e9es.</li> </ul> <pre><code>SELECT COUNT(DISTINCT \"publisher\")\nFROM \"longlist\";\n</code></pre>"},{"location":"cours1/#questions_5","title":"Questions","text":"<p>L'utilisation de <code>MAX</code> avec la colonne de titre vous donnerait-elle le titre de livre le plus long ?</p> <ul> <li>Non, l'utilisation de <code>MAX</code> avec la colonne de titre vous donnerait le titre \u201cle plus grand\u201d (ou dans ce cas, le dernier) par ordre alphab\u00e9tique. De m\u00eame, <code>MIN</code> donnera le premier titre par ordre alphab\u00e9tique.</li> </ul>"},{"location":"cours1/#fin","title":"Fin","text":""},{"location":"cours1/#-cela-conclut-la-lecture-0-sur-les-requetes-en-sql-pour-quitter-linvite-sqlite-vous-pouvez-taper-le-mot-cle-sqlite-quit-et-cela-devrait-vous-ramener-au-terminal-habituel","title":"- Cela conclut la Lecture 0 sur les requ\u00eates en SQL ! Pour quitter l'invite SQLite, vous pouvez taper le mot-cl\u00e9 SQLite <code>.quit</code> et cela devrait vous ramener au terminal habituel.","text":""},{"location":"cours1/cyberchase/instructions/","title":"Cyberchase","text":""},{"location":"cours1/cyberchase/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Bienvenue dans le Cyberespace ! Cyberchase est une s\u00e9rie t\u00e9l\u00e9vis\u00e9e anim\u00e9e et \u00e9ducative pour enfants, diffus\u00e9e par le Public Broadcasting Service (PBS) des \u00c9tats-Unis depuis 2002. Con\u00e7ue \u00e0 l'origine pour \u00ab montrer aux enfants que les math\u00e9matiques sont partout et que tout le monde peut \u00eatre bon en maths \u00bb, le monde de Cyberchase tourne autour de Jackie, Matt et Inez qui s'associent \u00e0 Digit, un \u00ab cybird \u00bb, pour emp\u00eacher Hacker de prendre le contr\u00f4le du Cyberespace et d'infecter la Carte M\u00e8re. En chemin, le quatuor apprend des comp\u00e9tences en math\u00e9matiques, en sciences et en r\u00e9solution de probl\u00e8mes pour contrecarrer les tentatives de Hacker.</p> <p>Dans une base de donn\u00e9es appel\u00e9e <code>cyberchase.db</code>, en utilisant une table appel\u00e9e <code>episodes</code>, trouvez des r\u00e9ponses aux questions de PBS sur les \u00e9pisodes de Cyberchase jusqu'\u00e0 pr\u00e9sent.</p>"},{"location":"cours1/cyberchase/instructions/#demonstration","title":"D\u00e9monstration","text":""},{"location":"cours1/cyberchase/instructions/#code-de-distribution","title":"Code de Distribution","text":"<p>Pour ce probl\u00e8me, vous devrez utiliser <code>cyberchase.db</code>, ainsi que plusieurs fichiers <code>.sql</code> dans lesquels vous \u00e9crirez vos requ\u00eates.</p> <p>L'ex\u00e9cution de <code>sqlite3 cyberchase.db</code> devrait ouvrir la base de donn\u00e9es dans <code>sqlite3</code>, via laquelle vous ex\u00e9cuterez des requ\u00eates SQL. </p>"},{"location":"cours1/cyberchase/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Chaque base de donn\u00e9es a un certain \u00ab sch\u00e9ma \u00bb \u2014 les tables et colonnes dans lesquelles les donn\u00e9es sont organis\u00e9es. Dans <code>cyberchase.db</code>, vous trouverez une seule table, <code>episodes</code>. Dans la table <code>episodes</code>, vous trouverez les colonnes suivantes :</p> <ul> <li><code>id</code>, qui identifie de mani\u00e8re unique chaque ligne (\u00e9pisode) de la table</li> <li><code>season</code>, qui est le num\u00e9ro de la saison dans laquelle l'\u00e9pisode a \u00e9t\u00e9 diffus\u00e9</li> <li><code>episode_in_season</code>, qui est le num\u00e9ro de l'\u00e9pisode dans sa saison donn\u00e9e</li> <li><code>title</code>, qui est le titre de l'\u00e9pisode</li> <li><code>topic</code>, qui identifie les id\u00e9es que l'\u00e9pisode visait \u00e0 enseigner</li> <li><code>air_date</code>, qui est la date (exprim\u00e9e au format <code>AAAA-MM-JJ</code>) \u00e0 laquelle l'\u00e9pisode a \u00e9t\u00e9 \u00ab diffus\u00e9 \u00bb (c'est-\u00e0-dire publi\u00e9)</li> <li><code>production_code</code>, qui est l'ID unique utilis\u00e9 par PBS pour faire r\u00e9f\u00e9rence \u00e0 chaque \u00e9pisode en interne</li> </ul>"},{"location":"cours1/cyberchase/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Pour chacune des questions suivantes, vous devez \u00e9crire une seule requ\u00eate SQL qui produit les r\u00e9sultats sp\u00e9cifi\u00e9s par chaque probl\u00e8me. Votre r\u00e9ponse doit prendre la forme d'une seule requ\u00eate SQL. Vous ne devez faire aucune supposition sur les <code>id</code> de certains \u00e9pisodes : vos requ\u00eates doivent \u00eatre exactes m\u00eame si l'<code>id</code> d'un \u00e9pisode particulier \u00e9tait diff\u00e9rent. Enfin, chaque requ\u00eate doit renvoyer uniquement les donn\u00e9es n\u00e9cessaires pour r\u00e9pondre \u00e0 la question : si le probl\u00e8me vous demande uniquement de sortir les noms des \u00e9pisodes, par exemple, votre requ\u00eate ne doit pas \u00e9galement sortir la date de diffusion de chaque \u00e9pisode.</p> <ol> <li>Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les titres de tous les \u00e9pisodes de la saison originale de Cyberchase, la Saison 1.</li> <li>Dans <code>2.sql</code>, listez le num\u00e9ro de saison et le titre du premier \u00e9pisode de chaque saison.</li> <li>Dans <code>3.sql</code>, trouvez le code de production de l'\u00e9pisode \u00ab Hackerized! \u00bb.</li> <li>Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate pour trouver les titres des \u00e9pisodes qui n'ont pas encore de sujet r\u00e9pertori\u00e9.</li> <li>Dans <code>5.sql</code>, trouvez le titre de l'\u00e9pisode des f\u00eates diffus\u00e9 le 31 d\u00e9cembre 2004.</li> <li>Dans <code>6.sql</code>, listez les titres des \u00e9pisodes de la saison 6 (2008) qui ont \u00e9t\u00e9 publi\u00e9s en avance, en 2007.</li> <li>Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les titres et sujets de tous les \u00e9pisodes enseignant les fractions.</li> <li>Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate qui compte le nombre d'\u00e9pisodes publi\u00e9s au cours des 6 derni\u00e8res ann\u00e9es, de 2018 \u00e0 2023 inclus.<ul> <li>Vous trouverez peut-\u00eatre utile de savoir que vous pouvez utiliser <code>BETWEEN</code> avec des dates, comme <code>BETWEEN '2000-01-01' AND '2000-12-31'</code>.</li> </ul> </li> <li>Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate qui compte le nombre d'\u00e9pisodes publi\u00e9s au cours des 6 premi\u00e8res ann\u00e9es de Cyberchase, de 2002 \u00e0 2007 inclus.</li> <li>Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les id, titres et codes de production de tous les \u00e9pisodes. Triez les r\u00e9sultats par code de production, du plus ancien au plus r\u00e9cent.</li> <li>Dans <code>11.sql</code>, listez les titres des \u00e9pisodes de la saison 5, en ordre alphab\u00e9tique inverse.</li> <li>Dans <code>12.sql</code>, comptez le nombre de titres d'\u00e9pisodes uniques.</li> <li>Dans <code>13.sql</code>, \u00e9crivez une requ\u00eate SQL pour explorer une question de votre choix. Cette requ\u00eate doit :<ul> <li>Impliquer au moins une condition, en utilisant <code>WHERE</code> avec <code>AND</code> ou <code>OR</code></li> </ul> </li> </ol> <p>Vous sentez-vous plus \u00e0 l'aise ?</p> <p>Vous pouvez \u00e9ventuellement essayer les requ\u00eates ci-dessous, qui peuvent n\u00e9cessiter des connaissances avanc\u00e9es !</p> <ol> <li>\u00c9crivez une requ\u00eate SQL pour trouver les titres des \u00e9pisodes diffus\u00e9s pendant la p\u00e9riode des f\u00eates, g\u00e9n\u00e9ralement en d\u00e9cembre aux \u00c9tats-Unis.<ul> <li>Votre requ\u00eate doit produire une table avec une seule colonne pour le titre de chaque \u00e9pisode.</li> <li>Essayez de trouver une meilleure solution que <code>LIKE</code> si vous le pouvez !</li> </ul> </li> <li>\u00c9crivez une requ\u00eate SQL pour trouver, pour chaque ann\u00e9e, le premier jour de l'ann\u00e9e o\u00f9 PBS a publi\u00e9 un \u00e9pisode de Cyberchase.<ul> <li>Votre requ\u00eate doit produire une table avec deux colonnes, une pour l'ann\u00e9e et une pour le mois et le jour les plus pr\u00e9coces o\u00f9 un \u00e9pisode a \u00e9t\u00e9 publi\u00e9 cette ann\u00e9e-l\u00e0.</li> </ul> </li> </ol>"},{"location":"cours1/cyberchase/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter (dans votre terminal, plut\u00f4t qu'\u00e0 l'int\u00e9rieur de <code>sqlite3</code>)</p> <pre><code>$ cat FILENAME | sqlite3 cyberchase.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte nomm\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont renvoy\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours1/cyberchase/instructions/#comment-tester","title":"Comment Tester","text":"<p>R\u00e9ponse \u00e0 la prochaine s\u00e9ance</p> <ul> <li>L'ex\u00e9cution de <code>1.sql</code> produit une table avec 1 colonne et 26 lignes.</li> <li>L'ex\u00e9cution de <code>2.sql</code> produit une table avec 2 colonnes et 14 lignes.</li> <li>L'ex\u00e9cution de <code>3.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>4.sql</code> produit une table avec 1 colonne et 26 lignes.</li> <li>L'ex\u00e9cution de <code>5.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>6.sql</code> produit une table avec 1 colonne et 2 lignes.</li> <li>L'ex\u00e9cution de <code>7.sql</code> produit une table avec 2 colonnes et 6 lignes.</li> <li>L'ex\u00e9cution de <code>8.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>9.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>10.sql</code> produit une table avec 3 colonnes et 140 lignes.</li> <li>L'ex\u00e9cution de <code>11.sql</code> produit une table avec 1 colonne et 10 lignes.</li> <li>L'ex\u00e9cution de <code>12.sql</code> produit une table avec 1 colonne et 1 ligne.</li> </ul> <p><code>13.sql</code> d\u00e9pend de vous !</p> <p>Notez que les comptes de lignes n'incluent pas les lignes d'en-t\u00eate qui ne montrent que les noms de colonnes.</p>"},{"location":"cours1/normals/instructions/","title":"Normals","text":"<p>\u00c0 la suite d'un nouveau record annuel de chaleur \u00e9tabli en 2022 \u2014 le dernier d'une s\u00e9rie d'ann\u00e9es records \u2014 les temp\u00e9ratures moyennes de la surface des oc\u00e9ans dans le monde ont augment\u00e9 depuis d\u00e9but mars. En excluant les r\u00e9gions polaires, elles sont environ deux dixi\u00e8mes de degr\u00e9 Celsius plus chaudes que ce que les scientifiques ont jamais observ\u00e9 \u00e0 cette p\u00e9riode de l'ann\u00e9e via les donn\u00e9es satellites.</p> <p>The Washington Post, 28 avril 2023</p>"},{"location":"cours1/normals/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Comment savons-nous si les temp\u00e9ratures des oc\u00e9ans sont plus basses ou plus \u00e9lev\u00e9es que la \"normale\" ? Qu'est-ce qu'une temp\u00e9rature \"normale\" ? Il s'av\u00e8re que les scientifiques ont d\u00e9velopp\u00e9 une m\u00e9trique appel\u00e9e \"Climate Normal\". Une Climate Normal caract\u00e9rise les aspects du climat terrestre \u2014 ses conditions m\u00e9t\u00e9orologiques \u00e0 long terme \u2014 sur une p\u00e9riode de 30 ans. Une m\u00e9trique importante est la temp\u00e9rature des oc\u00e9ans.</p> <p>Dans une base de donn\u00e9es appel\u00e9e <code>normals.db</code>, en utilisant une table appel\u00e9e <code>normals</code>, explorez certaines des donn\u00e9es les plus r\u00e9centes de Climate Normal pour comprendre ce qui constitue une temp\u00e9rature oc\u00e9anique normale dans le monde.</p>"},{"location":"cours1/normals/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Les donn\u00e9es dans <code>normals.db</code> peuvent \u00eatre visualis\u00e9es comme suit :</p> <p></p> <p>Remarquez que la Terre est divis\u00e9e en une grille de coordonn\u00e9es \u2014 des points qui peuvent identifier presque n'importe quel endroit sur Terre. Chaque coordonn\u00e9e est une combinaison de latitude et de longitude. Et remarquez comment chaque coordonn\u00e9e au-dessus d'un oc\u00e9an a une certaine temp\u00e9rature normale de la surface de l'oc\u00e9an qui lui est associ\u00e9e !</p> <p>Dans <code>normals.db</code>, vous trouverez une seule table de coordonn\u00e9es, <code>normals</code>. Dans la table <code>normals</code>, vous trouverez les colonnes suivantes :</p> <ul> <li><code>id</code>, qui identifie de mani\u00e8re unique chaque ligne (coordonn\u00e9e) de la table</li> <li><code>latitude</code>, qui est le degr\u00e9 de latitude (exprim\u00e9 en format d\u00e9cimal) pour la coordonn\u00e9e</li> <li><code>longitude</code>, qui est le degr\u00e9 de longitude (exprim\u00e9 en format d\u00e9cimal) pour la coordonn\u00e9e</li> <li><code>0m</code>, qui est la temp\u00e9rature normale de la surface de l'oc\u00e9an (c'est-\u00e0-dire la temp\u00e9rature normale \u00e0 0 m\u00e8tre de profondeur), en degr\u00e9s Celsius, \u00e0 la coordonn\u00e9e</li> <li><code>5m</code>, qui est la temp\u00e9rature normale de l'oc\u00e9an \u00e0 5 m\u00e8tres de profondeur, en degr\u00e9s Celsius, \u00e0 la coordonn\u00e9e</li> <li><code>10m</code>, qui est la temp\u00e9rature normale de l'oc\u00e9an \u00e0 10 m\u00e8tres de profondeur, en degr\u00e9s Celsius, \u00e0 la coordonn\u00e9e</li> </ul> <p>Et les observations continuent jusqu'\u00e0 <code>5500m</code>, ou 5500 m\u00e8tres de profondeur, pour certaines coordonn\u00e9es !</p> <p>Puisque <code>normals</code> est une table large, si vous voulez pr\u00e9visualiser le contenu, envisagez de <code>SELECT</code>ionner uniquement les colonnes <code>latitude</code>, <code>longitude</code>, et quelques colonnes de profondeur.</p>"},{"location":"cours1/normals/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Pour chacune des questions suivantes, vous devez \u00e9crire une seule requ\u00eate SQL qui produit les r\u00e9sultats sp\u00e9cifi\u00e9s par chaque probl\u00e8me. Votre r\u00e9ponse doit prendre la forme d'une seule requ\u00eate SQL. Vous ne devez pas faire d'hypoth\u00e8ses sur les <code>id</code>s de certaines observations : vos requ\u00eates doivent \u00eatre exactes m\u00eame si l'<code>id</code> d'une observation particuli\u00e8re \u00e9tait diff\u00e9rent. Enfin, chaque requ\u00eate doit retourner uniquement les donn\u00e9es n\u00e9cessaires pour r\u00e9pondre \u00e0 la question.</p> <ol> <li>Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature normale de la surface de l'oc\u00e9an dans le Golfe du Maine, au large des c\u00f4tes du Massachusetts. Pour trouver cette temp\u00e9rature, regardez les donn\u00e9es associ\u00e9es \u00e0 42,5\u00b0 de latitude et -69,5\u00b0 de longitude.</li> <li>Rappelez-vous que vous pouvez trouver la temp\u00e9rature normale de la surface de l'oc\u00e9an dans la colonne <code>0m</code>, qui signifie 0 m\u00e8tre de profondeur !</li> <li>Dans <code>2.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature normale du capteur le plus profond pr\u00e8s du Golfe du Maine, \u00e0 la m\u00eame coordonn\u00e9e ci-dessus.</li> <li>Le capteur le plus profond enregistre les temp\u00e9ratures \u00e0 225 m\u00e8tres de profondeur, vous pouvez donc trouver ces donn\u00e9es dans la colonne <code>225m</code>.</li> <li>Dans <code>3.sql</code>, choisissez un endroit de votre choix et \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature normale \u00e0 0 m\u00e8tre, 100 m\u00e8tres, et 200 m\u00e8tres. Vous pourriez trouver Google Earth utile si vous souhaitez trouver des coordonn\u00e9es \u00e0 utiliser !</li> <li>Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature normale de la surface de l'oc\u00e9an la plus basse.</li> <li>Dans <code>5.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature normale de la surface de l'oc\u00e9an la plus \u00e9lev\u00e9e.</li> <li>Dans <code>6.sql</code>, \u00e9crivez une requ\u00eate SQL pour retourner toutes les temp\u00e9ratures normales de l'oc\u00e9an \u00e0 50m de profondeur, ainsi que leurs degr\u00e9s respectifs de latitude et de longitude, dans la Mer d'Arabie. Incluez les colonnes latitude, longitude, et temp\u00e9rature. Pour simplifier, supposez que la Mer d'Arabie est encadr\u00e9e par les quatre coordonn\u00e9es suivantes :</li> <li>20\u00b0 de latitude, 55\u00b0 de longitude</li> <li>20\u00b0 de latitude, 75\u00b0 de longitude</li> <li>0\u00b0 de latitude, 55\u00b0 de longitude</li> <li>0\u00b0 de latitude, 75\u00b0 de longitude</li> <li>Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la temp\u00e9rature moyenne de la surface de l'oc\u00e9an, arrondie \u00e0 deux d\u00e9cimales, le long de l'\u00e9quateur. Appelez la colonne r\u00e9sultante \"Average Equator Ocean Surface Temperature\".</li> <li>Les temp\u00e9ratures de la surface de l'oc\u00e9an \u00e0 l'\u00e9quateur peuvent \u00eatre trouv\u00e9es \u00e0 toutes les longitudes entre les latitudes -0,5\u00b0 et 0,5\u00b0, inclus.</li> <li>Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 10 endroits avec la temp\u00e9rature normale de la surface de l'oc\u00e9an la plus basse, tri\u00e9s du plus froid au plus chaud. Si deux endroits ont la m\u00eame temp\u00e9rature normale de la surface de l'oc\u00e9an, triez par latitude, de la plus petite \u00e0 la plus grande. Incluez les colonnes latitude, longitude, et temp\u00e9rature de surface.</li> <li>Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 10 endroits avec la temp\u00e9rature normale de la surface de l'oc\u00e9an la plus \u00e9lev\u00e9e, tri\u00e9s du plus chaud au plus froid. Si deux endroits ont la m\u00eame temp\u00e9rature normale de la surface de l'oc\u00e9an, triez par latitude, de la plus petite \u00e0 la plus grande. Incluez les colonnes latitude, longitude, et temp\u00e9rature de surface.</li> <li>Il y a 180 degr\u00e9s entiers de latitude. Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate SQL pour d\u00e9terminer combien de points de latitude nous avons au moins un point de donn\u00e9e. (Pourquoi pourrions-nous ne pas avoir de points de donn\u00e9es pour toutes les latitudes ?)</li> </ol>"},{"location":"cours1/normals/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter</p> <pre><code>$ cat FILENAME | sqlite3 normals.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte appel\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont retourn\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours1/normals/instructions/#comment-tester","title":"Comment Tester","text":"<ul> <li>L'ex\u00e9cution de <code>1.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>2.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li><code>3.sql</code> d\u00e9pend de vous !</li> <li>L'ex\u00e9cution de <code>4.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>5.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>6.sql</code> produit une table avec 3 colonnes et 383 lignes.</li> <li>L'ex\u00e9cution de <code>7.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>8.sql</code> produit une table avec 3 colonnes et 10 lignes.</li> <li>L'ex\u00e9cution de <code>9.sql</code> produit une table avec 3 colonnes et 10 lignes.</li> <li>L'ex\u00e9cution de <code>10.sql</code> produit une table avec 1 colonne et 1 ligne.</li> </ul> <p>Notez que les comptes de lignes n'incluent pas les lignes d'en-t\u00eate qui ne montrent que les noms de colonnes.</p>"},{"location":"cours1/normals/instructions/#remerciements","title":"Remerciements","text":"<p>Donn\u00e9es extraites du World Ocean Atlas 2023, disponibles publiquement aupr\u00e8s de la National Oceanic and Atmospheric Administration (NOAA).</p>"},{"location":"cours1/players/instructions/","title":"Joueurs","text":"<p> L'\u00e9quipe des Boston Americans de 1901 (maintenant les Red Sox)</p>"},{"location":"cours1/players/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Si vous n'\u00eates pas familier, le baseball est un sport populaire dans lequel deux \u00e9quipes de 9 joueurs alternent entre la batte (frapper une balle) et le champ (attraper et lancer les balles frapp\u00e9es). Des points (\"runs\") sont marqu\u00e9s lorsqu'un joueur de l'\u00e9quipe \u00e0 la batte frappe une balle et touche toutes les bases avant que les joueurs de l'\u00e9quipe au champ n'aient la chance de le retirer (\"out\"). Le baseball est sans doute le plus populaire aux \u00c9tats-Unis et au Canada, o\u00f9 la MLB (Major League Baseball) sert d'association professionnelle pour les joueurs depuis 1876.</p> <p>Dans une base de donn\u00e9es appel\u00e9e <code>players.db</code>, en utilisant une table appel\u00e9e <code>players</code>, r\u00e9pondez \u00e0 des questions sur les joueurs de la MLB qui ont jou\u00e9 de 1871 \u00e0 2023.</p>"},{"location":"cours1/players/instructions/#demonstration","title":"D\u00e9monstration","text":""},{"location":"cours1/players/instructions/#code-de-distribution","title":"Code de Distribution","text":"<p>Pour ce probl\u00e8me, vous devrez utiliser <code>players.db</code>, ainsi que plusieurs fichiers <code>.sql</code> dans lesquels vous \u00e9crirez vos requ\u00eates.</p>"},{"location":"cours1/players/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Dans <code>players.db</code>, vous trouverez une seule table, <code>players</code>. Dans la table <code>players</code>, vous trouverez les colonnes suivantes :</p> <ul> <li><code>id</code>, qui identifie de mani\u00e8re unique chaque ligne (joueur) dans la table</li> <li><code>first_name</code>, qui est le pr\u00e9nom du joueur</li> <li><code>last_name</code>, qui est le nom de famille du joueur</li> <li><code>bats</code>, qui est le c\u00f4t\u00e9 (<code>R</code> pour droit ou <code>L</code> pour gauche) o\u00f9 le joueur frappe</li> <li><code>throws</code>, qui est la main (<code>R</code> pour droit ou <code>L</code> pour gauche) avec laquelle le joueur lance</li> <li><code>weight</code>, qui est le poids du joueur en livres</li> <li><code>height</code>, qui est la taille du joueur en pouces</li> <li><code>debut</code>, qui est la date (exprim\u00e9e sous la forme <code>YYYY-MM-DD</code>) \u00e0 laquelle le joueur a commenc\u00e9 sa carri\u00e8re en MLB</li> <li><code>final_game</code>, qui est la date (exprim\u00e9e sous la forme <code>YYYY-MM-DD</code>) \u00e0 laquelle le joueur a jou\u00e9 son dernier match en MLB</li> <li><code>birth_year</code>, qui est l'ann\u00e9e de naissance du joueur</li> <li><code>birth_month</code>, qui est le mois (exprim\u00e9 en entier) de naissance du joueur</li> <li><code>birth_day</code>, qui est le jour de naissance du joueur</li> <li><code>birth_city</code>, qui est la ville o\u00f9 le joueur est n\u00e9</li> <li><code>birth_state</code>, qui est l'\u00e9tat o\u00f9 le joueur est n\u00e9</li> <li><code>birth_country</code>, qui est le pays o\u00f9 le joueur est n\u00e9</li> </ul>"},{"location":"cours1/players/instructions/#specification","title":"Sp\u00e9cification","text":"<ol> <li>Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la ville natale (y compris la ville, l'\u00e9tat et le pays) de Jackie Robinson.</li> <li>Dans <code>2.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le c\u00f4t\u00e9 (par exemple, droit ou gauche) o\u00f9 Babe Ruth frappait.</li> <li>Dans <code>3.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les ids des lignes pour lesquelles une valeur dans la colonne <code>debut</code> est manquante.</li> <li>Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les pr\u00e9noms et noms de famille des joueurs qui ne sont pas n\u00e9s aux \u00c9tats-Unis. Triez les r\u00e9sultats par ordre alphab\u00e9tique par pr\u00e9nom, puis par nom de famille.</li> <li>Dans <code>5.sql</code>, \u00e9crivez une requ\u00eate SQL pour retourner les pr\u00e9noms et noms de famille de tous les batteurs droitiers. Triez les r\u00e9sultats par ordre alphab\u00e9tique par pr\u00e9nom, puis par nom de famille.</li> <li>Dans <code>6.sql</code>, \u00e9crivez une requ\u00eate SQL pour retourner le pr\u00e9nom, le nom de famille et la date de d\u00e9but des joueurs n\u00e9s \u00e0 Pittsburgh, Pennsylvanie (PA). Triez les r\u00e9sultats d'abord par date de d\u00e9but\u2014du plus r\u00e9cent au plus ancien\u2014puis par ordre alphab\u00e9tique par pr\u00e9nom, suivi du nom de famille.</li> <li>Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour compter le nombre de joueurs qui frappaient (ou ont frapp\u00e9) de la main droite et lan\u00e7aient (ou ont lanc\u00e9) de la main gauche, ou vice versa.</li> <li>Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la taille et le poids moyens, arrondis \u00e0 deux d\u00e9cimales, des joueurs de baseball qui ont d\u00e9but\u00e9 le ou apr\u00e8s le 1er janvier 2000. Retournez les colonnes avec les noms \"Average Height\" et \"Average Weight\", respectivement.</li> <li>Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les joueurs qui ont jou\u00e9 leur dernier match en MLB en 2022. Triez les r\u00e9sultats par ordre alphab\u00e9tique par pr\u00e9nom, puis par nom de famille.</li> <li>Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate SQL pour r\u00e9pondre \u00e0 une question de votre choix. Cette requ\u00eate doit :<ul> <li>Utiliser <code>AS</code> pour renommer une colonne</li> <li>Impliquer au moins une condition, en utilisant <code>WHERE</code></li> <li>Trier par au moins une colonne en utilisant <code>ORDER BY</code></li> </ul> </li> </ol> <p>Vous sentez-vous plus \u00e0 l'aise ?</p> <p>Vous pouvez \u00e9ventuellement tenter les requ\u00eates suivantes, qui peuvent n\u00e9cessiter des connaissances avanc\u00e9es !</p> <ol> <li>\u00c9crivez une seule requ\u00eate SQL pour lister les pr\u00e9noms et noms de famille de tous les joueurs de taille sup\u00e9rieure \u00e0 la moyenne, tri\u00e9s du plus grand au plus petit, puis par pr\u00e9nom et nom de famille.</li> </ol>"},{"location":"cours1/players/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter</p> <pre><code>$ cat FILENAME | sqlite3 players.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte appel\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont retourn\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours1/players/instructions/#comment-tester","title":"Comment Tester","text":"<ul> <li>L'ex\u00e9cution de <code>1.sql</code> donne une table avec 3 colonnes et 1 ligne.</li> <li>L'ex\u00e9cution de <code>2.sql</code> donne une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>3.sql</code> donne une table avec 1 colonne et 213 lignes.</li> <li>L'ex\u00e9cution de <code>4.sql</code> donne une table avec 2 colonnes et 2814 lignes.</li> <li>L'ex\u00e9cution de <code>5.sql</code> donne une table avec 2 colonnes et 12878 lignes.</li> <li>L'ex\u00e9cution de <code>6.sql</code> donne une table avec 3 colonnes et 134 lignes.</li> <li>L'ex\u00e9cution de <code>7.sql</code> donne une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>8.sql</code> donne une table avec 2 colonnes et 1 ligne.</li> <li>L'ex\u00e9cution de <code>9.sql</code> donne une table avec 2 colonnes et 516 lignes.</li> </ul> <p><code>10.sql</code> d\u00e9pend de vous !</p> <p>Notez que les comptes de lignes n'incluent pas les lignes d'en-t\u00eate qui ne montrent que les noms de colonnes.</p>"},{"location":"cours1/views/instructions/","title":"Views","text":"<p> Beau Temps, Matin Clair par Katsushika Hokusai</p>"},{"location":"cours1/views/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>De 1830 \u00e0 1832, l'artiste japonais Katsushika Hokusai a cr\u00e9\u00e9 36 estampes repr\u00e9sentant 36 vues diff\u00e9rentes du Mont Fuji, un volcan sur l'\u00eele de Honsh\u016b au Japon. Parmi les \u0153uvres les plus c\u00e9l\u00e8bres de la s\u00e9rie figurent Beau Temps, Matin Clair et La Grande Vague de Kanagawa. Les estampes sont devenues si influentes qu'un autre artiste japonais de l'\u00e9poque, Utagawa Hiroshige, a cr\u00e9\u00e9 sa propre s\u00e9rie de 36 estampes, chacune repr\u00e9sentant une nouvelle vue du Fuji.</p> <p>Dans <code>views.db</code>, vous trouverez des d\u00e9tails sur les 36 estampes cr\u00e9\u00e9es respectivement par Hokusai et Hiroshige. Au total, vous disposerez de donn\u00e9es sur 72 estampes. Bien que ces estampes soient g\u00e9n\u00e9ralement appr\u00e9ci\u00e9es pour leur esth\u00e9tique, la science informatique permet d\u00e9sormais de fournir des informations num\u00e9riques suppl\u00e9mentaires sur les \u0153uvres d'art. En plus du titre et de l'auteur de chaque estampe, vous trouverez des statistiques couramment utilis\u00e9es dans l'analyse computationnelle des images : la couleur moyenne, la luminosit\u00e9, le contraste et l'entropie. Dans les fichiers <code>.sql</code> fournis, \u00e9crivez des requ\u00eates SQL pour r\u00e9pondre \u00e0 des questions sur cette base de donn\u00e9es de 72 estampes et les statistiques sur leur composition.</p>"},{"location":"cours1/views/instructions/#curieux-den-savoir-plus-sur-la-couleur-moyenne-la-luminosite-le-contraste-ou-lentropie","title":"Curieux d'en savoir plus sur la couleur moyenne, la luminosit\u00e9, le contraste ou l'entropie ?","text":"<ul> <li>Couleur moyenne : La couleur obtenue en additionnant les valeurs des canaux rouge, vert et bleu de chaque pixel, puis en divisant chaque somme par le nombre de pixels dans l'image.</li> <li>Luminosit\u00e9 : D\u00e9finie comme la clart\u00e9 ou l'obscurit\u00e9 d'une image, sur une \u00e9chelle de 0 \u00e0 1. Une image blanche mesurerait 1, tandis qu'une image noire mesurerait 0.</li> <li>Contraste : D\u00e9fini comme l'\u00e9tendue des diff\u00e9rences de luminosit\u00e9 dans une image, sur une \u00e9chelle de 0 \u00e0 1. Un contraste plus \u00e9lev\u00e9 (diff\u00e9rences de luminosit\u00e9 plus importantes) permet aux objets de se d\u00e9marquer. Un contraste plus faible (diff\u00e9rences de luminosit\u00e9 plus faibles) signifie que les objets ne se d\u00e9marquent pas autant.</li> <li>Entropie : Une mesure de l'al\u00e9atoire d'une image, souvent utilis\u00e9e pour caract\u00e9riser la complexit\u00e9 d'une \u0153uvre d'art. Une entropie de 10 est assez \u00e9lev\u00e9e, tandis qu'une entropie de 0 est tr\u00e8s faible.</li> </ul>"},{"location":"cours1/views/instructions/#distribution-code","title":"Distribution Code","text":"<p>Pour ce probl\u00e8me, vous devrez acc\u00e9der \u00e0 <code>views.db</code>, ainsi que plusieurs fichiers <code>.sql</code> dans lesquels vous \u00e9crirez vos requ\u00eates.</p>"},{"location":"cours1/views/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Dans <code>views.db</code>, vous trouverez une seule table, <code>views</code>. Dans la table <code>views</code>, vous trouverez les colonnes suivantes :</p> <ul> <li><code>id</code> : Identifie de mani\u00e8re unique chaque ligne (estampe) de la table.</li> <li><code>print_number</code> : Identifie le num\u00e9ro de l'estampe dans la s\u00e9rie de Hokusai ou Hiroshige.</li> <li><code>english_title</code> : Le titre en anglais de l'estampe.</li> <li><code>japanese_title</code> : Le titre en japonais de l'estampe.</li> <li><code>artist</code> : Le nom de famille de l'artiste de l'estampe.</li> <li><code>average_color</code> : La repr\u00e9sentation hexad\u00e9cimale de la couleur obtenue en faisant la moyenne des couleurs de chaque pixel de l'image.</li> <li><code>brightness</code> : Un nombre correspondant \u00e0 la luminosit\u00e9 ou \u00e0 l'obscurit\u00e9 globale de l'image.</li> <li><code>contrast</code> : Un nombre repr\u00e9sentant l'\u00e9tendue de la diff\u00e9rence entre les zones claires et sombres de l'image.</li> <li><code>entropy</code> : Une mesure utilis\u00e9e pour quantifier la complexit\u00e9 de l'\u0153uvre d'art.</li> </ul>"},{"location":"cours1/views/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Pour chacune des questions suivantes, vous devez \u00e9crire une seule requ\u00eate SQL qui produit les r\u00e9sultats sp\u00e9cifi\u00e9s par chaque probl\u00e8me. Votre r\u00e9ponse doit prendre la forme d'une seule requ\u00eate SQL. Vous ne devez pas faire d'hypoth\u00e8ses sur les <code>id</code> de certaines observations : vos requ\u00eates doivent \u00eatre exactes m\u00eame si l'<code>id</code> d'une observation particuli\u00e8re \u00e9tait diff\u00e9rent. Enfin, chaque requ\u00eate doit retourner uniquement les donn\u00e9es n\u00e9cessaires pour r\u00e9pondre \u00e0 la question.</p> <ol> <li>Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL qui pourrait int\u00e9resser un traducteur : listez, c\u00f4te \u00e0 c\u00f4te, le titre japonais et le titre anglais de chaque estampe. Assurez-vous que le titre japonais est la premi\u00e8re colonne, suivi du titre anglais.</li> <li>Dans <code>2.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les couleurs moyennes des estampes de Hokusai dont le titre anglais contient \"rivi\u00e8re\". (\u00c0 titre indicatif, ont-elles une teinte de bleu ?)</li> <li>Dans <code>3.sql</code>, \u00e9crivez une requ\u00eate SQL pour compter combien d'estampes de Hokusai contiennent \"Fuji\" dans le titre anglais. Bien que toutes les estampes de Hokusai se soient concentr\u00e9es sur le Mont Fuji, combien ont inclus \"Fuji\" dans le titre ?</li> <li>Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate SQL pour compter combien d'estampes de Hiroshige ont des titres anglais qui font r\u00e9f\u00e9rence \u00e0 la \"Capitale de l'Est\". Les estampes de Hiroshige ont \u00e9t\u00e9 cr\u00e9\u00e9es pendant la p\u00e9riode \"Edo\" du Japon, en r\u00e9f\u00e9rence \u00e0 la capitale orientale d'Edo, aujourd'hui Tokyo.</li> <li>Dans <code>5.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la valeur de contraste la plus \u00e9lev\u00e9e des estampes de Hokusai. Nommez la colonne \"Contraste Maximum\". L'estampe de Hokusai la plus contrast\u00e9e a-t-elle vraiment beaucoup de contraste ?</li> <li>Dans <code>6.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver l'entropie moyenne des estampes de Hiroshige, arrondie \u00e0 deux d\u00e9cimales. Appelez la colonne r\u00e9sultante \"Entropie Moyenne de Hiroshige\".</li> <li>Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les titres anglais des 5 estampes les plus lumineuses de Hiroshige, de la plus lumineuse \u00e0 la moins lumineuse. Comparez-les \u00e0 cette liste sur Wikipedia pour voir si vos r\u00e9sultats correspondent \u00e0 l'esth\u00e9tique de l'estampe.</li> <li>Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate SQL pour lister les titres anglais des 5 estampes de Hokusai ayant le moins de contraste, du moins contrast\u00e9 au plus contrast\u00e9. Comparez-les \u00e0 cette liste sur Wikipedia pour voir si vos r\u00e9sultats correspondent \u00e0 l'esth\u00e9tique de l'estampe.</li> <li>Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le titre anglais et l'artiste de l'estampe ayant la luminosit\u00e9 la plus \u00e9lev\u00e9e.</li> <li>Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate SQL pour r\u00e9pondre \u00e0 une question de votre choix sur les estampes. La requ\u00eate doit :<ul> <li>Utiliser <code>AS</code> pour renommer une colonne.</li> <li>Impliquer au moins une condition, en utilisant <code>WHERE</code>.</li> <li>Trier par au moins une colonne, en utilisant <code>ORDER BY</code>.</li> </ul> </li> </ol>"},{"location":"cours1/views/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant :</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple :</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter :</p> <pre><code>$ cat FILENAME | sqlite3 views.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte nomm\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont retourn\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours1/views/instructions/#comment-tester","title":"Comment Tester","text":"<ul> <li>L'ex\u00e9cution de <code>1.sql</code> produit une table avec 2 colonnes et 72 lignes.</li> <li>L'ex\u00e9cution de <code>2.sql</code> produit une table avec 1 colonne et 3 lignes.</li> <li>L'ex\u00e9cution de <code>3.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>4.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>5.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>6.sql</code> produit une table avec 1 colonne et 1 ligne.</li> <li>L'ex\u00e9cution de <code>7.sql</code> produit une table avec 1 colonne et 5 lignes.</li> <li>L'ex\u00e9cution de <code>8.sql</code> produit une table avec 1 colonne et 5 lignes.</li> <li>L'ex\u00e9cution de <code>9.sql</code> produit une table avec 2 colonnes et 1 ligne.</li> </ul> <p><code>10.sql</code> d\u00e9pend de vous !</p> <p>Notez que le nombre de lignes ne comprend pas les lignes d'en-t\u00eate qui ne montrent que les noms des colonnes.</p>"},{"location":"cours2/","title":"Cours 2","text":"<ul> <li>Introduction</li> <li>Diagrammes Entit\u00e9-Relation</li> <li>Cl\u00e9s</li> <li>Cl\u00e9s Primaires</li> <li>Cl\u00e9s \u00c9trang\u00e8res</li> <li>Sous-requ\u00eates</li> <li><code>IN</code></li> <li><code>JOIN</code></li> <li>Ensembles</li> <li>Groupes</li> <li>Fin</li> </ul>"},{"location":"cours2/#introduction","title":"Introduction","text":"<ul> <li>Les bases de donn\u00e9es peuvent avoir plusieurs tables. Lors du dernier cours, nous avons vu une base de donn\u00e9es de livres nomin\u00e9s pour le International Booker Prize. Nous allons maintenant voir que cette base de donn\u00e9es contient de nombreuses tables diff\u00e9rentes pour les livres, les auteurs, les \u00e9diteurs, etc.</li> <li>Tout d'abord, ouvrez la base de donn\u00e9es en utilisant SQLite dans le terminal de votre Codespace.</li> <li>Nous pouvons utiliser la commande SQLite suivante pour voir toutes les tables de notre base de donn\u00e9es :</li> </ul> <pre><code>.tables\n</code></pre> <p>Cette commande renvoie les noms des tables dans <code>longlist.db</code> \u2014 7 au total. - Ces tables ont certaines relations entre elles, nous appelons donc la base de donn\u00e9es une base de donn\u00e9es relationnelle. Regardez la liste des tables dans <code>longlist.db</code> et essayez d'imaginer les relations entre elles. Quelques exemples sont :     - Les auteurs \u00e9crivent des livres.     - Les \u00e9diteurs publient des livres.     - Les livres sont traduits par des traducteurs. - Consid\u00e9rons notre premier exemple. Voici un aper\u00e7u des tables <code>authors</code> et <code>books</code> avec les colonnes du nom de l'auteur et du titre du livre !</p> <p> - Juste en regardant ces deux colonnes, comment pouvons-nous savoir qui a \u00e9crit quel livre ? M\u00eame si nous supposons que chaque livre est align\u00e9 \u00e0 c\u00f4t\u00e9 de son auteur, regarder uniquement la table <code>authors</code> ne nous donnerait aucune information sur les livres \u00e9crits par cet auteur. - Certaines fa\u00e7ons possibles d'organiser les livres et les auteurs sont\u2026     - le syst\u00e8me d'honneur : la premi\u00e8re ligne de la table <code>authors</code> correspondra toujours \u00e0 la premi\u00e8re ligne de la table <code>books</code>. Le probl\u00e8me avec ce syst\u00e8me est que l'on peut faire une erreur (ajouter un livre mais oublier d'ajouter son auteur correspondant, ou vice versa). De plus, un auteur peut avoir \u00e9crit plus d'un livre ou un livre peut \u00eatre co-\u00e9crit par plusieurs auteurs.     - revenir \u00e0 une approche \u00e0 une seule table : Cette approche pourrait entra\u00eener une redondance (duplication des donn\u00e9es) si un auteur \u00e9crit plusieurs livres ou si un livre est co-\u00e9crit par plusieurs auteurs. Voici un aper\u00e7u de l'approche \u00e0 une seule table avec certaines donn\u00e9es redondantes.</p> <p> - Apr\u00e8s avoir consid\u00e9r\u00e9 ces id\u00e9es, il semble que la m\u00e9thode la plus efficace soit d'avoir deux tables diff\u00e9rentes. Examinons diff\u00e9rentes fa\u00e7ons dont les tables peuvent \u00eatre li\u00e9es entre elles dans les bases de donn\u00e9es relationnelles. - Consid\u00e9rons ce cas, o\u00f9 chaque auteur n'\u00e9crit qu'un seul livre et chaque livre est \u00e9crit par un seul auteur. Cela s'appelle une relation un-\u00e0-un.</p> <p> - D'un autre c\u00f4t\u00e9, si un auteur peut \u00e9crire plusieurs livres, la relation est une relation un-\u00e0-plusieurs.</p> <p> - Ici, nous voyons une autre situation o\u00f9 non seulement un auteur peut \u00e9crire plusieurs livres, mais les livres peuvent \u00e9galement \u00eatre co-\u00e9crits par plusieurs auteurs. Cela s'appelle une relation plusieurs-\u00e0-plusieurs.</p> <p></p>"},{"location":"cours2/#diagrammes-entite-relation","title":"Diagrammes Entit\u00e9-Relation","text":"<ul> <li>Nous venons de d\u00e9crire les relations un-\u00e0-un, un-\u00e0-plusieurs et plusieurs-\u00e0-plusieurs entre les tables d'une base de donn\u00e9es. Il est possible de visualiser de telles relations \u00e0 l'aide d'un diagramme entit\u00e9-relation (ER).</li> <li>Voici un diagramme ER pour les tables dans <code>longlist.db</code>.</li> </ul> <pre><code>erDiagram\n  \"Author\" }|--|{ \"Book\" : \"wrote\"\n  \"Publisher\" ||--|{ \"Book\" : \"published\"\n  \"Translator\" }o--|{ \"Book\" : \"translated\"\n  \"Book\" ||--o{ \"Rating\" : \"has\"\n</code></pre> <ul> <li>Chaque table est une entit\u00e9 dans notre base de donn\u00e9es. Les relations entre les tables, ou entit\u00e9s, sont repr\u00e9sent\u00e9es par les verbes qui marquent les lignes reliant les entit\u00e9s.</li> <li>Chaque ligne de ce diagramme est en notation pied-de-corbeau.<ul> <li>La premi\u00e8re ligne avec un cercle ressemble \u00e0 un 0 marqu\u00e9 sur la ligne. Cette ligne indique qu'il n'y a pas de relations.</li> <li>La deuxi\u00e8me ligne avec une ligne perpendiculaire ressemble \u00e0 un 1 marqu\u00e9 sur la ligne. Une entit\u00e9 avec cette fl\u00e8che doit avoir au moins une ligne qui lui est li\u00e9e dans l'autre table.</li> <li>La troisi\u00e8me ligne, qui ressemble \u00e0 un pied-de-corbeau, a plusieurs branches. Cette ligne signifie que l'entit\u00e9 est li\u00e9e \u00e0 plusieurs lignes d'une autre table.</li> </ul> </li> </ul> <p> - Par exemple :     - Nous lisons la notation de gauche \u00e0 droite. Un auteur \u00e9crit un livre (ou, chaque auteur peut avoir un livre associ\u00e9 \u00e0 lui).</p> <p>     - Maintenant, non seulement un auteur \u00e9crit un livre, mais un livre est \u00e9galement \u00e9crit par un auteur.</p> <p>     - Avec cet ajout, un auteur \u00e9crit au moins un livre et un livre est \u00e9crit par au moins un auteur. Pour reformuler, un auteur pourrait \u00eatre associ\u00e9 \u00e0 un ou plusieurs livres et un livre peut \u00eatre \u00e9crit par un ou plusieurs auteurs.</p> <p></p> <ul> <li>Revisitons le diagramme ER pour notre base de donn\u00e9es.</li> </ul> <pre><code>erDiagram\n  \"Author\" }|--|{ \"Book\" : \"wrote\"\n  \"Publisher\" ||--|{ \"Book\" : \"published\"\n  \"Translator\" }o--|{ \"Book\" : \"translated\"\n  \"Book\" ||--o{ \"Rating\" : \"has\"\n</code></pre> <ul> <li>En observant les lignes reliant les entit\u00e9s Book et Translator, nous pouvons dire que les livres n'ont pas besoin d'avoir un traducteur. Ils pourraient avoir z\u00e9ro \u00e0 plusieurs traducteurs. Cependant, un traducteur dans la base de donn\u00e9es traduit au moins un livre, et \u00e9ventuellement plusieurs.</li> </ul>"},{"location":"cours2/#questions","title":"Questions","text":"<p>Si nous avons une certaine base de donn\u00e9es, comment savons-nous les relations entre les entit\u00e9s qui y sont stock\u00e9es ?</p> <ul> <li>Les relations exactes entre les entit\u00e9s d\u00e9pendent vraiment du concepteur de la base de donn\u00e9es. Par exemple, savoir si chaque auteur peut \u00e9crire un seul livre ou plusieurs livres est une d\u00e9cision \u00e0 prendre lors de la conception de la base de donn\u00e9es. Un diagramme ER peut \u00eatre consid\u00e9r\u00e9 comme un outil pour communiquer ces d\u00e9cisions \u00e0 quelqu'un qui souhaite comprendre la base de donn\u00e9es et les relations entre ses entit\u00e9s.</li> </ul> <p>Une fois que nous savons qu'une relation existe entre certaines entit\u00e9s, comment l'impl\u00e9mentons-nous dans notre base de donn\u00e9es ?</p> <ul> <li>Nous verrons bient\u00f4t comment nous pouvons utiliser des cl\u00e9s en SQL pour lier les tables entre elles.</li> </ul>"},{"location":"cours2/#cles","title":"Cl\u00e9s","text":""},{"location":"cours2/#cles-primaires","title":"Cl\u00e9s Primaires","text":"<ul> <li>Dans le cas des livres, chaque livre a un identifiant unique appel\u00e9 un ISBN. En d'autres termes, si vous recherchez un livre par son ISBN, un seul livre sera trouv\u00e9. En termes de base de donn\u00e9es, l'ISBN est une cl\u00e9 primaire \u2014 un identifiant qui est unique pour chaque \u00e9l\u00e9ment d'une table.</li> </ul> <p> - Inspir\u00e9 par cette id\u00e9e d'un ISBN, nous pouvons imaginer attribuer des ID uniques \u00e0 nos \u00e9diteurs, auteurs et traducteurs ! Chacun de ces ID serait la cl\u00e9 primaire de la table \u00e0 laquelle il appartient.</p>"},{"location":"cours2/#cles-etrangeres","title":"Cl\u00e9s \u00c9trang\u00e8res","text":"<ul> <li>Les cl\u00e9s aident \u00e9galement \u00e0 lier les tables en SQL.</li> <li>Une cl\u00e9 \u00e9trang\u00e8re est une cl\u00e9 primaire prise d'une table diff\u00e9rente. En r\u00e9f\u00e9ren\u00e7ant la cl\u00e9 primaire d'une table diff\u00e9rente, elle aide \u00e0 lier les tables en formant un lien entre elles.</li> </ul> <p>Remarquez comment la cl\u00e9 primaire de la table <code>books</code> est maintenant une colonne dans la table <code>ratings</code>. Cela aide \u00e0 former une relation un-\u00e0-plusieurs entre les deux tables \u2014 un livre avec un titre (trouv\u00e9 dans la table <code>books</code>) peut avoir plusieurs \u00e9valuations (trouv\u00e9es dans la table <code>ratings</code>). - L'ISBN, comme nous pouvons le voir, est un long identifiant. Si chaque caract\u00e8re occupait un octet de m\u00e9moire, stocker un seul ISBN (y compris les tirets) prendrait 17 octets de m\u00e9moire, ce qui est beaucoup ! - Heureusement, nous n'avons pas n\u00e9cessairement besoin d'utiliser l'ISBN comme cl\u00e9 primaire. Nous pouvons simplement construire la n\u00f4tre en utilisant des nombres comme 1, 2, 3\u2026 et ainsi de suite tant que chaque livre a un num\u00e9ro unique pour l'identifier. - Auparavant, nous avons vu comment impl\u00e9menter la relation un-\u00e0-plusieurs entre les entit\u00e9s <code>books</code> et <code>ratings</code>. Voici un exemple de relation plusieurs-\u00e0-plusieurs.</p> <p></p> <p>Il y a maintenant une table appel\u00e9e <code>authored</code> qui mappe la cl\u00e9 primaire de <code>books</code> (<code>book_id</code>) \u00e0 la cl\u00e9 primaire de <code>authors</code> (<code>author_id</code>).</p>"},{"location":"cours2/#questions_1","title":"Questions","text":"<p>Les ID de l'auteur et du livre peuvent-ils \u00eatre les m\u00eames ? Par exemple, si <code>author_id</code> est 1 et <code>book_id</code> est \u00e9galement 1 dans la table <code>authored</code>, y aura-t-il une confusion ?</p> <ul> <li>Les tables comme <code>authored</code> sont appel\u00e9es tables \"jointes\" ou \"de jonction\". Dans de telles tables, nous savons g\u00e9n\u00e9ralement quelle cl\u00e9 primaire est r\u00e9f\u00e9renc\u00e9e par quelle colonne. Dans ce cas, puisque nous savons que la premi\u00e8re colonne contient uniquement la cl\u00e9 primaire de <code>authors</code> et que la deuxi\u00e8me colonne contient de m\u00eame uniquement la cl\u00e9 primaire de <code>books</code>, ce serait correct m\u00eame si les valeurs correspondaient !</li> </ul> <p>Si nous avons beaucoup de tables jointes comme celle-ci, cela ne prendrait-il pas trop de place ?</p> <ul> <li>Oui, il y a un compromis ici. Les tables comme celles-ci occupent plus d'espace mais elles nous permettent \u00e9galement d'avoir des relations plusieurs-\u00e0-plusieurs sans redondances, comme nous l'avons vu pr\u00e9c\u00e9demment.</li> </ul> <p>Lors de la modification de l'ID d'un livre ou d'un auteur, l'ID est-il \u00e9galement mis \u00e0 jour dans les autres tables ?</p> <ul> <li>Un ID mis \u00e0 jour doit toujours \u00eatre unique. \u00c9tant donn\u00e9 cela, les ID sont souvent abstraits et nous les modifions rarement.</li> </ul>"},{"location":"cours2/#sous-requetes","title":"Sous-requ\u00eates","text":"<ul> <li>Une sous-requ\u00eate est une requ\u00eate \u00e0 l'int\u00e9rieur d'une autre requ\u00eate. Ce sont \u00e9galement appel\u00e9es requ\u00eates imbriqu\u00e9es.</li> <li>Consid\u00e9rons cet exemple pour une relation un-\u00e0-plusieurs. Dans la table <code>books</code>, nous avons un ID pour indiquer l'\u00e9diteur, qui est une cl\u00e9 \u00e9trang\u00e8re prise de la table <code>publishers</code>. Pour d\u00e9couvrir les livres publi\u00e9s par Fitzcarraldo Editions, nous aurions besoin de deux requ\u00eates \u2014 une pour d\u00e9couvrir le <code>publisher_id</code> de Fitzcarraldo Editions \u00e0 partir de la table <code>publishers</code> et la deuxi\u00e8me, pour utiliser ce <code>publisher_id</code> pour trouver tous les livres publi\u00e9s par Fitzcarraldo Editions. Ces deux requ\u00eates peuvent \u00eatre combin\u00e9es en une seule en utilisant l'id\u00e9e d'une sous-requ\u00eate.</li> </ul> <pre><code>SELECT \"title\"\nFROM \"books\"\nWHERE \"publisher_id\" = (\n    SELECT \"id\"\n    FROM \"publishers\"\n    WHERE \"publisher\" = 'Fitzcarraldo Editions'\n);\n</code></pre> <p>Remarquez que :</p> <pre><code>- La sous-requ\u00eate est entre parenth\u00e8ses. La requ\u00eate la plus profonde dans les parenth\u00e8ses sera ex\u00e9cut\u00e9e en premier, suivie des requ\u00eates ext\u00e9rieures.\n- La requ\u00eate int\u00e9rieure est indent\u00e9e. Cela est fait selon les conventions de style pour les sous-requ\u00eates, afin d'augmenter la lisibilit\u00e9.\n</code></pre> <ul> <li>Pour trouver toutes les \u00e9valuations du livre In Memory of Memory</li> </ul> <pre><code>SELECT \"rating\"\nFROM \"ratings\"\nWHERE \"book_id\" = (\n    SELECT \"id\"\n    FROM \"books\"\n    WHERE \"title\" = 'In Memory of Memory'\n);\n</code></pre> <ul> <li>Pour s\u00e9lectionner uniquement l'\u00e9valuation moyenne de ce livre</li> </ul> <pre><code>SELECT AVG(\"rating\")\nFROM \"ratings\"\nWHERE \"book_id\" = (\n    SELECT \"id\"\n    FROM \"books\"\n    WHERE \"title\" = 'In Memory of Memory'\n);\n</code></pre> <ul> <li>L'exemple suivant concerne les relations plusieurs-\u00e0-plusieurs. Pour trouver le(s) auteur(s) qui a(ont) \u00e9crit le livre Flights, trois tables devraient \u00eatre interrog\u00e9es : <code>books</code>, <code>authors</code> et <code>authored</code>.</li> </ul> <pre><code>SELECT \"name\"\nFROM \"authors\"\nWHERE \"id\" = (\n    SELECT \"author_id\"\n    FROM \"authored\"\n    WHERE \"book_id\" = (\n      SELECT \"id\"\n      FROM \"books\"\n      WHERE \"title\" = 'Flights'\n    )\n);\n</code></pre> <p>La premi\u00e8re requ\u00eate qui est ex\u00e9cut\u00e9e est la plus profond\u00e9ment imbriqu\u00e9e \u2014 trouver l'ID du livre Flights. Ensuite, l'ID de(s) auteur(s) qui a(ont) \u00e9crit Flights est trouv\u00e9. Enfin, cela est utilis\u00e9 pour r\u00e9cup\u00e9rer le(s) nom(s) de(s) auteur(s).</p>"},{"location":"cours2/#in","title":"<code>IN</code>","text":"<ul> <li>Ce mot-cl\u00e9 est utilis\u00e9 pour v\u00e9rifier si la valeur souhait\u00e9e se trouve dans une liste ou un ensemble de valeurs donn\u00e9.</li> <li>La relation entre les auteurs et les livres est plusieurs-\u00e0-plusieurs. Cela signifie qu'il est possible qu'un auteur donn\u00e9 ait \u00e9crit plus d'un livre. Pour trouver les noms de tous les livres dans la base de donn\u00e9es \u00e9crits par Fernanda Melchor, nous utiliserions le mot-cl\u00e9 <code>IN</code> comme suit.</li> </ul> <pre><code>SELECT \"title\"\nFROM \"books\"\nWHERE \"id\" IN (\n    SELECT \"book_id\"\n    FROM \"authored\"\n    WHERE \"author_id\" = (\n        SELECT \"id\"\n        FROM \"authors\"\n        WHERE \"name\" = 'Fernanda Melchor'\n    )\n);\n</code></pre> <p>Notez que la requ\u00eate la plus profonde utilise <code>=</code> et non l'op\u00e9rateur <code>IN</code>. C'est parce que nous nous attendons \u00e0 trouver un seul auteur nomm\u00e9 Fernanda Melchor.</p>"},{"location":"cours2/#questions_2","title":"Questions","text":"<p>Que se passe-t-il si la valeur d'une requ\u00eate interne n'est pas trouv\u00e9e ?</p> <ul> <li>Dans ce cas, la requ\u00eate interne ne retournerait rien, incitant la requ\u00eate externe \u00e0 ne rien retourner non plus. La requ\u00eate externe d\u00e9pend donc des r\u00e9sultats de la requ\u00eate interne.</li> </ul> <p>Est-il n\u00e9cessaire d'utiliser quatre espaces pour indenter une sous-requ\u00eate ?</p> <ul> <li>Non. Le nombre d'espaces utilis\u00e9s pour indenter une sous-requ\u00eate peut varier, tout comme la longueur de chaque ligne dans la requ\u00eate. Mais l'id\u00e9e centrale derri\u00e8re la division des requ\u00eates et l'indentation des sous-requ\u00eates est de les rendre lisibles.</li> </ul> <p>Comment pouvons-nous impl\u00e9menter une relation plusieurs-\u00e0-un entre les tables ?</p> <ul> <li>Consid\u00e9rons la situation o\u00f9 un livre est co-\u00e9crit par plusieurs auteurs. Nous aurions une table <code>authored</code> avec plusieurs entr\u00e9es pour le m\u00eame ID de livre. Chacune de ces entr\u00e9es aurait un ID d'auteur diff\u00e9rent. Il est \u00e0 noter que les valeurs des cl\u00e9s \u00e9trang\u00e8res peuvent \u00eatre r\u00e9p\u00e9t\u00e9es dans une table, mais les valeurs des cl\u00e9s primaires sont toujours uniques.</li> </ul>"},{"location":"cours2/#join","title":"<code>JOIN</code>","text":"<ul> <li>Ce mot-cl\u00e9 nous permet de combiner deux tables ou plus.</li> <li>Pour comprendre comment fonctionne <code>JOIN</code>, consid\u00e9rons une base de donn\u00e9es de lions de mer et de leurs sch\u00e9mas de migration. Voici un aper\u00e7u de la base de donn\u00e9es.</li> </ul> <p> - Pour d\u00e9couvrir quelle distance le lion de mer Spot a parcourue, ou r\u00e9pondre \u00e0 des questions similaires sur chaque lion de mer, nous pourrions utiliser des requ\u00eates imbriqu\u00e9es. Alternativement, nous pourrions joindre les tables <code>sea lions</code> et <code>migrations</code> ensemble de sorte que chaque lion de mer ait \u00e9galement ses informations correspondantes comme une extension de la m\u00eame ligne. - Nous pouvons joindre les tables sur l'ID du lion de mer (le facteur commun entre les deux tables) pour nous assurer que les bonnes lignes sont align\u00e9es les unes contre les autres. - Avant de tester cela, assurez-vous de quitter <code>longlist.db</code> en utilisant la commande SQLite <code>.quit</code>. Ensuite, ouvrez <code>sea_lions.db</code>. - Pour joindre les tables</p> <pre><code>SELECT *\nFROM \"sea_lions\"\nJOIN \"migrations\" ON \"migrations\".\"id\" = \"sea_lions\".\"id\";\n</code></pre> <p>Remarquez que :</p> <pre><code>- Le mot-cl\u00e9 `ON` est utilis\u00e9 pour sp\u00e9cifier quelles valeurs correspondent entre les tables jointes. Il n'est pas possible de joindre des tables sans valeurs correspondantes.\n- Si des ID dans une table ne sont pas pr\u00e9sents dans l'autre, cette ligne ne sera pas pr\u00e9sente dans la table jointe. Ce type de jointure est appel\u00e9 `INNER JOIN`.\n</code></pre> <ul> <li>D'autres fa\u00e7ons de joindre les tables qui nous permettent de conserver certains ID non appari\u00e9s sont <code>LEFT JOIN</code>, <code>RIGHT JOIN</code> et <code>FULL JOIN</code>. Chacune de ces jointures est une sorte de <code>OUTER JOIN</code>.</li> <li>Un <code>LEFT JOIN</code> priorise les donn\u00e9es dans la table de gauche (ou premi\u00e8re).</li> </ul> <pre><code>SELECT *\nFROM \"sea_lions\"\nLEFT JOIN \"migrations\" ON \"migrations\".\"id\" = \"sea_lions\".\"id\";\n</code></pre> <p>Cette requ\u00eate conserverait toutes les donn\u00e9es des lions de mer de la table <code>sea_lions</code> \u2014 celle de gauche. Certaines lignes dans la table jointe pourraient \u00eatre partiellement vides. Cela se produirait si la table de droite n'avait pas de donn\u00e9es pour un ID particulier. - De m\u00eame, un <code>RIGHT JOIN</code> conserve toutes les lignes de la table de droite (ou deuxi\u00e8me). Un <code>FULL JOIN</code> nous permet de voir l'int\u00e9gralit\u00e9 de toutes les tables. - Comme nous pouvons l'observer, un <code>OUTER JOIN</code> pourrait conduire \u00e0 des valeurs vides ou <code>NULL</code> dans la table jointe. - Les deux tables de la base de donn\u00e9es des lions de mer ont la colonne <code>id</code>. Puisque la valeur sur laquelle nous joignons les tables a le m\u00eame nom de colonne dans les deux tables, nous pouvons en fait omettre la section <code>ON</code> de la requ\u00eate lors de la jointure.</p> <pre><code>SELECT *\nFROM \"sea_lions\"\nNATURAL JOIN \"migrations\";\n</code></pre> <p>Remarquez que le r\u00e9sultat n'a pas de colonne <code>id</code> en double dans ce cas. De plus, cette jointure fonctionne de mani\u00e8re similaire \u00e0 un <code>INNER JOIN</code>.</p>"},{"location":"cours2/#questions_3","title":"Questions","text":"<p>Dans la base de donn\u00e9es des lions de mer, comment les ID sont-ils cr\u00e9\u00e9s ? Viennent-ils de la table <code>sea_lions</code> ou de la table <code>migrations</code> ?</p> <ul> <li>L'ID de chaque lion de mer provenait probablement de chercheurs suivant les sch\u00e9mas de migration de ces lions de mer. En d'autres termes, les ID n'ont pas \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9s dans l'une ou l'autre des tables, mais ont \u00e9t\u00e9 attribu\u00e9s \u00e0 la source des donn\u00e9es elles-m\u00eames.</li> </ul> <p>Si nous essayons de joindre trois tables, comment pouvons-nous savoir quelles sont les tables de gauche ou de droite ?</p> <ul> <li>Pour chaque instruction <code>JOIN</code>, la premi\u00e8re table avant le mot-cl\u00e9 est celle de gauche. Celle qui est impliqu\u00e9e dans le mot-cl\u00e9 <code>JOIN</code> est la table de droite.</li> </ul> <p>Lorsque nous joignons des tables, la table jointe r\u00e9sultante est-elle enregistr\u00e9e ? Peut-on y faire r\u00e9f\u00e9rence plus tard sans joindre \u00e0 nouveau ?</p> <ul> <li>Dans la fa\u00e7on dont nous utilisons <code>JOIN</code>, le r\u00e9sultat est une table temporaire ou un ensemble de r\u00e9sultats. Il peut \u00eatre utilis\u00e9 pour la dur\u00e9e de la requ\u00eate.</li> </ul> <p>Il existe de nombreux types diff\u00e9rents de <code>JOIN</code>. Y a-t-il un type par d\u00e9faut que nous devrions utiliser ?</p> <ul> <li>Le type le plus simple \u2014 juste <code>JOIN</code> \u2014 est en fait un <code>INNER JOIN</code> et c'est le type par d\u00e9faut pour SQL.</li> </ul>"},{"location":"cours2/#sets-ensembles","title":"Sets - Ensembles","text":"<ul> <li>Avant de plonger dans les ensembles, nous devrons quitter la base de donn\u00e9es des lions de mer et passer \u00e0 <code>longlist.db</code>.</li> <li>Lors de l'ex\u00e9cution d'une requ\u00eate, les r\u00e9sultats que nous voyons sont appel\u00e9s un ensemble de r\u00e9sultats. C'est une sorte d'ensemble en SQL.</li> <li>Prenons un autre exemple. Dans notre base de donn\u00e9es de livres, nous avons des auteurs et des traducteurs. Une personne pourrait \u00eatre soit un auteur, soit un traducteur. Si les deux ensembles ont une intersection, il est \u00e9galement possible qu'une personne soit \u00e0 la fois auteur et traducteur de livres. Nous pouvons utiliser l'op\u00e9rateur <code>INTERSECT</code> pour trouver cet ensemble.</li> </ul> <pre><code>SELECT \"name\" FROM \"translators\"\nINTERSECT\nSELECT \"name\" FROM \"authors\";\n</code></pre> <ul> <li>Si une personne est soit un auteur, soit un traducteur, ou les deux, elle appartient \u00e0 l'union des deux ensembles. En d'autres termes, cet ensemble est form\u00e9 en combinant les ensembles des auteurs et des traducteurs.</li> </ul> <pre><code>SELECT \"name\" FROM \"translators\"\nUNION\nSELECT \"name\" FROM \"authors\";\n</code></pre> <p>Notez que chaque auteur et chaque traducteur est inclus dans cet ensemble de r\u00e9sultats, mais seulement une fois ! - Un l\u00e9ger ajustement de la requ\u00eate pr\u00e9c\u00e9dente nous donne la profession de la personne dans l'ensemble de r\u00e9sultats, selon qu'elle est un auteur ou un traducteur.</p> <pre><code>SELECT 'author' AS \"profession\", \"name\"\nFROM \"authors\"\nUNION\nSELECT 'translator' AS \"profession\", \"name\"\nFROM \"translators\";\n</code></pre> <ul> <li>Toute personne qui est un auteur et seulement un auteur est incluse dans l'ensemble suivant. Le mot-cl\u00e9 <code>EXCEPT</code> peut \u00eatre utilis\u00e9 pour trouver un tel ensemble. En d'autres termes, l'ensemble des traducteurs est soustrait de l'ensemble des auteurs pour former celui-ci.</li> </ul> <p></p> <pre><code>SELECT \"name\" FROM \"authors\"\nEXCEPT\nSELECT \"name\" FROM \"translators\";\n</code></pre> <p>Nous pouvons v\u00e9rifier qu'aucun auteur-traducteur de l'ensemble d'intersection n'appara\u00eet dans cet ensemble de r\u00e9sultats. - De m\u00eame, il est possible de trouver un ensemble de personnes qui sont seulement des traducteurs en utilisant <code>EXCEPT</code>. - Comment pouvons-nous trouver cet ensemble de personnes qui sont soit des auteurs, soit des traducteurs, mais pas les deux ?</p> <p> - Ces op\u00e9rateurs pourraient \u00eatre utiles pour r\u00e9pondre \u00e0 de nombreuses questions diff\u00e9rentes. Par exemple, nous pouvons trouver les livres que Sophie Hughes et Margaret Jull Costa ont traduits ensemble.</p> <pre><code>SELECT \"book_id\" FROM \"translated\"\nWHERE \"translator_id\" = (\n    SELECT \"id\" from \"translators\"\n    WHERE \"name\" = 'Sophie Hughes'\n)\nINTERSECT\nSELECT \"book_id\" FROM \"translated\"\nWHERE \"translator_id\" = (\n    SELECT \"id\" from \"translators\"\n    WHERE \"name\" = 'Margaret Jull Costa'\n);\n</code></pre> <p>Chacune des requ\u00eates imbriqu\u00e9es ici trouve les ID des livres pour un traducteur. Le mot-cl\u00e9 <code>INTERSECT</code> est utilis\u00e9 pour intersecter les ensembles r\u00e9sultants et nous donner les livres sur lesquels elles ont collabor\u00e9.</p>"},{"location":"cours2/#questions_4","title":"Questions","text":"<p>Pourrions-nous utiliser <code>INTERSECT</code>, <code>UNION</code> etc. pour effectuer des op\u00e9rations sur 3-4 ensembles ?</p> <ul> <li>Oui, absolument. Pour intersecter 3 ensembles, nous devrions utiliser l'op\u00e9rateur <code>INTERSECT</code> deux fois. Une note importante \u2014 nous devons nous assurer d'avoir le m\u00eame nombre et les m\u00eames types de colonnes dans les ensembles \u00e0 combiner en utilisant <code>INTERSECT</code>, <code>UNION</code> etc.</li> </ul>"},{"location":"cours2/#groupes","title":"Groupes","text":"<ul> <li>Consid\u00e9rons la table <code>ratings</code>. Pour chaque livre, nous voulons trouver la note moyenne du livre. Pour ce faire, nous devrions d'abord regrouper les notes ensemble par livre, puis faire la moyenne des notes pour chaque livre (chaque groupe).</li> </ul> <pre><code>SELECT \"book_id\", AVG(\"rating\") AS \"average rating\"\nFROM \"ratings\"\nGROUP BY \"book_id\";\n</code></pre> <p>Dans cette requ\u00eate, le mot-cl\u00e9 <code>GROUP BY</code> a \u00e9t\u00e9 utilis\u00e9 pour cr\u00e9er des groupes pour chaque livre, puis r\u00e9duire les notes du groupe en une note moyenne ! - Maintenant, nous voulons seulement voir les livres qui sont bien not\u00e9s, avec une note moyenne sup\u00e9rieure \u00e0 4.</p> <pre><code>SELECT \"book_id\", ROUND(AVG(\"rating\"), 2) AS \"average rating\"\nFROM \"ratings\"\nGROUP BY \"book_id\"\nHAVING \"average rating\" &gt; 4.0;\n</code></pre> <p>Notez que le mot-cl\u00e9 <code>HAVING</code> est utilis\u00e9 ici pour sp\u00e9cifier une condition pour les groupes, au lieu de <code>WHERE</code> (qui ne peut \u00eatre utilis\u00e9 que pour sp\u00e9cifier des conditions pour des lignes individuelles).</p>"},{"location":"cours2/#questions_5","title":"Questions","text":"<p>Est-il possible de voir le nombre de notes donn\u00e9es \u00e0 chaque livre ?</p> <ul> <li>Oui, cela n\u00e9cessiterait une l\u00e9g\u00e8re modification avec l'utilisation du mot-cl\u00e9 <code>COUNT</code>.</li> </ul> <pre><code>SELECT \"book_id\", COUNT(\"rating\")\nFROM \"ratings\"\nGROUP BY \"book_id\";\n</code></pre> <p>Est-il \u00e9galement possible de trier les donn\u00e9es obtenues ici ?</p> <ul> <li>Oui, c'est possible. Supposons que nous voulions trouver les notes moyennes par livre bien not\u00e9, class\u00e9es par ordre d\u00e9croissant.</li> </ul> <pre><code>SELECT \"book_id\", ROUND(AVG(\"rating\"), 2) AS \"average rating\"\nFROM \"ratings\"\nGROUP BY \"book_id\"\nHAVING \"average rating\" &gt; 4.0\nORDER BY \"average rating\" DESC;\n</code></pre>"},{"location":"cours2/#fin","title":"Fin","text":"<ul> <li>Cela conclut le Cours 1 sur les relations !</li> </ul>"},{"location":"cours2/dese/instructions/","title":"DESE","text":""},{"location":"cours2/dese/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Vous venez de d\u00e9crocher un nouvel emploi en tant qu'analyste de donn\u00e9es pour l'\u00c9tat du Massachusetts, au sein du D\u00e9partement de l'\u00c9ducation \u00c9l\u00e9mentaire et Secondaire (ou DESE, en abr\u00e9g\u00e9 !). Le DESE supervise le syst\u00e8me \u00e9ducatif public de l'\u00c9tat. L'une des responsabilit\u00e9s du DESE est de garantir que chaque enfant re\u00e7oive une \u00e9ducation de qualit\u00e9 \u2014 une \u00e9ducation dans laquelle ils rencontrent des enseignants exp\u00e9riment\u00e9s, ont acc\u00e8s \u00e0 une abondance de ressources, et obtiennent finalement leur dipl\u00f4me en ayant satisfait \u00e0 toutes les exigences de l'\u00c9tat. Vos comp\u00e9tences en SQL ont un r\u00f4le \u00e0 jouer dans ces nobles objectifs !</p> <p>Dans une base de donn\u00e9es appel\u00e9e <code>dese.db</code>, r\u00e9pondez \u00e0 des questions sur l'\u00e9tat de l'\u00e9ducation dans le Massachusetts.</p>"},{"location":"cours2/dese/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Dans le Massachusetts, l'\u00e9ducation publique est d\u00e9l\u00e9gu\u00e9e \u00e0 des districts, un type de gouvernement scolaire souvent associ\u00e9 \u00e0 une ville individuelle. Ces districts contiennent \u00e0 leur tour de nombreuses \u00e9coles individuelles. Consid\u00e9rez le diagramme de relation d'entit\u00e9 ci-dessous, qui codifie la relation entre les districts, les \u00e9coles et d'autres donn\u00e9es collect\u00e9es par le DESE.</p> <pre><code>erDiagram\n    \"District\" ||--o{ \"School\": \"contains\"\n    \"District\" ||--o{ \"Expenditure\": \"makes\"\n    \"District\" ||--o{ \"Staff Evaluation\" : \"receives\"\n    \"School\" ||--o| \"Graduation Rate\" : \"reports\"\n</code></pre>"},{"location":"cours2/dese/instructions/#table-districts","title":"Table <code>districts</code>","text":"<p>La table <code>districts</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du district</li> <li><code>name</code>, qui est le nom du district</li> <li><code>type</code>, qui indique le type de district. Dans le Massachusetts, il existe des districts scolaires publics (d\u00e9sign\u00e9s \"Public School District\") et des districts \u00e0 charte (d\u00e9sign\u00e9s \"Charter District\"). Pas besoin d'apprendre la diff\u00e9rence, bien que vous puissiez le faire sur Wikipedia si vous \u00eates curieux !</li> <li><code>city</code>, qui est la ville dans laquelle se trouve le district</li> <li><code>state</code>, qui est l'\u00c9tat dans lequel se trouve le district</li> <li><code>zip</code>, qui est le code postal dans lequel se trouve le district</li> </ul>"},{"location":"cours2/dese/instructions/#table-schools","title":"Table <code>schools</code>","text":"<p>La table <code>schools</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de l'\u00e9cole</li> <li><code>district_id</code>, qui est l'ID du district auquel appartient l'\u00e9cole</li> <li><code>name</code>, qui est le nom de l'\u00e9cole</li> <li><code>type</code>, qui indique le type d'\u00e9cole. Dans le Massachusetts, il existe des \u00e9coles publiques (d\u00e9sign\u00e9es \"Public School\") et des \u00e9coles \u00e0 charte (d\u00e9sign\u00e9es \"Charter School\"). Pas besoin d'apprendre la diff\u00e9rence, bien que vous puissiez le faire sur Wikipedia si vous \u00eates curieux !</li> <li><code>city</code>, qui est la ville dans laquelle se trouve l'\u00e9cole</li> <li><code>state</code>, qui est l'\u00c9tat dans lequel se trouve l'\u00e9cole</li> <li><code>zip</code>, qui est le code postal dans lequel se trouve l'\u00e9cole</li> </ul>"},{"location":"cours2/dese/instructions/#table-graduation_rates","title":"Table <code>graduation_rates</code>","text":"<p>La table <code>graduation_rates</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du taux de dipl\u00f4me</li> <li><code>school_id</code>, qui est l'ID de l'\u00e9cole associ\u00e9e au dipl\u00f4me</li> <li><code>graduated</code>, qui est le pourcentage d'\u00e9l\u00e8ves, de 0 \u00e0 100, qui ont obtenu leur dipl\u00f4me \u00e0 temps</li> <li><code>dropped</code>, qui est le pourcentage d'\u00e9l\u00e8ves, de 0 \u00e0 100, qui ont abandonn\u00e9 l'\u00e9cole avant d'obtenir leur dipl\u00f4me</li> <li><code>excluded</code>, qui est le pourcentage d'\u00e9l\u00e8ves, de 0 \u00e0 100, qui ont \u00e9t\u00e9 \"exclus\" (c'est-\u00e0-dire expuls\u00e9s)</li> </ul>"},{"location":"cours2/dese/instructions/#table-expenditures","title":"Table <code>expenditures</code>","text":"<p>La table <code>expenditures</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de la d\u00e9pense</li> <li><code>district_id</code>, qui est l'ID du district associ\u00e9 \u00e0 la d\u00e9pense</li> <li><code>pupils</code>, qui est le nombre d'\u00e9l\u00e8ves fr\u00e9quentant le district donn\u00e9</li> <li><code>per_pupil_expenditure</code>, qui est le montant d'argent d\u00e9pens\u00e9, en dollars, pour chaque \u00e9l\u00e8ve fr\u00e9quentant le district</li> </ul>"},{"location":"cours2/dese/instructions/#table-staff_evaluations","title":"Table <code>staff_evaluations</code>","text":"<p>La table <code>staff_evaluations</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du rapport d'\u00e9valuation</li> <li><code>district_id</code>, qui est l'ID du district associ\u00e9 \u00e0 l'\u00e9valuation</li> <li><code>evaluated</code>, qui est le pourcentage du personnel du district, de 0 \u00e0 100, formellement \u00e9valu\u00e9</li> <li><code>exemplary</code>, qui est le pourcentage du personnel du district, de 0 \u00e0 100, \u00e9valu\u00e9 comme \"exemplaire\"</li> <li><code>proficient</code>, qui est le pourcentage du personnel du district, de 0 \u00e0 100, \u00e9valu\u00e9 comme \"comp\u00e9tent\"</li> <li><code>needs_improvement</code>, qui est le pourcentage du personnel du district, de 0 \u00e0 100, \u00e9valu\u00e9 comme \"ayant besoin d'am\u00e9lioration\"</li> <li><code>unsatisfactory</code>, qui est le pourcentage du personnel du district, de 0 \u00e0 100, \u00e9valu\u00e9 comme \"insatisfaisant\"</li> </ul>"},{"location":"cours2/dese/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Pour chacune des questions suivantes, vous devez \u00e9crire une seule requ\u00eate SQL qui produit les r\u00e9sultats sp\u00e9cifi\u00e9s par chaque probl\u00e8me. Votre r\u00e9ponse doit prendre la forme d'une seule requ\u00eate SQL. Vous ne devez faire aucune supposition sur les <code>id</code> de lignes particuli\u00e8res : vos requ\u00eates doivent \u00eatre exactes m\u00eame si les <code>id</code> \u00e9taient diff\u00e9rents. Enfin, chaque requ\u00eate ne doit retourner que les donn\u00e9es n\u00e9cessaires pour r\u00e9pondre \u00e0 la question.</p>"},{"location":"cours2/dese/instructions/#1sql","title":"<code>1.sql</code>","text":"<p>Votre coll\u00e8gue pr\u00e9pare une carte de toutes les \u00e9coles publiques du Massachusetts. Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les noms et les villes de toutes les \u00e9coles publiques du Massachusetts.</p> <ul> <li>Gardez \u00e0 l'esprit que toutes les \u00e9coles de la table <code>schools</code> ne sont pas consid\u00e9r\u00e9es comme des \u00e9coles publiques traditionnelles. Le Massachusetts reconna\u00eet \u00e9galement les \u00e9coles priv\u00e9es (<code>charter schools</code>) qui (selon le DESE !) sont consid\u00e9r\u00e9es comme distinctes.</li> </ul>"},{"location":"cours2/dese/instructions/#2sql","title":"<code>2.sql</code>","text":"<p>Votre \u00e9quipe travaille \u00e0 l'archivage d'anciennes donn\u00e9es. Dans <code>2.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les noms des districts qui ne sont plus op\u00e9rationnels.</p> <ul> <li>Les districts qui ne sont plus op\u00e9rationnels ont \"(non-op)\" \u00e0 la fin de leur nom.</li> </ul>"},{"location":"cours2/dese/instructions/#3sql","title":"<code>3.sql</code>","text":"<p>La l\u00e9gislature du Massachusetts souhaite savoir combien d'argent, en moyenne, les districts ont d\u00e9pens\u00e9 par \u00e9l\u00e8ve l'ann\u00e9e derni\u00e8re. Dans <code>3.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver la d\u00e9pense moyenne par \u00e9l\u00e8ve. Nommez la colonne \"per_pupil_expenditure\".</p> <ul> <li>Notez que la colonne <code>per_pupil_expenditure</code> dans la table <code>expenditures</code> contient le montant moyen, par \u00e9l\u00e8ve, que chaque district a d\u00e9pens\u00e9 l'ann\u00e9e derni\u00e8re. On vous a demand\u00e9 de trouver la moyenne de cet ensemble de moyennes, en pond\u00e9rant tous les districts de mani\u00e8re \u00e9gale, quelle que soit leur taille.</li> </ul>"},{"location":"cours2/dese/instructions/#4sql","title":"<code>4.sql</code>","text":"<p>Certaines villes ont plus d'\u00e9coles publiques que d'autres. Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 10 villes avec le plus d'\u00e9coles publiques. Votre requ\u00eate doit retourner les noms des villes et le nombre d'\u00e9coles publiques qu'elles contiennent, tri\u00e9s du plus grand nombre d'\u00e9coles publiques au plus petit. Si deux villes ont le m\u00eame nombre d'\u00e9coles publiques, triez-les par ordre alphab\u00e9tique.</p>"},{"location":"cours2/dese/instructions/#5sql","title":"<code>5.sql</code>","text":"<p>Le DESE souhaite que vous d\u00e9terminiez dans quelles villes des \u00e9coles publiques suppl\u00e9mentaires pourraient \u00eatre n\u00e9cessaires. Dans <code>5.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les villes avec 3 \u00e9coles publiques ou moins. Votre requ\u00eate doit retourner les noms des villes et le nombre d'\u00e9coles publiques qu'elles contiennent, tri\u00e9s du plus grand nombre d'\u00e9coles publiques au plus petit. Si deux villes ont le m\u00eame nombre d'\u00e9coles publiques, triez-les par ordre alphab\u00e9tique.</p>"},{"location":"cours2/dese/instructions/#6sql","title":"<code>6.sql</code>","text":"<p>Le DESE souhaite \u00e9valuer quelles \u00e9coles ont atteint un taux de dipl\u00f4me de 100 %. Dans <code>6.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les noms des \u00e9coles (publiques ou \u00e0 charte !) qui ont d\u00e9clar\u00e9 un taux de dipl\u00f4me de 100 %.</p>"},{"location":"cours2/dese/instructions/#7sql","title":"<code>7.sql</code>","text":"<p>Le DESE pr\u00e9pare un rapport sur les \u00e9coles du district scolaire de Cambridge. Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les noms des \u00e9coles (publiques ou \u00e0 charte !) dans le district scolaire de Cambridge. Gardez \u00e0 l'esprit que Cambridge, la ville, contient quelques districts scolaires, mais le DESE s'int\u00e9resse au district dont le nom est \"Cambridge\".</p>"},{"location":"cours2/dese/instructions/#8sql","title":"<code>8.sql</code>","text":"<p>Un parent souhaite envoyer son enfant dans un district avec de nombreux autres \u00e9l\u00e8ves. Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate SQL pour afficher les noms de tous les districts scolaires et le nombre d'\u00e9l\u00e8ves inscrits dans chacun.</p>"},{"location":"cours2/dese/instructions/#9sql","title":"<code>9.sql</code>","text":"<p>Un autre parent souhaite envoyer son enfant dans un district avec peu d'autres \u00e9l\u00e8ves. Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le(s) nom(s) du ou des district(s) scolaire(s) avec le plus petit nombre d'\u00e9l\u00e8ves. Ne rapportez que le(s) nom(s).</p>"},{"location":"cours2/dese/instructions/#10sql","title":"<code>10.sql</code>","text":"<p>Dans le Massachusetts, les d\u00e9penses des districts scolaires sont en partie d\u00e9termin\u00e9es par les taxes locales sur les valeurs immobili\u00e8res (par exemple, les valeurs des maisons). Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 10 districts scolaires publics avec les d\u00e9penses par \u00e9l\u00e8ve les plus \u00e9lev\u00e9es. Votre requ\u00eate doit retourner les noms des districts et la d\u00e9pense par \u00e9l\u00e8ve pour chacun.</p>"},{"location":"cours2/dese/instructions/#11sql","title":"<code>11.sql</code>","text":"<p>Y a-t-il une relation entre les d\u00e9penses scolaires et les taux de dipl\u00f4me ? Dans <code>11.sql</code>, \u00e9crivez une requ\u00eate SQL pour afficher les noms des \u00e9coles, leur d\u00e9pense par \u00e9l\u00e8ve et leur taux de dipl\u00f4me. Triez les \u00e9coles de la plus grande d\u00e9pense par \u00e9l\u00e8ve \u00e0 la plus petite. Si deux \u00e9coles ont la m\u00eame d\u00e9pense par \u00e9l\u00e8ve, triez par nom d'\u00e9cole.</p> <ul> <li>Vous devez supposer qu'une \u00e9cole d\u00e9pense le m\u00eame montant par \u00e9l\u00e8ve que l'ensemble de son district.</li> </ul>"},{"location":"cours2/dese/instructions/#12sql","title":"<code>12.sql</code>","text":"<p>Un parent vous demande conseil pour trouver les meilleurs districts scolaires publics du Massachusetts. Dans <code>12.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les districts scolaires publics avec des d\u00e9penses par \u00e9l\u00e8ve sup\u00e9rieures \u00e0 la moyenne et un pourcentage sup\u00e9rieur \u00e0 la moyenne d'enseignants not\u00e9s \"exemplaires\". Votre requ\u00eate doit retourner les noms des districts, ainsi que leurs d\u00e9penses par \u00e9l\u00e8ve et le pourcentage d'enseignants not\u00e9s exemplaires. Triez les r\u00e9sultats d'abord par le pourcentage d'enseignants not\u00e9s exemplaires (du plus \u00e9lev\u00e9 au plus bas), puis par la d\u00e9pense par \u00e9l\u00e8ve (du plus \u00e9lev\u00e9 au plus bas).</p>"},{"location":"cours2/dese/instructions/#13sql","title":"<code>13.sql</code>","text":"<p>Dans <code>13.sql</code>, \u00e9crivez une requ\u00eate SQL pour r\u00e9pondre \u00e0 une question que vous vous posez sur les donn\u00e9es ! La requ\u00eate doit :</p> <ul> <li>Impliquer au moins une <code>JOINTURE</code> ou une sous-requ\u00eate</li> </ul>"},{"location":"cours2/dese/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant :</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter :</p> <pre><code>$ cat FILENAME | sqlite3 dese.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte nomm\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont retourn\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours2/moneyball/instructions/","title":"Moneyball","text":"<p>Il s'agit de r\u00e9duire les choses \u00e0 un seul chiffre. En utilisant les statistiques comme nous les lisons, nous trouverons la valeur des joueurs que personne d'autre ne peut voir.</p> <p>Peter Brand dans Moneyball</p>"},{"location":"cours2/moneyball/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Nous sommes en 2001. Vous avez \u00e9t\u00e9 embauch\u00e9 pour aider \u00e0 tirer le meilleur parti du budget limit\u00e9 de l'\u00e9quipe de baseball des Oakland Athletics. Chaque ann\u00e9e, des \u00e9quipes comme les \"A's\" engagent de nouveaux joueurs de baseball. Malheureusement, vous manquez de joueurs vedettes \u2014 et de fonds. Cependant, avec un peu de SQL et de chance, qui dit que vous ne pouvez pas cr\u00e9er une \u00e9quipe qui d\u00e9fie les attentes ?</p> <p>Avec une base de donn\u00e9es appel\u00e9e <code>moneyball.db</code> \u2014 qui contient des informations sur les joueurs, leurs performances (performances) et leurs salaires (salaries) \u2014 aidez les Oakland Athletics \u00e0 trouver la valeur des joueurs que les autres pourraient manquer.</p>"},{"location":"cours2/moneyball/instructions/#schema","title":"Sch\u00e9ma","text":"<p><code>moneyball.db</code> repr\u00e9sente tous les joueurs (players), \u00e9quipes (teams), salaires (salaries) et performances (performances) de la Ligue Majeure de Baseball jusqu'en 2001. En particulier, <code>moneyball.db</code> repr\u00e9sente les entit\u00e9s suivantes :</p> <ul> <li>Un joueur (player), qui inclut toute personne ayant jou\u00e9 en Ligue Majeure de Baseball pendant une p\u00e9riode quelconque</li> <li>Une \u00e9quipe (team), qui inclut toutes les \u00e9quipes, pass\u00e9es et pr\u00e9sentes, en Ligue Majeure de Baseball</li> <li>Une performance (performance), qui d\u00e9crit les types de coups s\u00fbrs (hits) qu'un joueur a r\u00e9alis\u00e9s pour son \u00e9quipe une ann\u00e9e donn\u00e9e</li> <li>Un salaire (salary), qui est le montant d'argent qu'une \u00e9quipe a pay\u00e9 \u00e0 l'un de ses joueurs une ann\u00e9e donn\u00e9e</li> </ul> <p>Ces entit\u00e9s sont li\u00e9es selon le diagramme de relation d'entit\u00e9 (ER) ci-dessous :</p> <pre><code>erDiagram\n    Player ||--|{ Salary : earns\n    Player ||--|{ \"Performance\" : generates\n    Team ||--|{ Salary : \"pays\"\n    \"Performance\" }|--|| Team : with\n</code></pre>"},{"location":"cours2/moneyball/instructions/#table-players","title":"Table <code>players</code>","text":"<p>La table <code>players</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du joueur (player)</li> <li><code>first_name</code>, qui est le pr\u00e9nom du joueur (first name)</li> <li><code>last_name</code>, qui est le nom de famille du joueur (last name)</li> <li><code>bats</code>, qui est le c\u00f4t\u00e9 (\"R\" pour droit ou \"L\" pour gauche) avec lequel le joueur frappe (bats)</li> <li><code>throws</code>, qui est la main (\"R\" pour droit ou \"L\" pour gauche) avec laquelle le joueur lance (throws)</li> <li><code>weight</code>, qui est le poids du joueur en livres (pounds)</li> <li><code>height</code>, qui est la taille du joueur en pouces (inches)</li> <li><code>debut</code>, qui est la date (exprim\u00e9e sous la forme <code>YYYY-MM-DD</code>) \u00e0 laquelle le joueur a commenc\u00e9 sa carri\u00e8re en MLB (debut)</li> <li><code>final_game</code>, qui est la date (exprim\u00e9e sous la forme <code>YYYY-MM-DD</code>) \u00e0 laquelle le joueur a jou\u00e9 son dernier match en MLB (final game)</li> <li><code>birth_year</code>, qui est l'ann\u00e9e de naissance du joueur (birth year)</li> <li><code>birth_month</code>, qui est le mois (exprim\u00e9 sous la forme d'un entier) de naissance du joueur (birth month)</li> <li><code>birth_day</code>, qui est le jour de naissance du joueur (birth day)</li> <li><code>birth_city</code>, qui est la ville de naissance du joueur (birth city)</li> <li><code>birth_state</code>, qui est l'\u00c9tat de naissance du joueur (birth state)</li> <li><code>birth_country</code>, qui est le pays de naissance du joueur (birth country)</li> </ul>"},{"location":"cours2/moneyball/instructions/#table-teams","title":"Table <code>teams</code>","text":"<p>La table <code>teams</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de chaque \u00e9quipe (team)</li> <li><code>year</code>, qui est l'ann\u00e9e de fondation de l'\u00e9quipe (year founded)</li> <li><code>name</code>, qui est le nom de l'\u00e9quipe (name)</li> <li><code>park</code>, qui est le nom du parc o\u00f9 l'\u00e9quipe joue (ou a jou\u00e9) (park)</li> </ul>"},{"location":"cours2/moneyball/instructions/#table-performances","title":"Table <code>performances</code>","text":"<p>La table <code>performances</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de la performance (performance)</li> <li><code>player_id</code>, qui est l'ID du joueur (player) qui a g\u00e9n\u00e9r\u00e9 la performance (performance)</li> <li><code>team_id</code>, qui est l'ID de l'\u00e9quipe (team) pour laquelle le joueur a g\u00e9n\u00e9r\u00e9 la performance (performance)</li> <li><code>year</code>, qui est l'ann\u00e9e \u00e0 laquelle le joueur a g\u00e9n\u00e9r\u00e9 la performance (year)</li> <li><code>G</code>, qui est le nombre de matchs jou\u00e9s (games played) par le joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>AB</code>, qui est le nombre de \"at bats\" (passages \u00e0 la batte) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>H</code>, qui est le nombre de coups s\u00fbrs (hits) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>2B</code>, qui est le nombre de doubles (coups s\u00fbrs de deux bases) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>3B</code>, qui est le nombre de triples (coups s\u00fbrs de trois bases) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>HR</code>, qui est le nombre de coups de circuit (home runs) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>RBI</code>, qui est le nombre de \"runs batted in\" (points produits) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> <li><code>SB</code>, qui est le nombre de buts vol\u00e9s (stolen bases) du joueur, pour l'\u00e9quipe donn\u00e9e, l'ann\u00e9e donn\u00e9e</li> </ul>"},{"location":"cours2/moneyball/instructions/#table-salaries","title":"Table <code>salaries</code>","text":"<p>La table <code>salaries</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du salaire (salary)</li> <li><code>player_id</code>, qui est l'ID du joueur (player) gagnant le salaire (salary)</li> <li><code>team_id</code>, qui est l'ID de l'\u00e9quipe (team) payant le salaire (salary)</li> <li><code>year</code>, qui est l'ann\u00e9e pendant laquelle le salaire (salary) a \u00e9t\u00e9 pay\u00e9</li> <li><code>salary</code>, qui est le salaire (salary) lui-m\u00eame en dollars am\u00e9ricains (non ajust\u00e9 pour l'inflation)</li> </ul>"},{"location":"cours2/moneyball/instructions/#specification","title":"Sp\u00e9cification","text":""},{"location":"cours2/moneyball/instructions/#1sql","title":"<code>1.sql</code>","text":"<p>Vous devriez commencer par vous faire une id\u00e9e de l'\u00e9volution des salaires moyens des joueurs au fil du temps. Dans <code>1.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le salaire moyen des joueurs par ann\u00e9e (year).</p> <ul> <li>Triez par ann\u00e9e (year) en ordre d\u00e9croissant.</li> <li>Arrondissez le salaire (salary) \u00e0 deux d\u00e9cimales et appelez la colonne \"salaire moyen\" (average salary).</li> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour l'ann\u00e9e (year) et une pour le salaire moyen (average salary).</li> </ul>"},{"location":"cours2/moneyball/instructions/#2sql","title":"<code>2.sql</code>","text":"<p>Votre directeur g\u00e9n\u00e9ral (c'est-\u00e0-dire la personne qui prend des d\u00e9cisions sur les contrats des joueurs) vous demande si l'\u00e9quipe devrait \u00e9changer un joueur actuel contre Cal Ripken Jr., une star qui approche probablement de sa retraite. Dans <code>2.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver l'historique des salaires (salary history) de Cal Ripken Jr.</p> <ul> <li>Triez par ann\u00e9e (year) en ordre d\u00e9croissant.</li> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour l'ann\u00e9e (year) et une pour le salaire (salary).</li> </ul>"},{"location":"cours2/moneyball/instructions/#3sql","title":"<code>3.sql</code>","text":"<p>Votre \u00e9quipe a besoin d'un excellent frappeur de coups de circuit (home run hitter). Ken Griffey Jr., un laur\u00e9at de longue date du Silver Slugger et du Gold Glove, pourrait \u00eatre un bon prospect. Dans <code>3.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver l'historique des coups de circuit (home run history) de Ken Griffey Jr.</p> <ul> <li>Triez par ann\u00e9e (year) en ordre d\u00e9croissant.</li> <li>Notez qu'il peut y avoir deux joueurs portant le nom \"Ken Griffey.\" Ce Ken Griffey est n\u00e9 en 1969.</li> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour l'ann\u00e9e (year) et une pour les coups de circuit (home runs).</li> </ul>"},{"location":"cours2/moneyball/instructions/#4sql","title":"<code>4.sql</code>","text":"<p>Vous devez faire une recommandation sur les joueurs que l'\u00e9quipe devrait envisager d'engager. Avec le budget limit\u00e9 de l'\u00e9quipe, le directeur g\u00e9n\u00e9ral veut savoir quels joueurs ont \u00e9t\u00e9 les moins bien pay\u00e9s en 2001. Dans <code>4.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 50 joueurs les moins bien pay\u00e9s en 2001.</p> <ul> <li>Triez les joueurs par salaire (salary), du plus bas au plus \u00e9lev\u00e9.</li> <li>Si deux joueurs ont le m\u00eame salaire (salary), triez par ordre alphab\u00e9tique par pr\u00e9nom (first name) puis par nom de famille (last name).</li> <li>Si deux joueurs ont le m\u00eame pr\u00e9nom (first name) et nom de famille (last name), triez par ID du joueur (player ID).</li> <li>Votre requ\u00eate doit retourner trois colonnes, une pour les pr\u00e9noms des joueurs (first names), une pour leurs noms de famille (last names) et une pour leurs salaires (salaries).</li> </ul>"},{"location":"cours2/moneyball/instructions/#5sql","title":"<code>5.sql</code>","text":"<p>C'est une journ\u00e9e un peu calme au bureau. Bien que Satchel ne joue plus, dans <code>5.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver toutes les \u00e9quipes (teams) pour lesquelles Satchel Paige a jou\u00e9.</p> <ul> <li>Votre requ\u00eate doit retourner une table avec une seule colonne, une pour les noms des \u00e9quipes (names of the teams).</li> </ul>"},{"location":"cours2/moneyball/instructions/#6sql","title":"<code>6.sql</code>","text":"<p>Quelles \u00e9quipes pourraient \u00eatre les plus grandes concurrentes des A's cette ann\u00e9e ? Dans <code>6.sql</code>, \u00e9crivez une requ\u00eate SQL pour retourner les 5 meilleures \u00e9quipes (top 5 teams), tri\u00e9es par le nombre total de coups s\u00fbrs (total hits) r\u00e9alis\u00e9s par les joueurs en 2001.</p> <ul> <li>Appelez la colonne repr\u00e9sentant le nombre total de coups s\u00fbrs (total hits) r\u00e9alis\u00e9s par les joueurs en 2001 \"total hits\" (total hits).</li> <li>Triez par nombre total de coups s\u00fbrs (total hits), du plus \u00e9lev\u00e9 au plus bas.</li> <li>Votre requ\u00eate doit retourner deux colonnes, une pour les noms des \u00e9quipes (names of the teams) et une pour leurs coups s\u00fbrs totaux (total hits) en 2001.</li> </ul>"},{"location":"cours2/moneyball/instructions/#7sql","title":"<code>7.sql</code>","text":"<p>Vous devez faire une recommandation sur le ou les joueurs \u00e0 \u00e9viter de recruter. Dans <code>7.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le nom du joueur (player) qui a \u00e9t\u00e9 le mieux pay\u00e9 de tous les temps en Ligue Majeure de Baseball (Major League Baseball).</p> <ul> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour le pr\u00e9nom du joueur (first name) et une pour son nom de famille (last name).</li> </ul>"},{"location":"cours2/moneyball/instructions/#8sql","title":"<code>8.sql</code>","text":"<p>Combien les A's devraient-ils payer pour obtenir le meilleur frappeur de coups de circuit (home run hitter) de la saison derni\u00e8re ? Dans <code>8.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver le salaire de 2001 (2001 salary) du joueur qui a frapp\u00e9 le plus de coups de circuit (home runs) en 2001.</p> <ul> <li>Votre requ\u00eate doit retourner une table avec une colonne, le salaire (salary) du joueur.</li> </ul>"},{"location":"cours2/moneyball/instructions/#9sql","title":"<code>9.sql</code>","text":"<p>Quels salaires les autres \u00e9quipes paient-elles ? Dans <code>9.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 5 \u00e9quipes les moins bien pay\u00e9es (par salaire moyen) en 2001.</p> <ul> <li>Arrondissez la colonne du salaire moyen (average salary) \u00e0 deux d\u00e9cimales et appelez-la \"salaire moyen\" (average salary).</li> <li>Triez les \u00e9quipes par salaire moyen (average salary), du plus bas au plus \u00e9lev\u00e9.</li> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour les noms des \u00e9quipes (names of the teams) et une pour leur salaire moyen (average salary).</li> </ul>"},{"location":"cours2/moneyball/instructions/#10sql","title":"<code>10.sql</code>","text":"<p>Le directeur g\u00e9n\u00e9ral vous a demand\u00e9 un rapport d\u00e9taillant le nom de chaque joueur (player), son salaire (salary) pour chaque ann\u00e9e o\u00f9 il a jou\u00e9, et son nombre de coups de circuit (home runs) pour chaque ann\u00e9e o\u00f9 il a jou\u00e9. Pour \u00eatre pr\u00e9cis, le tableau doit inclure :</p> <ul> <li>Les pr\u00e9noms de tous les joueurs (first names of all players)</li> <li>Les noms de famille de tous les joueurs (last names of all players)</li> <li>Les salaires de tous les joueurs (salaries of all players)</li> <li>Les coups de circuit de tous les joueurs (home runs of all players)</li> <li>L'ann\u00e9e (year) \u00e0 laquelle le joueur a \u00e9t\u00e9 pay\u00e9 ce salaire (salary) et a frapp\u00e9 ces coups de circuit (home runs)</li> </ul> <p>Dans <code>10.sql</code>, \u00e9crivez une requ\u00eate pour retourner un tel tableau.</p> <ul> <li>Votre requ\u00eate doit retourner une table avec cinq colonnes, selon ce qui pr\u00e9c\u00e8de.</li> <li>Triez les r\u00e9sultats, d'abord et avant tout, par ID des joueurs (player IDs) (du plus bas au plus \u00e9lev\u00e9).</li> <li>Triez les lignes concernant le m\u00eame joueur par ann\u00e9e (year), en ordre d\u00e9croissant.</li> <li>Consid\u00e9rez un cas particulier : supposons qu'un joueur ait plusieurs salaires (salaries) ou performances (performances) pour une ann\u00e9e donn\u00e9e. Triez-les d'abord par nombre de coups de circuit (home runs), en ordre d\u00e9croissant, puis par salaire (salary), en ordre d\u00e9croissant.</li> <li>Assurez-vous que, pour une seule ligne, l'ann\u00e9e (year) du salaire (salary) et l'ann\u00e9e (year) de la performance (performance) correspondent.</li> </ul>"},{"location":"cours2/moneyball/instructions/#11sql","title":"<code>11.sql</code>","text":"<p>Vous avez besoin d'un joueur qui peut obtenir des coups s\u00fbrs (hits). Qui pourrait \u00eatre le plus sous-estim\u00e9 ? Dans <code>11.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les 10 joueurs les moins chers par coup s\u00fbr (hit) en 2001.</p> <ul> <li>Votre requ\u00eate doit retourner une table avec trois colonnes, une pour les pr\u00e9noms des joueurs (first names), une pour leurs noms de famille (last names) et une appel\u00e9e \"dollars par coup s\u00fbr\" (dollars per hit).</li> <li>Vous pouvez calculer la colonne \"dollars par coup s\u00fbr\" (dollars per hit) en divisant le salaire (salary) d'un joueur en 2001 par le nombre de coups s\u00fbrs (hits) qu'il a r\u00e9alis\u00e9s en 2001. Rappelez-vous que vous pouvez utiliser <code>AS</code> pour renommer une colonne.</li> <li>Diviser un salaire (salary) par 0 coup s\u00fbr (hit) donnera une valeur <code>NULL</code>. \u00c9vitez le probl\u00e8me en filtrant les joueurs avec 0 coup s\u00fbr (hit).</li> <li>Triez la table par la colonne \"dollars par coup s\u00fbr\" (dollars per hit), du moins cher au plus cher. Si deux joueurs ont le m\u00eame \"dollars par coup s\u00fbr\" (dollars per hit), triez par pr\u00e9nom (first name), puis par nom de famille (last name), par ordre alphab\u00e9tique.</li> <li>Comme dans <code>10.sql</code>, assurez-vous que l'ann\u00e9e (year) du salaire (salary) et l'ann\u00e9e (year) de la performance (performance) correspondent.</li> <li>Vous pouvez supposer, pour simplifier, qu'un joueur n'aura qu'un seul salaire (salary) et une seule performance (performance) en 2001.</li> </ul>"},{"location":"cours2/moneyball/instructions/#12sql","title":"<code>12.sql</code>","text":"<p>Les coups s\u00fbrs (hits) sont formidables, mais les RBIs (runs batted in) le sont aussi ! Dans <code>12.sql</code>, \u00e9crivez une requ\u00eate SQL pour trouver les joueurs parmi les 10 moins chers par coup s\u00fbr (hit) et parmi les 10 moins chers par RBI en 2001.</p> <ul> <li>Votre requ\u00eate doit retourner une table avec deux colonnes, une pour les pr\u00e9noms des joueurs (first names) et une pour leurs noms de famille (last names).</li> <li>Vous pouvez calculer le salaire (salary) d'un joueur par RBI en divisant son salaire (salary) de 2001 par son nombre de RBIs en 2001.</li> <li>Vous pouvez supposer, pour simplifier, qu'un joueur n'aura qu'un seul salaire (salary) et une seule performance (performance) en 2001.</li> <li>Triez vos r\u00e9sultats par ID du joueur (player ID), du plus bas au plus \u00e9lev\u00e9 (ou par ordre alphab\u00e9tique par nom de famille (last name), car les deux sont identiques dans ce cas !).</li> <li>Gardez \u00e0 l'esprit les le\u00e7ons apprises dans <code>10.sql</code> et <code>11.sql</code> !</li> </ul>"},{"location":"cours2/moneyball/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos requ\u00eates au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant :</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read 1.sql\n</code></pre> <p>Vous pouvez \u00e9galement ex\u00e9cuter :</p> <pre><code>$ cat FILENAME | sqlite3 moneyball.db &gt; output.txt\n</code></pre> <p>pour rediriger la sortie de la requ\u00eate vers un fichier texte nomm\u00e9 <code>output.txt</code>. (Cela peut \u00eatre utile pour v\u00e9rifier combien de lignes sont retourn\u00e9es par votre requ\u00eate !)</p>"},{"location":"cours2/moneyball/instructions/#remerciements","title":"Remerciements","text":"<p>R\u00e9cit adapt\u00e9 du livre de Michael Lewis, Moneyball : The Art of Winning an Unfair Game. Donn\u00e9es adapt\u00e9es de la Lahman Baseball Database, sous licence Creative Commons Attribution-ShareAlike 3.0 Unported License.</p>"},{"location":"cours2/packages/instructions/","title":"Livraisons, S'il Vous Pla\u00eet","text":""},{"location":"cours2/packages/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Vous \u00eates un employ\u00e9 de bureau de poste pour la ville de Boston et, \u00e0 ce titre, vous supervisez la livraison du courrier dans toute la ville. Pour la plupart, tous les colis envoy\u00e9s sont finalement livr\u00e9s. Sauf que, de temps en temps, un myst\u00e8re vous tombe dessus : un colis manquant ! Pour chaque client qui vient vous signaler un colis manquant, votre travail consiste \u00e0 d\u00e9terminer :</p> <ul> <li>L'adresse actuelle (ou l'emplacement !) de leur colis manquant</li> <li>Le type d'adresse ou d'emplacement (par exemple, r\u00e9sidentiel, commercial, etc.)</li> <li>Le contenu du colis</li> </ul> <p>Tout ce que vous savez est ce que les clients eux-m\u00eames vous diront. Pour r\u00e9soudre chaque myst\u00e8re, vous devrez utiliser la base de donn\u00e9es du service de livraison de courrier, <code>packages.db</code>, qui contient des donn\u00e9es sur le transit des colis dans la ville. En utilisant uniquement les informations de la base de donn\u00e9es, votre t\u00e2che est d'aider chaque client \u00e0 retrouver son colis manquant.</p>"},{"location":"cours2/packages/instructions/#distribution-du-code","title":"Distribution du Code","text":"<p>Pour ce probl\u00e8me, vous devrez utiliser <code>packages.db</code>, ainsi qu'un fichier <code>.sql</code> et un fichier <code>.txt</code> dans lesquels vous \u00e9crirez vos requ\u00eates et r\u00e9ponses.</p>"},{"location":"cours2/packages/instructions/#schema","title":"Sch\u00e9ma","text":"<p><code>packages.db</code> repr\u00e9sente toutes les livraisons de colis r\u00e9centes dans la ville de Boston. Pour ce faire, <code>packages.db</code> repr\u00e9sente les entit\u00e9s suivantes :</p> <ul> <li>Chauffeurs, qui sont les personnes qui livrent les colis</li> <li>Les colis eux-m\u00eames</li> <li>Adresses, comme 1234 Main Street</li> <li>Scans des colis, qui repr\u00e9sentent des confirmations qu'un chauffeur de livraison a pris ou d\u00e9pos\u00e9 un colis donn\u00e9</li> </ul> <p>Ces entit\u00e9s sont li\u00e9es selon le diagramme de relation d'entit\u00e9 (ER) ci-dessous :</p> <pre><code>erDiagram\n    \"Package\" }o--|| \"Address\": \"from\"\n    \"Package\" }o--|| \"Address\": \"to\"\n    \"Scan\" }|--|| \"Package\" : \"of\"\n    \"Scan\" }o--|| \"Address\" : \"at\"\n    \"Driver\" ||--o{ \"Scan\" : \"makes\"\n</code></pre>"},{"location":"cours2/packages/instructions/#table-addresses","title":"Table <code>addresses</code>","text":"<p>La table <code>addresses</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de l'adresse</li> <li><code>address</code>, qui est l'adresse elle-m\u00eame (par exemple, 7660 Sharon Street)</li> <li><code>type</code>, qui est le type d'adresse (par exemple, r\u00e9sidentiel, commercial, etc.)</li> </ul>"},{"location":"cours2/packages/instructions/#table-drivers","title":"Table <code>drivers</code>","text":"<p>La table <code>drivers</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du chauffeur</li> <li><code>name</code>, qui est le pr\u00e9nom du chauffeur</li> </ul>"},{"location":"cours2/packages/instructions/#table-packages","title":"Table <code>packages</code>","text":"<p>La table <code>packages</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du colis</li> <li><code>contents</code>, qui contient le contenu du colis</li> <li><code>from_address_id</code>, qui est l'ID de l'adresse d'o\u00f9 le colis a \u00e9t\u00e9 envoy\u00e9</li> <li><code>to_address_id</code>, qui est l'ID de l'adresse \u00e0 laquelle le colis a \u00e9t\u00e9 envoy\u00e9. Ce n'est pas n\u00e9cessairement l\u00e0 o\u00f9 il a fini !</li> </ul>"},{"location":"cours2/packages/instructions/#table-scans","title":"Table <code>scans</code>","text":"<p>La table <code>scans</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID du scan</li> <li><code>driver_id</code>, qui est l'ID du chauffeur qui a cr\u00e9\u00e9 le scan</li> <li><code>package_id</code>, qui est l'ID du colis scann\u00e9</li> <li><code>address_id</code>, qui est l'ID de l'adresse o\u00f9 le colis a \u00e9t\u00e9 scann\u00e9</li> <li><code>action</code>, qui indique si le colis a \u00e9t\u00e9 pris en charge (\"Pick\") ou d\u00e9pos\u00e9 (\"Drop\")</li> <li><code>timestamp</code>, qui est le jour et l'heure auxquels le colis a \u00e9t\u00e9 scann\u00e9</li> </ul>"},{"location":"cours2/packages/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Pour ce probl\u00e8me, il est tout aussi important de trouver les colis que le processus que vous utilisez pour le faire. Dans <code>log.sql</code>, gardez une trace de toutes les requ\u00eates SQL que vous ex\u00e9cutez sur la base de donn\u00e9es. Au-dessus de chaque requ\u00eate, \u00e9tiquetez-la avec un commentaire : en SQL, les commentaires sont toutes les lignes qui commencent par <code>--</code>, comme suit :</p> <pre><code>-- Ceci est un commentaire SQL\n</code></pre> <p>Le commentaire doit d\u00e9crire pourquoi vous ex\u00e9cutez la requ\u00eate et quelles informations vous esp\u00e9rez obtenir de cette requ\u00eate particuli\u00e8re. Vous pouvez \u00e9galement utiliser des commentaires pour ajouter des notes suppl\u00e9mentaires sur votre processus de r\u00e9flexion lorsque vous r\u00e9solvez chaque myst\u00e8re : en fin de compte, ce fichier doit servir de preuve du processus que vous avez utilis\u00e9 pour trouver chaque colis !</p> <p>Une fois que vous avez trouv\u00e9 l'emplacement d'un colis, compl\u00e9tez chacune des lignes dans <code>answers.txt</code> en remplissant les d\u00e9tails sur l'emplacement du colis, ainsi que son contenu. Assurez-vous de ne pas modifier le texte existant dans le fichier ou d'ajouter d'autres lignes au fichier !</p>"},{"location":"cours2/packages/instructions/#la-lettre-perdue","title":"La Lettre Perdue","text":"<p>Votre premier rapport de colis manquant provient d'Anneke. Anneke s'approche de votre comptoir et vous dit ce qui suit :</p> <p>Monsieur, je m'appelle Anneke. J'habite au 900 Somerville Avenue. Il n'y a pas longtemps, j'ai envoy\u00e9 une lettre sp\u00e9ciale. Elle est destin\u00e9e \u00e0 mon amie Varsha. Elle commence un nouveau chapitre de sa vie au 2 Finnegan Street, en centre-ville. (Cette adresse, laissez-moi vous dire : elle \u00e9tait un peu difficile \u00e0 obtenir correctement la premi\u00e8re fois.) La lettre est un mot de f\u00e9licitations\u2014une petite accolade en papier de moi \u00e0 elle, pour c\u00e9l\u00e9brer ce grand d\u00e9m\u00e9nagement. Pouvez-vous v\u00e9rifier si elle est arriv\u00e9e jusqu'\u00e0 elle ?</p> <p>Dans <code>log.sql</code>, sous <code>-- *** La Lettre Perdue ***</code>, gardez une trace des requ\u00eates SQL que vous utilisez pour trouver la lettre perdue d'Anneke. Une fois que vous l'avez trouv\u00e9e, d\u00e9crivez-la selon les questions dans <code>answers.txt</code>.</p>"},{"location":"cours2/packages/instructions/#la-livraison-malicieuse","title":"La Livraison Malicieuse","text":"<p>Votre deuxi\u00e8me rapport de colis manquant provient d'un individu myst\u00e9rieux d'une ville voisine. Il s'approche de votre comptoir et vous dit ce qui suit :</p> <p>Bonjour, M. le livreur. Vous vous souvenez peut-\u00eatre qu'il n'y a pas longtemps, je suis venu de la ville de Fiftyville. J'ai remis une certaine bo\u00eete entre vos mains et vous ai demand\u00e9 de rester discret. Mon associ\u00e9 attend ce colis depuis un moment maintenant. Et pourtant, il semble avoir disparu. Ha ! Y a-t-il une chance que vous puissiez \u00e9claircir ce myst\u00e8re ? D\u00e9sol\u00e9, il n'y a pas d'adresse \"De\".</p> <p>Dans <code>log.sql</code>, sous <code>-- *** La Livraison Malicieuse ***</code>, gardez une trace des requ\u00eates SQL que vous utilisez pour trouver le colis. Une fois que vous l'avez trouv\u00e9, d\u00e9crivez-le selon les questions dans <code>answers.txt</code>.</p>"},{"location":"cours2/packages/instructions/#le-cadeau-oublie","title":"Le Cadeau Oubli\u00e9","text":"<p>Votre troisi\u00e8me rapport de colis manquant provient d'un grand-parent qui habite pr\u00e8s du bureau de poste. Il s'approche de votre comptoir et vous dit ce qui suit :</p> <p>Oh, excusez-moi, Agent. J'avais envoy\u00e9 un cadeau myst\u00e8re, voyez-vous, \u00e0 ma merveilleuse petite-fille, au 728 Maple Place. C'\u00e9tait il y a environ deux semaines. Maintenant, la date de livraison est pass\u00e9e de sept jours entiers et j'apprends qu'elle attend toujours, les mains vides et le c\u0153ur rempli d'anticipation. Je suis un peu inquiet et je me demande o\u00f9 mon colis est pass\u00e9. Je ne me souviens pas pour la vie de moi ce qu'il y a \u00e0 l'int\u00e9rieur, mais je sais qu'il est rempli \u00e0 ras bord de mon amour pour elle. Pourrions-nous \u00e9ventuellement le retrouver pour qu'il puisse remplir sa journ\u00e9e de joie ? Je l'ai envoy\u00e9 de chez moi au 109 Tileston Street.</p> <p>Dans <code>log.sql</code>, sous <code>-- *** Le Cadeau Oubli\u00e9 ***</code>, gardez une trace des requ\u00eates SQL que vous utilisez pour trouver le cadeau. Une fois que vous l'avez trouv\u00e9, d\u00e9crivez-le selon les questions dans <code>answers.txt</code>.</p>"},{"location":"cours3/","title":"Cours 3","text":""},{"location":"cours3/#introduction","title":"Introduction","text":"<ul> <li>Nous allons apprendre \u00e0 concevoir nos propres sch\u00e9mas de base de donn\u00e9es.</li> <li>Jusqu'\u00e0 pr\u00e9sent, nous avons principalement travaill\u00e9 avec une base de donn\u00e9es d\u00e9j\u00e0 cr\u00e9e. Maintenant, nous allons examiner ce qui se passe sous le capot et voir quelles commandes peuvent \u00eatre utilis\u00e9es pour cr\u00e9er une telle base de donn\u00e9es.</li> <li>Commen\u00e7ons par ouvrir la base de donn\u00e9es <code>longlist.db</code> de la Semaine 0 sur notre terminal. Pour rappel, cette base de donn\u00e9es contenait une seule table, appel\u00e9e <code>longlist</code>. Pour voir un aper\u00e7u de la table, nous pouvons ex\u00e9cuter :</li> </ul> <pre><code>SELECT \"author\", \"title\"\nFROM \"longlist\"\nLIMIT 5;\n</code></pre> <p>Cela nous donne les auteurs et titres des 5 premi\u00e8res lignes de la table <code>longlist</code>. - Voici une commande SQLite (pas un mot-cl\u00e9 SQL) qui peut \u00e9clairer comment cette base de donn\u00e9es a \u00e9t\u00e9 cr\u00e9\u00e9e :</p> <pre><code>.schema\n</code></pre> <p>En ex\u00e9cutant cette commande, nous voyons l'instruction SQL utilis\u00e9e pour cr\u00e9er la table <code>longlist</code>. Cela nous montre les colonnes \u00e0 l'int\u00e9rieur de <code>longlist</code> et les types de donn\u00e9es que chaque colonne est capable de stocker. - Ensuite, ouvrons la m\u00eame base de donn\u00e9es de la Semaine 1 sur notre terminal. Cette version de <code>longlist.db</code> contenait diff\u00e9rentes tables li\u00e9es entre elles. - En ex\u00e9cutant \u00e0 nouveau <code>.schema</code>, nous voyons plusieurs commandes \u2014 une pour chaque table de la base de donn\u00e9es. Il existe un moyen de voir le sch\u00e9ma pour une table sp\u00e9cifi\u00e9e :</p> <pre><code>.schema books\n</code></pre> <p>Maintenant, nous voyons l'instruction utilis\u00e9e pour cr\u00e9er la table <code>books</code>. Nous pouvons \u00e9galement voir les colonnes et les types de donn\u00e9es pour chaque colonne. Par exemple, la colonne <code>\"title\"</code> prend du texte et la colonne <code>\"publisher_id\"</code> est un entier.</p>"},{"location":"cours3/#creation-dun-schema-de-base-de-donnees","title":"Cr\u00e9ation d'un Sch\u00e9ma de Base de Donn\u00e9es","text":"<ul> <li>Maintenant que nous avons vu le sch\u00e9ma d'une base de donn\u00e9es existante, cr\u00e9ons le n\u00f4tre ! Nous devons repr\u00e9senter le syst\u00e8me de m\u00e9tro de la ville de Boston \u00e0 travers un sch\u00e9ma de base de donn\u00e9es. Cela inclut les stations de m\u00e9tro, les diff\u00e9rentes lignes de train, et les personnes qui prennent les trains.</li> </ul> <ul> <li>Pour d\u00e9composer la question, nous devons d\u00e9cider :</li> <li>quels types de tables nous aurons dans notre base de donn\u00e9es du m\u00e9tro de Boston,</li> <li>quelles colonnes chacune des tables aura, et</li> <li>quels types de donn\u00e9es nous devons mettre dans chacune de ces colonnes.</li> </ul>"},{"location":"cours3/#normalisation","title":"Normalisation","text":"<ul> <li>Observons cette premi\u00e8re tentative de cr\u00e9ation d'une table pour repr\u00e9senter les donn\u00e9es du m\u00e9tro de Boston. Cette table contient les noms des usagers du m\u00e9tro, les stations actuelles o\u00f9 se trouvent les usagers et l'action effectu\u00e9e \u00e0 la station (comme entrer et sortir). Elle enregistre \u00e9galement les tarifs pay\u00e9s et les soldes sur leurs cartes de m\u00e9tro. Cette table contient \u00e9galement un ID pour chaque \"transaction\" d'usager, qui sert de cl\u00e9 primaire.</li> </ul> <ul> <li>Quelles redondances existent dans cette table ?</li> <li>Nous pourrions s\u00e9parer les noms des usagers dans une table \u00e0 part, pour \u00e9viter de dupliquer les noms autant de fois. Nous devrions donner \u00e0 chaque usager un ID qui peut \u00eatre utilis\u00e9 pour relier la nouvelle table \u00e0 celle-ci.</li> <li>De m\u00eame, nous pourrions d\u00e9placer les stations de m\u00e9tro dans une table diff\u00e9rente et donner \u00e0 chaque station de m\u00e9tro un ID \u00e0 utiliser comme cl\u00e9 \u00e9trang\u00e8re ici.</li> <li>Le processus de s\u00e9paration de nos donn\u00e9es de cette mani\u00e8re s'appelle la normalisation. Lors de la normalisation, nous mettons chaque entit\u00e9 dans sa propre table \u2014 comme nous l'avons fait avec les usagers et les stations de m\u00e9tro. Toute information sur une entit\u00e9 sp\u00e9cifique, par exemple l'adresse d'un usager, va dans la table de l'entit\u00e9 elle-m\u00eame.</li> </ul>"},{"location":"cours3/#relation","title":"Relation","text":"<ul> <li>Nous devons maintenant d\u00e9cider comment nos entit\u00e9s (usagers et stations) sont li\u00e9es. Un usager visitera probablement plusieurs stations, et une station de m\u00e9tro aura probablement plus d'un usager. \u00c9tant donn\u00e9 cela, ce sera une relation plusieurs-\u00e0-plusieurs.</li> <li>Nous pouvons \u00e9galement utiliser un diagramme ER (Entity-Relationship) pour repr\u00e9senter cette relation.</li> </ul> <p>Ici, nous voyons que chaque usager doit visiter au moins une station pour \u00eatre consid\u00e9r\u00e9 comme un usager. Une station, cependant, pourrait n'avoir aucun usager la visitant, car elle pourrait \u00eatre temporairement hors service. Cependant, il est probable qu'une station ait plusieurs usagers la visitant, indiqu\u00e9 par la patte-d'oie dans le diagramme ER.</p>"},{"location":"cours3/#questions","title":"Questions","text":"<p>La relation entre les usagers et les stations doit-elle \u00eatre exactement comme d\u00e9crite ici ? Par exemple, pourquoi est-il acceptable qu'une station n'ait aucun usager ?</p> <ul> <li>C'est \u00e0 la personne qui con\u00e7oit la base de donn\u00e9es de prendre des d\u00e9cisions sur les relations entre les entit\u00e9s. Il est possible d'ajouter une contrainte qui dit qu'une station doit avoir au moins un usager pour \u00eatre consid\u00e9r\u00e9e comme une station.</li> </ul>"},{"location":"cours3/#create-table","title":"<code>CREATE TABLE</code>","text":"<ul> <li>Maintenant que nous avons le sch\u00e9ma pour deux des tables, allons-y et cr\u00e9ons les tables.</li> <li>Ouvrons une nouvelle base de donn\u00e9es appel\u00e9e <code>mbta.db</code> \u2014 MBTA signifie Massachusetts Bay Transportation Authority et g\u00e8re le m\u00e9tro de Boston.</li> <li>Si nous ex\u00e9cutons <code>.schema</code>, nous ne verrons rien car aucune table n'a encore \u00e9t\u00e9 cr\u00e9\u00e9e dans cette base de donn\u00e9es.</li> <li>Dans cette base de donn\u00e9es, ex\u00e9cutons la commande suivante pour cr\u00e9er la premi\u00e8re table pour les usagers :</li> </ul> <pre><code>CREATE TABLE riders (\n    \"id\",\n    \"name\"\n);\n</code></pre> <p>En ex\u00e9cutant cela, aucun r\u00e9sultat n'appara\u00eet sur le terminal. Mais si nous ex\u00e9cutons \u00e0 nouveau <code>.schema</code>, nous verrons maintenant le sch\u00e9ma pour la table <code>riders</code>, tel que nous l'avons d\u00e9fini ! - De m\u00eame, cr\u00e9ons une table pour les stations \u00e9galement.</p> <pre><code>CREATE TABLE stations (\n    \"id\",\n    \"name\",\n    \"line\"\n);\n</code></pre> <p>Ici, nous ajoutons une colonne <code>\"line\"</code> pour stocker la ligne de train \u00e0 laquelle appartient la station. - <code>.schema</code> nous montre maintenant le sch\u00e9ma pour <code>riders</code> et <code>stations</code>. - Ensuite, nous allons cr\u00e9er une table pour relier ces deux entit\u00e9s. Ces tables sont souvent appel\u00e9es tables de jonction, entit\u00e9s associatives ou tables de jointure !</p> <pre><code>CREATE TABLE visits (\n    \"rider_id\",\n    \"station_id\"\n);\n</code></pre> <p>Chaque ligne de cette table nous indique la station visit\u00e9e par un usager particulier.</p>"},{"location":"cours3/#questions_1","title":"Questions","text":"<p>Est-il n\u00e9cessaire d'indenter les lignes dans les parenth\u00e8ses <code>CREATE TABLE</code> ?</p> <ul> <li>Non, pas strictement. Cependant, nous indentons les noms des colonnes pour adh\u00e9rer aux conventions de style comme toujours !</li> </ul>"},{"location":"cours3/#types-de-donnees-et-classes-de-stockage","title":"Types de Donn\u00e9es et Classes de Stockage","text":"<ul> <li>SQLite a cinq classes de stockage :</li> <li><code>Null</code> : rien, ou valeur vide</li> <li><code>Integer</code> : nombres sans points d\u00e9cimaux</li> <li><code>Real</code> : nombres d\u00e9cimaux ou \u00e0 virgule flottante</li> <li><code>Text</code> : caract\u00e8res ou cha\u00eenes de caract\u00e8res</li> <li><code>Blob</code> : Binary Large Object, pour stocker des objets en binaire (utile pour les images, l'audio, etc.)</li> <li>Une classe de stockage peut contenir plusieurs types de donn\u00e9es.</li> <li>Par exemple, voici les types de donn\u00e9es qui rel\u00e8vent de la classe de stockage Integer.</li> </ul> <p>SQLite prend soin de stocker la valeur d'entr\u00e9e sous le bon type de donn\u00e9es. En d'autres termes, nous, en tant que programmeurs, n'avons besoin que de choisir une classe de stockage et SQLite fera le reste ! - Consid\u00e9rons cette question : quelle classe de stockage utiliserions-nous pour stocker les tarifs ? Chaque choix a ses avantages et ses limitations.   - Integers : Nous pouvons stocker un tarif de 10 centimes comme le nombre 10, mais cela ne rend pas tr\u00e8s clair si le tarif est de 10 centimes ou de 10 dollars.   - Text : Nous pouvons stocker le tarif en texte, comme \"$0.10\". Cependant, il sera alors difficile d'effectuer des op\u00e9rations math\u00e9matiques comme additionner les tarifs d'un usager.   - Real : Nous pouvons stocker le tarif en utilisant un nombre \u00e0 virgule flottante, comme 0.10, mais il n'est pas possible de stocker des nombres \u00e0 virgule flottante en binaire de mani\u00e8re pr\u00e9cise et \u2014 selon le niveau de pr\u00e9cision dont nous avons besoin \u2014 cela pourrait entra\u00eener des erreurs de calcul plus tard.</p>"},{"location":"cours3/#affinites-de-type","title":"Affinit\u00e9s de Type","text":"<ul> <li>Il est possible de sp\u00e9cifier le type de donn\u00e9es d'une colonne lors de la cr\u00e9ation d'une table.</li> <li>Cependant, les colonnes dans SQLite ne stockent pas toujours un type de donn\u00e9es particulier. Elles sont dites avoir des affinit\u00e9s de type, ce qui signifie qu'elles essaient de convertir une valeur d'entr\u00e9e dans le type pour lequel elles ont une affinit\u00e9.</li> <li>Les cinq affinit\u00e9s de type dans SQLite sont : Text, Numeric (soit des valeurs enti\u00e8res soit r\u00e9elles selon ce que la valeur d'entr\u00e9e convertit le mieux), Integer, Real et Blob.</li> <li>Consid\u00e9rons une colonne avec une affinit\u00e9 de type pour les Integers. Si nous essayons d'ins\u00e9rer \"25\" (le nombre 25 mais stock\u00e9 comme texte) dans cette colonne, il sera converti en un type de donn\u00e9es entier.</li> <li>De m\u00eame, ins\u00e9rer un entier 25 dans une colonne avec une affinit\u00e9 de type pour le texte convertira le nombre en son \u00e9quivalent texte, \"25\".</li> </ul>"},{"location":"cours3/#ajout-de-types-a-nos-tables","title":"Ajout de Types \u00e0 nos Tables","text":"<ul> <li>Pour recr\u00e9er les tables dans notre base de donn\u00e9es, nous devrons d'abord supprimer (ou supprimer) les tables existantes.</li> <li>Essayons les commandes suivantes :</li> </ul> <pre><code>DROP TABLE \"riders\";\n</code></pre> <pre><code>DROP TABLE \"stations\";\n</code></pre> <pre><code>DROP TABLE \"visits\";\n</code></pre> <p>L'ex\u00e9cution de ces instructions ne donne aucun r\u00e9sultat, mais <code>.schema</code> nous montre que les tables ont maintenant \u00e9t\u00e9 supprim\u00e9es. - Ensuite, cr\u00e9ons un fichier de sch\u00e9ma qui peut \u00eatre ex\u00e9cut\u00e9 pour cr\u00e9er les tables \u00e0 partir de z\u00e9ro. C'est une am\u00e9lioration par rapport \u00e0 ce que nous avons fait pr\u00e9c\u00e9demment \u2014 taper la commande <code>CREATE TABLE</code> pour chaque table \u2014 car cela nous permet de modifier et de voir tout le sch\u00e9ma facilement. - Cr\u00e9ons un fichier <code>schema.sql</code>. Remarquez l'extension <code>.sql</code> qui permet la coloration syntaxique pour les mots-cl\u00e9s SQL dans notre \u00e9diteur. - \u00c0 l'int\u00e9rieur du fichier, tapons \u00e0 nouveau les sch\u00e9mas, mais avec les types d'affinit\u00e9 cette fois.</p> <pre><code>CREATE TABLE riders (\n    \"id\" INTEGER,\n    \"name\" TEXT\n);\n\nCREATE TABLE stations (\n    \"id\" INTEGER,\n    \"name\" TEXT,\n    \"line\" TEXT\n);\n\nCREATE TABLE visits (\n    \"rider_id\" INTEGER,\n    \"station_id\" INTEGER\n);\n</code></pre> <ul> <li>Maintenant, lisons ce fichier dans la base de donn\u00e9es pour cr\u00e9er r\u00e9ellement les tables. Voici un diagramme ER mis \u00e0 jour avec les types de donn\u00e9es inclus.</li> </ul> <p></p>"},{"location":"cours3/#questions_2","title":"Questions","text":"<p>Auparavant, nous \u00e9tions capables d'interroger les tables de notre base de donn\u00e9es et de voir les r\u00e9sultats dans une structure de type tableau. Comment obtenir le m\u00eame type de r\u00e9sultats ici ?</p> <ul> <li>Nous n'avons pas encore ajout\u00e9 de donn\u00e9es aux tables. Dans le Cours 4, nous verrons comment ins\u00e9rer, mettre \u00e0 jour et supprimer des lignes dans les tables que nous avons cr\u00e9\u00e9es !</li> </ul> <p>Avons-nous une affinit\u00e9 de type pour Boolean ?</p> <ul> <li>Nous n'en avons pas dans SQLite, mais d'autres SGBD pourraient avoir cette option. Une solution de contournement pourrait \u00eatre d'utiliser des valeurs enti\u00e8res 0 ou 1 pour repr\u00e9senter des bool\u00e9ens. Nous verrons MySQL qui a une option Boolean \u00e0 la fin du cours.</li> </ul>"},{"location":"cours3/#contraintes-de-table","title":"Contraintes de Table","text":"<ul> <li>Nous pouvons utiliser des contraintes de table pour imposer des restrictions sur certaines valeurs dans nos tables.</li> <li>Par exemple, une colonne de cl\u00e9 primaire doit avoir des valeurs uniques. La contrainte de table que nous utilisons pour cela est <code>PRIMARY KEY</code>.</li> <li>De m\u00eame, une contrainte sur une valeur de cl\u00e9 \u00e9trang\u00e8re est qu'elle doit \u00eatre trouv\u00e9e dans la colonne de cl\u00e9 primaire de la table li\u00e9e ! Cette contrainte de table s'appelle, de mani\u00e8re pr\u00e9visible, <code>FOREIGN KEY</code>.</li> <li>Ajoutons des contraintes de cl\u00e9 primaire et \u00e9trang\u00e8re \u00e0 notre fichier <code>schema.sql</code>.</li> </ul> <pre><code>CREATE TABLE riders (\n    \"id\" INTEGER,\n    \"name\" TEXT,\n    PRIMARY KEY(\"id\")\n);\n\nCREATE TABLE stations (\n    \"id\" INTEGER,\n    \"name\" TEXT,\n    \"line\" TEXT,\n    PRIMARY KEY(\"id\")\n);\n\nCREATE TABLE visits (\n    \"rider_id\" INTEGER,\n    \"station_id\" INTEGER,\n    FOREIGN KEY(\"rider_id\") REFERENCES \"riders\"(\"id\"),\n    FOREIGN KEY(\"station_id\") REFERENCES \"stations\"(\"id\")\n);\n</code></pre> <p>Remarquez que nous avons cr\u00e9\u00e9 deux colonnes de cl\u00e9 primaire, l'ID pour <code>riders</code> et <code>stations</code>, puis nous les avons r\u00e9f\u00e9renc\u00e9es comme cl\u00e9s \u00e9trang\u00e8res dans la table <code>visits</code>. - Dans la table <code>visits</code>, il n'y a pas de cl\u00e9 primaire. Cependant, SQLite donne \u00e0 chaque table une cl\u00e9 primaire par d\u00e9faut, connue sous le nom de row ID. M\u00eame si le row ID est implicite, il peut \u00eatre interrog\u00e9 ! - Il est \u00e9galement possible de cr\u00e9er une cl\u00e9 primaire compos\u00e9e de deux colonnes. Par exemple, si nous voulions donner \u00e0 <code>visits</code> une cl\u00e9 primaire compos\u00e9e \u00e0 la fois des IDs des usagers et des stations, nous pourrions utiliser cette syntaxe :</p> <pre><code>CREATE TABLE visits (\n    \"rider_id\" INTEGER,\n    \"station_id\" INTEGER,\n    PRIMARY KEY(\"rider_id\", \"station_id\")\n);\n</code></pre> <p>Dans ce cas, nous voudrions probablement permettre \u00e0 un usager de visiter une station plus d'une fois, donc nous ne poursuivrions pas cette approche.</p>"},{"location":"cours3/#questions_3","title":"Questions","text":"<p>Est-il possible d'inclure notre propre cl\u00e9 primaire pour la table <code>visits</code> ?</p> <ul> <li>Oui ! Si, pour une raison quelconque, une cl\u00e9 primaire explicite \u00e9tait requise pour la table <code>visits</code>, nous pourrions cr\u00e9er une colonne ID et en faire la cl\u00e9 primaire.</li> </ul>"},{"location":"cours3/#contraintes-de-colonne","title":"Contraintes de Colonne","text":"<ul> <li>Une contrainte de colonne est un type de contrainte qui s'applique \u00e0 une colonne sp\u00e9cifi\u00e9e dans la table.</li> <li>SQLite a quatre contraintes de colonne :</li> <li><code>CHECK</code> : permet de v\u00e9rifier une condition, comme toutes les valeurs de la colonne doivent \u00eatre sup\u00e9rieures \u00e0 0</li> <li><code>DEFAULT</code> : utilise une valeur par d\u00e9faut si aucune n'est fournie pour une ligne</li> <li><code>NOT NULL</code> : dicte qu'une valeur nulle ou vide ne peut pas \u00eatre ins\u00e9r\u00e9e dans la colonne</li> <li><code>UNIQUE</code> : dicte que chaque valeur dans cette colonne doit \u00eatre unique</li> <li>Un sch\u00e9ma mis \u00e0 jour avec ces contraintes ressemblerait \u00e0 ce qui suit :</li> </ul> <pre><code>CREATE TABLE riders (\n    \"id\" INTEGER,\n    \"name\" TEXT,\n    PRIMARY KEY(\"id\"),\n    CHECK (LENGTH(\"name\") &gt;= 3) -- Check pour forcer une taille de nom d'au moins 3 charact\u00e8res\n);\n\nCREATE TABLE stations (\n    \"id\" INTEGER,\n    \"name\" TEXT NOT NULL UNIQUE,\n    \"line\" TEXT NOT NULL,\n    PRIMARY KEY(\"id\")\n);\n\nCREATE TABLE visits (\n    \"rider_id\" INTEGER,\n    \"station_id\" INTEGER,\n    FOREIGN KEY(\"rider_id\") REFERENCES \"riders\"(\"id\"),\n    FOREIGN KEY(\"station_id\") REFERENCES \"stations\"(\"id\")\n);\n</code></pre> <p>La contrainte <code>NOT NULL</code> garantit qu'un nom de station et une ligne sont sp\u00e9cifi\u00e9s. D'un autre c\u00f4t\u00e9, les usagers ne sont pas oblig\u00e9s de partager leurs noms, car il n'y a pas de contrainte appliqu\u00e9e aux noms des usagers. De m\u00eame, chaque station doit avoir un nom unique, comme dict\u00e9 par la contrainte <code>UNIQUE</code>. - Les colonnes de cl\u00e9 primaire et par extension, les colonnes de cl\u00e9 \u00e9trang\u00e8re doivent toujours avoir des valeurs uniques, donc il n'y a pas besoin de sp\u00e9cifier explicitement les contraintes de colonne <code>NOT NULL</code> ou <code>UNIQUE</code>. La contrainte de table <code>PRIMARY KEY</code> inclut ces contraintes de colonne.</p>"},{"location":"cours3/#modification-des-tables","title":"Modification des Tables","text":"<ul> <li>Consid\u00e9rons le diagramme ER mis \u00e0 jour suivant, o\u00f9 l'entit\u00e9 \"Rider\" a \u00e9t\u00e9 remplac\u00e9e par une nouvelle entit\u00e9 \"Card\" utilis\u00e9e pour repr\u00e9senter les CharlieCards. Les CharlieCards, dans le m\u00e9tro de Boston, peuvent \u00eatre charg\u00e9es avec de l'argent et sont utilis\u00e9es pour passer dans et parfois hors des stations.</li> </ul> <ul> <li>Remarquez qu'une carte peut \u00eatre pass\u00e9e plusieurs fois au total, mais seulement \u00e0 une station \u00e0 la fois.</li> <li>L'entit\u00e9 \"Card\" a un ID, qui est \u00e9galement sa cl\u00e9 primaire.</li> <li>Il y a maintenant aussi une entit\u00e9 \"Swipe\", avec son propre ID et un type. \"Swipe\" enregistre \u00e9galement l'heure \u00e0 laquelle une carte a \u00e9t\u00e9 pass\u00e9e et le montant qui a \u00e9t\u00e9 soustrait (\u00e9quivalent au montant d'argent n\u00e9cessaire pour prendre le m\u00e9tro) !</li> <li>Maintenant, pour impl\u00e9menter ces changements dans notre base de donn\u00e9es, nous devons d'abord supprimer la table <code>riders</code>.</li> </ul> <pre><code>DROP TABLE \"riders\";\n</code></pre> <ul> <li>En ex\u00e9cutant <code>.schema</code>, nous voyons le sch\u00e9ma mis \u00e0 jour sans la table <code>riders</code>.</li> <li>Ensuite, nous avons besoin d'une table <code>swipes</code> pour repr\u00e9senter l'entit\u00e9 \"Swipe\" de notre diagramme ER mis \u00e0 jour. Nous pourrions modifier la table <code>visits</code> de la mani\u00e8re suivante :</li> </ul> <pre><code>ALTER TABLE \"visits\"\nRENAME TO \"swipes\";\n</code></pre> <ul> <li>En ex\u00e9cutant <code>.schema</code>, nous pouvons voir que la table <code>visits</code> a \u00e9t\u00e9 renomm\u00e9e en <code>swipes</code>. Cependant, ce n'est pas le seul changement n\u00e9cessaire. Nous devons \u00e9galement ajouter quelques colonnes, comme le type de passage.</li> </ul> <pre><code>ALTER TABLE \"swipes\"\nADD COLUMN \"swipetype\" TEXT;\n</code></pre> <p>Remarquez que l'affinit\u00e9 de type <code>TEXT</code> est \u00e9galement mentionn\u00e9e lors de l'ajout de cette colonne. - Nous avons \u00e9galement la possibilit\u00e9 de renommer une colonne dans une commande <code>ALTER TABLE</code>. Si nous voulions renommer la colonne <code>\"swipetype\"</code> pour la rendre moins verbeuse, nous pourrions essayer ce qui suit :</p> <pre><code>ALTER TABLE \"swipes\"\nRENAME COLUMN \"swipetype\" TO \"type\";\n</code></pre> <ul> <li>Enfin, nous avons la possibilit\u00e9 de supprimer (ou retirer) une colonne.</li> </ul> <pre><code>ALTER TABLE \"swipes\"\nDROP COLUMN \"type\";\n</code></pre> <p>En ex\u00e9cutant \u00e0 nouveau <code>.schema</code>, nous pouvons confirmer que la colonne <code>\"type\"</code> a \u00e9t\u00e9 supprim\u00e9e de la table. - Il est \u00e9galement possible de revenir au fichier de sch\u00e9ma <code>schema.sql</code> que nous avions \u00e0 l'origine et simplement faire ces changements l\u00e0-bas au lieu de modifier les tables. Voici un <code>schema.sql</code> mis \u00e0 jour.</p> <pre><code>CREATE TABLE \"cards\" (\n    \"id\" INTEGER,\n    PRIMARY KEY(\"id\")\n);\n\nCREATE TABLE \"stations\" (\n    \"id\" INTEGER,\n    \"name\" TEXT NOT NULL UNIQUE,\n    \"line\" TEXT NOT NULL,\n    PRIMARY KEY(\"id\")\n);\n\nCREATE TABLE \"swipes\" (\n    \"id\" INTEGER,\n    \"card_id\" INTEGER,\n    \"station_id\" INTEGER,\n    \"type\" TEXT NOT NULL CHECK(\"type\" IN ('enter', 'exit', 'deposit')),\n    \"datetime\" NUMERIC NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"amount\" NUMERIC NOT NULL CHECK(\"amount\" != 0),\n    PRIMARY KEY(\"id\"),\n    FOREIGN KEY(\"station_id\") REFERENCES \"stations\"(\"id\"),\n    FOREIGN KEY(\"card_id\") REFERENCES \"cards\"(\"id\")\n);\n</code></pre> <ul> <li>Prenons quelques minutes pour lire le sch\u00e9ma mis \u00e0 jour et noter les choses qui semblent avoir chang\u00e9 !</li> <li>Les tables <code>cards</code> et <code>swipes</code> sont ajout\u00e9es et la contrainte de colonne <code>NOT NULL</code> est utilis\u00e9e pour exiger certaines valeurs dans <code>swipes</code>.</li> <li>La colonne <code>\"datetime\"</code> a l'affinit\u00e9 de type numeric \u2014 c'est parce que les types num\u00e9riques peuvent stocker et afficher des valeurs de date.</li> <li>La correspondance de cl\u00e9 \u00e9trang\u00e8re est ajust\u00e9e comme n\u00e9cessaire, de sorte que <code>\"card_id\"</code> est une cl\u00e9 \u00e9trang\u00e8re faisant r\u00e9f\u00e9rence \u00e0 l'ID de la table <code>cards</code>.</li> <li>Une valeur par d\u00e9faut est assign\u00e9e \u00e0 la colonne <code>\"datetime\"</code> afin qu'elle prenne automatiquement l'horodatage actuel si aucun n'est fourni. Remarquez l'utilisation de <code>CURRENT_TIMESTAMP</code> \u2014 il retourne l'ann\u00e9e, le mois, le jour, l'heure, la minute et la seconde combin\u00e9s en une seule valeur.</li> <li>Il y a une v\u00e9rification en place pour s'assurer que le montant sur un passage n'est pas 0. Cela est impl\u00e9ment\u00e9 par la contrainte de colonne <code>CHECK</code>, qui est utilis\u00e9e avec une expression <code>\"amount\" != 0</code> pour s'assurer que la valeur n'est pas 0.</li> <li>De m\u00eame, il y a une v\u00e9rification sur <code>\"type\"</code> pour s'assurer que sa valeur est l'une de 'enter', 'exit' et 'deposit'. Cela est fait parce que lorsqu'une CharlieCard est pass\u00e9e, c'est g\u00e9n\u00e9ralement pour l'une de ces trois raisons, donc il est logique que <code>\"type\"</code> prenne ces valeurs uniquement. Remarquez l'utilisation du mot-cl\u00e9 <code>IN</code> pour effectuer cette v\u00e9rification ! Y a-t-il un moyen d'impl\u00e9menter cette v\u00e9rification en utilisant l'op\u00e9rateur <code>OR</code> \u00e0 la place ?</li> </ul>"},{"location":"cours3/#questions_4","title":"Questions","text":"<p>En essayant de supprimer la table <code>riders</code>, une erreur appara\u00eet parce que nous utilisons l'ID de <code>riders</code> comme cl\u00e9 \u00e9trang\u00e8re. Comment la table peut-elle \u00eatre supprim\u00e9e dans ce cas ?</p> <ul> <li>Les contraintes de cl\u00e9 \u00e9trang\u00e8re au sein de la base de donn\u00e9es sont v\u00e9rifi\u00e9es lors de la suppression d'une table. Avant de supprimer <code>riders</code>, nous devrions d'abord supprimer la colonne de cl\u00e9 \u00e9trang\u00e8re <code>\"rider_id\"</code>.</li> </ul> <p>Comment la syntaxe est-elle diff\u00e9rente pour un autre SGBD comme MySQL ou PostgreSQL ?</p> <ul> <li>La plupart de la syntaxe SQLite s'applique d\u00e9finitivement aussi \u00e0 d'autres syst\u00e8mes de gestion de bases de donn\u00e9es. Cependant, si nous essayions de porter notre code SQLite, quelques modifications mineures seraient n\u00e9cessaires.</li> </ul> <p>Si nous ne sp\u00e9cifions pas d'affinit\u00e9 de type pour une colonne dans SQLite, que se passe-t-il ?</p> <ul> <li>L'affinit\u00e9 de type par d\u00e9faut est num\u00e9rique, donc la colonne se verrait assigner l'affinit\u00e9 de type num\u00e9rique.</li> </ul>"},{"location":"cours3/atl/instructions/","title":"ATL","text":""},{"location":"cours3/atl/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>L'a\u00e9roport international Hartsfield-Jackson, plus connu sous le nom de \"ATL\" pour son code IATA, est le plus fr\u00e9quent\u00e9 au monde depuis 1998. Situ\u00e9 \u00e0 Atlanta, en G\u00e9orgie, aux \u00c9tats-Unis, ATL a desservi 93,7 millions de passagers en 2022. </p> <p>Imaginons que vous venez d'\u00eatre embauch\u00e9 pour aider ATL \u00e0 restructurer leur syst\u00e8me de base de donn\u00e9es. Dans un fichier nomm\u00e9 <code>schema.sql</code> dans un dossier appel\u00e9 <code>atl</code>, \u00e9crivez un ensemble d'instructions SQL pour concevoir une base de donn\u00e9es permettant \u00e0 Hartsfield-Jackson de suivre ses passagers et leurs vols.</p> <p>Tapez ce qui suit dans votre terminal :</p> <pre><code>mkdir atl # cr\u00e9e un dossier vide \n</code></pre> <p>Notez que le dossier <code>atl</code> sera cr\u00e9\u00e9 dans le \"working directory\" de votre terminal (c'est-\u00e0-dire le dossier sur lequel votre terminal est actuellement concentr\u00e9). Si votre working directory est d\u00e9j\u00e0 un dossier nomm\u00e9 <code>pset2</code>, par exemple, <code>atl</code> sera cr\u00e9\u00e9 \u00e0 l'int\u00e9rieur du dossier <code>pset2</code>. (Pas besoin de cr\u00e9er un tel dossier <code>pset2</code> !)</p> <p>Une fois que vous avez cr\u00e9\u00e9 le dossier <code>atl</code>, vous pouvez taper ce qui suit pour changer le working directory de votre terminal vers le dossier <code>atl</code> :</p> <pre><code>cd atl # se d\u00e9place dans le dossier atl\n</code></pre> <p>Ensuite, tapez </p> <pre><code>touch schema.sql\n</code></pre> <p>pour cr\u00e9er un fichier <code>schema.sql</code> vierge.</p> <p>Pour vous souvenir de <code>mkdir</code> \u00e0 l'avenir, rappelez-vous que <code>mkdir</code> signifie \"make directory\" !</p>"},{"location":"cours3/atl/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Votre t\u00e2che est de cr\u00e9er une base de donn\u00e9es SQLite pour ATL \u00e0 partir de z\u00e9ro, en \u00e9crivant un ensemble d'instructions <code>CREATE TABLE</code> dans un fichier <code>schema.sql</code>. Les d\u00e9tails de mise en \u0153uvre d\u00e9pendent de vous, bien que vous devriez au minimum vous assurer que votre base de donn\u00e9es r\u00e9pond aux exigences de l'a\u00e9roport et qu'elle peut repr\u00e9senter les donn\u00e9es d'\u00e9chantillon fournies.</p>"},{"location":"cours3/atl/instructions/#exigences","title":"Exigences","text":"<p>Pour comprendre les exigences d'ATL pour leur base de donn\u00e9es, vous vous \u00eates assis pour discuter avec l'Assistant General Manager for IT Operations.</p>"},{"location":"cours3/atl/instructions/#passagers","title":"Passagers","text":"<p>En ce qui concerne nos passagers, nous devons juste avoir les informations essentielles : le pr\u00e9nom, le nom de famille et l'\u00e2ge. C'est tout ce que nous devons savoir \u2014 rien de plus.</p>"},{"location":"cours3/atl/instructions/#enregistrements","title":"Enregistrements","text":"<p>Lorsque les passagers arrivent \u00e0 ATL, ils \"s'enregistrent\" souvent pour leurs vols. C'est leur fa\u00e7on de nous dire qu'ils sont l\u00e0 et pr\u00eats \u00e0 embarquer. Nous aimerions garder une trace de ces moments. Et de quoi avons-nous besoin pour cela, demandez-vous ? Eh bien, voici ce dont nous avons besoin :</p> <ul> <li>La date et l'heure exactes auxquelles notre passager s'est enregistr\u00e9</li> <li>Le vol pour lequel ils s'enregistrent, bien s\u00fbr. On ne peut pas perdre de vue o\u00f9 ils se dirigent, n'est-ce pas ?</li> </ul>"},{"location":"cours3/atl/instructions/#compagnies-aeriennes","title":"Compagnies A\u00e9riennes","text":"<p>ATL est un hub pour de nombreuses compagnies a\u00e9riennes nationales et internationales : des noms comme Delta, British Airways, Air France, Korean Air, et Turkish Airlines. La liste est longue. Voici ce que nous suivons :</p> <ul> <li>Le nom de la compagnie a\u00e9rienne</li> <li>La \"jet\u00e9e\" ou, devrais-je dire, la section de notre a\u00e9roport o\u00f9 la compagnie a\u00e9rienne op\u00e8re. Nous avons 7 jet\u00e9es : A, B, C, D, E, F, et T.</li> </ul>"},{"location":"cours3/atl/instructions/#vols","title":"Vols","text":"<p>Nous desservons jusqu'\u00e0 1 000 vols par jour. Pour nous assurer que nos passagers ne se posent jamais de questions, nous devons leur fournir tous les d\u00e9tails critiques sur leur vol. Voici ce que nous aimerions stocker :</p> <ul> <li>Le num\u00e9ro de vol. Par exemple, \"900\". Sachez juste que nous r\u00e9utilisons parfois les num\u00e9ros de vol.</li> <li>La compagnie a\u00e9rienne op\u00e9rant le vol. Vous pouvez garder cela simple et supposer qu'un vol est op\u00e9r\u00e9 par une seule compagnie a\u00e9rienne.</li> <li>Le code de l'a\u00e9roport de d\u00e9part. Par exemple, \"ATL\" ou \"BOS\".</li> <li>Le code de l'a\u00e9roport de destination</li> <li>La date et l'heure de d\u00e9part pr\u00e9vues (\u00e0 la minute pr\u00e8s, bien s\u00fbr !)</li> <li>La date et l'heure d'arriv\u00e9e pr\u00e9vues, avec la m\u00eame pr\u00e9cision</li> </ul>"},{"location":"cours3/atl/instructions/#donnees-dechantillon","title":"Donn\u00e9es d'\u00c9chantillon","text":"<p>Votre base de donn\u00e9es doit pouvoir repr\u00e9senter...</p> <ul> <li>Un passager, Amelia Earhart, \u00e2g\u00e9e de 39 ans</li> <li>Une compagnie a\u00e9rienne, Delta, qui op\u00e8re \u00e0 partir des jet\u00e9es A, B, C, D, et T</li> <li>Un vol, Delta Flight 300, qui est pr\u00e9vu de partir d'ATL le 3 ao\u00fbt 2023 \u00e0 18h46 et d'arriver \u00e0 BOS le 3 ao\u00fbt 2023 \u00e0 21h09</li> <li>Un enregistrement pour Amelia Earhart, pour le vol Delta 300, le 3 ao\u00fbt 2023 \u00e0 15h03</li> </ul>"},{"location":"cours3/atl/instructions/#utilisation","title":"Utilisation","text":"<p>Pour cr\u00e9er une base de donn\u00e9es \u00e0 partir de votre sch\u00e9ma, dans votre dossier <code>atl</code>, tapez</p> <pre><code>sqlite3 atl.db\n</code></pre> <p>Cela cr\u00e9era une base de donn\u00e9es SQLite vide appel\u00e9e <code>atl.db</code>.</p> <p>Ensuite, dans l'invite <code>sqlite3</code>, tapez</p> <pre><code>.read schema.sql\n</code></pre> <p>pour lire les instructions de <code>schema.sql</code>.</p> <p>Rappelez-vous que vous pouvez utiliser <code>DROP TABLE tablename</code>, o\u00f9 <code>tablename</code> est le nom de votre table, pour supprimer une table de votre base de donn\u00e9es.</p>"},{"location":"cours3/connect/instructions/","title":"Happy to connect","text":""},{"location":"cours3/connect/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>LinkedIn est \u00ab le plus grand r\u00e9seau professionnel au monde \u00bb avec pour mission de \u00ab connecter les professionnels du monde entier pour les rendre plus productifs et plus performants \u00bb. Peut-\u00eatre avez-vous un compte ? Sur la plateforme, les utilisateurs peuvent publier leur exp\u00e9rience professionnelle (c'est-\u00e0-dire, les emplois pr\u00e9c\u00e9dents, l'\u00e9ducation, etc.) et \u00e9tablir des connexions avec d'autres personnes qu'ils ont rencontr\u00e9es, en personne ou en ligne.</p> <p>Dans un fichier nomm\u00e9 <code>schema.sql</code> dans un dossier nomm\u00e9 <code>connect</code>, \u00e9crivez un ensemble d'instructions SQL pour concevoir une base de donn\u00e9es que LinkedIn pourrait utiliser.</p>"},{"location":"cours3/connect/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Votre t\u00e2che consiste \u00e0 cr\u00e9er une base de donn\u00e9es SQLite pour LinkedIn \u00e0 partir de z\u00e9ro, en \u00e9crivant un ensemble d'instructions <code>CREATE TABLE</code> dans un fichier <code>schema.sql</code>. Les d\u00e9tails de mise en \u0153uvre d\u00e9pendent de vous, bien que vous devriez au minimum vous assurer que votre base de donn\u00e9es r\u00e9pond aux sp\u00e9cifications de la plateforme et qu'elle peut repr\u00e9senter les donn\u00e9es d'exemple fournies.</p>"},{"location":"cours3/connect/instructions/#plateforme","title":"Plateforme","text":""},{"location":"cours3/connect/instructions/#utilisateurs","title":"Utilisateurs","text":"<p>Le c\u0153ur de la plateforme LinkedIn est ses utilisateurs. Votre base de donn\u00e9es doit pouvoir repr\u00e9senter les informations suivantes sur les utilisateurs de LinkedIn :</p> <ul> <li>Leur pr\u00e9nom et nom de famille</li> <li>Leur nom d'utilisateur</li> <li>Leur mot de passe</li> </ul> <p>Gardez \u00e0 l'esprit que, si une entreprise suit les meilleures pratiques, les mots de passe des applications sont \u00ab hach\u00e9s \u00bb. Pas besoin de vous soucier du hachage des mots de passe ici, cependant.</p>"},{"location":"cours3/connect/instructions/#ecoles-et-universites","title":"\u00c9coles et Universit\u00e9s","text":"<p>LinkedIn permet \u00e9galement des comptes officiels pour les \u00e9coles ou universit\u00e9s, comme celui de Harvard, afin que les anciens \u00e9l\u00e8ves (c'est-\u00e0-dire, ceux qui y ont \u00e9tudi\u00e9) puissent identifier leur affiliation. Assurez-vous que la base de donn\u00e9es de LinkedIn peut stocker les informations suivantes sur chaque \u00e9cole :</p> <ul> <li>Le nom de l'\u00e9cole</li> <li>Le type d'\u00e9cole (par exemple, \u00ab \u00c9cole \u00c9l\u00e9mentaire \u00bb, \u00ab Coll\u00e8ge \u00bb, \u00ab Lyc\u00e9e \u00bb, \u00ab \u00c9cole Primaire \u00bb, \u00ab \u00c9cole Secondaire \u00bb, \u00ab Universit\u00e9 \u00bb, etc.)</li> <li>L'emplacement de l'\u00e9cole</li> <li>L'ann\u00e9e de fondation de l'\u00e9cole</li> </ul>"},{"location":"cours3/connect/instructions/#entreprises","title":"Entreprises","text":"<p>LinkedIn permet aux entreprises de cr\u00e9er leurs propres pages, comme celle de LinkedIn elle-m\u00eame, afin que les employ\u00e9s puissent identifier leur emploi pass\u00e9 ou actuel avec l'entreprise. Assurez-vous que la base de donn\u00e9es de LinkedIn peut stocker les informations suivantes pour chaque entreprise :</p> <ul> <li>Le nom de l'entreprise</li> <li>Le secteur d'activit\u00e9 de l'entreprise (par exemple, \u00ab \u00c9ducation \u00bb, \u00ab Technologie \u00bb, \u00ab Finance \u00bb, etc.)</li> <li>L'emplacement de l'entreprise</li> </ul>"},{"location":"cours3/connect/instructions/#connexions","title":"Connexions","text":"<p>Et enfin, l'essence de LinkedIn est sa capacit\u00e9 \u00e0 faciliter les connexions entre les personnes. Assurez-vous que la base de donn\u00e9es de LinkedIn peut supporter chacune des connexions suivantes.</p> <p>Connexions avec des Personnes</p> <p>La base de donn\u00e9es de LinkedIn doit pouvoir repr\u00e9senter des connexions mutuelles (r\u00e9ciproques, bidirectionnelles) entre les utilisateurs. Pas besoin de vous soucier des connexions unidirectionnelles, comme l'utilisateur A \u00ab suivant \u00bb l'utilisateur B sans que l'utilisateur B \u00ab suive \u00bb l'utilisateur A.</p> <p>Connexions avec des \u00c9coles</p> <p>Un utilisateur doit pouvoir cr\u00e9er une affiliation avec une \u00e9cole donn\u00e9e. Et de m\u00eame, cette \u00e9cole doit pouvoir trouver ses anciens \u00e9l\u00e8ves. De plus, permettez \u00e0 un utilisateur de d\u00e9finir :</p> <ul> <li>La date de d\u00e9but de son affiliation (c'est-\u00e0-dire, quand il a commenc\u00e9 \u00e0 fr\u00e9quenter l'\u00e9cole)</li> <li>La date de fin de son affiliation (c'est-\u00e0-dire, quand il a obtenu son dipl\u00f4me), le cas \u00e9ch\u00e9ant</li> <li>Le type de dipl\u00f4me obtenu/poursuivi (par exemple, \u00ab Licence \u00bb, \u00ab Master \u00bb, \u00ab Doctorat \u00bb, etc.)</li> </ul> <p>Connexions avec des Entreprises</p> <p>Un utilisateur doit pouvoir cr\u00e9er une affiliation avec une entreprise donn\u00e9e. Et de m\u00eame, cette entreprise doit pouvoir trouver ses employ\u00e9s actuels et pass\u00e9s. De plus, permettez \u00e0 un utilisateur de d\u00e9finir :</p> <ul> <li>La date de d\u00e9but de son affiliation (c'est-\u00e0-dire, la date \u00e0 laquelle il a commenc\u00e9 \u00e0 travailler avec l'entreprise)</li> <li>La date de fin de son affiliation (c'est-\u00e0-dire, quand il a quitt\u00e9 l'entreprise), le cas \u00e9ch\u00e9ant</li> <li>Le titre qu'il occupait pendant son affiliation avec l'entreprise</li> </ul>"},{"location":"cours3/connect/instructions/#donnees-dexemple","title":"Donn\u00e9es d'Exemple","text":"<p>Votre base de donn\u00e9es doit pouvoir repr\u00e9senter\u2026</p> <ul> <li>Un utilisateur, Alan Garber, dont le nom d'utilisateur est \u00ab alan \u00bb et le mot de passe est \u00ab password \u00bb.</li> <li>Un utilisateur, Reid Hoffman dont le nom d'utilisateur est \u00ab reid \u00bb et le mot de passe est \u00ab password \u00bb.</li> <li>Une \u00e9cole, Harvard University, qui est une universit\u00e9 situ\u00e9e \u00e0 Cambridge, Massachusetts, fond\u00e9e en 1636.</li> <li>Une entreprise, LinkedIn, qui est une entreprise technologique dont le si\u00e8ge est \u00e0 Sunnyvale, Californie.</li> <li>L'\u00e9ducation de premier cycle d'Alan Garber \u00e0 Harvard, poursuivant une Licence du 1er septembre 1973 au 1er juin 1976.</li> <li>L'emploi de Reid Hoffman chez LinkedIn en tant que PDG et Pr\u00e9sident, du 1er janvier 2003 au 1er f\u00e9vrier 2007.</li> </ul>"},{"location":"cours3/connect/instructions/#utilisation","title":"Utilisation","text":"<p>Pour cr\u00e9er une base de donn\u00e9es \u00e0 partir de votre sch\u00e9ma, dans votre dossier <code>connect</code>, tapez</p> <pre><code>sqlite3 connect.db\n</code></pre> <p>Cela cr\u00e9era une base de donn\u00e9es SQLite vide nomm\u00e9e <code>connect.db</code>.</p> <p>Ensuite, dans l'invite <code>sqlite3</code>, tapez</p> <pre><code>.read schema.sql\n</code></pre> <p>pour lire les instructions de <code>schema.sql</code>.</p> <p>Rappelez-vous que vous pouvez utiliser <code>DROP TABLE tablename</code>, o\u00f9 <code>tablename</code> est le nom de votre table, pour supprimer une table de votre base de donn\u00e9es.</p>"},{"location":"cours3/doghnut/instructions/","title":"Union Square Donuts","text":"<p>Le logo de Union Square Donuts</p>"},{"location":"cours3/doghnut/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Autour de Boston, Brookline et Somerville, vous pourriez apercevoir Union Square Donuts, une boutique c\u00e9l\u00e8bre dans la r\u00e9gion pour ses d\u00e9licieuses confiseries. Supposons que Union Square Donuts existe depuis un certain temps et, bien que leurs re\u00e7us papier aient bien fonctionn\u00e9 jusqu'\u00e0 pr\u00e9sent, ils esp\u00e8rent un syst\u00e8me pour les aider \u00e0 g\u00e9rer plus de clients. En fait, ils viennent de vous engager pour concevoir une base de donn\u00e9es adapt\u00e9e \u00e0 leur boutique. En \u00e9change, des donuts gratuits ? \ud83c\udf69</p> <p>Dans un fichier nomm\u00e9 <code>schema.sql</code> dans un dossier nomm\u00e9 <code>donuts</code>, \u00e9crivez un ensemble d'instructions SQL pour cr\u00e9er une base de donn\u00e9es que Union Square Donuts pourrait utiliser pour g\u00e9rer ses op\u00e9rations quotidiennes.</p>"},{"location":"cours3/doghnut/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Votre t\u00e2che consiste \u00e0 cr\u00e9er une base de donn\u00e9es SQLite pour Union Square Donuts \u00e0 partir de z\u00e9ro, en \u00e9crivant un ensemble d'instructions <code>CREATE TABLE</code> dans un fichier <code>schema.sql</code>. Les d\u00e9tails de mise en \u0153uvre d\u00e9pendent de vous, bien que vous devriez au minimum vous assurer que votre base de donn\u00e9es r\u00e9pond aux attentes de l'\u00e9quipe et qu'elle peut repr\u00e9senter les donn\u00e9es d'exemple.</p>"},{"location":"cours3/doghnut/instructions/#attentes","title":"Attentes","text":"<p>Pour comprendre les attentes de l'\u00e9quipe concernant leur base de donn\u00e9es, vous vous \u00eates assis pour discuter avec eux apr\u00e8s la fermeture de la boutique.</p>"},{"location":"cours3/doghnut/instructions/#ingredients-ingredients","title":"Ingredients (Ingr\u00e9dients)","text":"<p>Nous devons certainement suivre nos ingr\u00e9dients. Certains des ingr\u00e9dients typiques que nous utilisons incluent la farine, la levure, l'huile, le beurre et plusieurs types de sucre diff\u00e9rents. De plus, nous aimerions suivre le prix que nous payons par unit\u00e9 d'ingr\u00e9dient (qu'il s'agisse de livres, de grammes, etc.).</p>"},{"location":"cours3/doghnut/instructions/#donuts-beignets","title":"Donuts (Beignets)","text":"<p>Nous devons inclure notre s\u00e9lection de beignets, pass\u00e9e et pr\u00e9sente ! Pour chaque beignet au menu, nous aimerions inclure trois choses :</p> <ul> <li>Le nom du beignet</li> <li>Si le beignet est sans gluten (gluten-free)</li> <li>Le prix par beignet</li> </ul> <p>Oh, et il est important que nous puissions rechercher les ingr\u00e9dients de chacun des beignets !</p>"},{"location":"cours3/doghnut/instructions/#orders-commandes","title":"Orders (Commandes)","text":"<p>Nous aimons voir les clients en personne, bien que nous r\u00e9alisions qu'un bon nombre de personnes pourraient commander en ligne de nos jours. Nous aimerions pouvoir suivre ces commandes en ligne. Nous pensons que nous devrions stocker :</p> <ul> <li>Un num\u00e9ro de commande, pour suivre chaque commande en interne</li> <li>Tous les beignets de la commande</li> <li>Le client qui a pass\u00e9 la commande. Nous supposons qu'un seul client passe une commande donn\u00e9e.</li> </ul>"},{"location":"cours3/doghnut/instructions/#customers-clients","title":"Customers (Clients)","text":"<p>Oh, et nous r\u00e9alisons qu'il serait agr\u00e9able de suivre certaines informations sur chacun de nos clients. Nous aimerions nous souvenir de l'historique des commandes qu'ils ont pass\u00e9es. Dans ce cas, nous pensons que nous devrions stocker :</p> <ul> <li>Le pr\u00e9nom et le nom de famille d'un client</li> <li>Un historique de leurs commandes</li> </ul>"},{"location":"cours3/doghnut/instructions/#donnees-dexemple","title":"Donn\u00e9es d'Exemple","text":"<p>Votre base de donn\u00e9es doit pouvoir repr\u00e9senter\u2026</p> <ul> <li>Le cacao, pour lequel Union Square Donuts paie 5,00 $ la livre.</li> <li>Le sucre, pour lequel Union Square Donuts paie 2,00 $ la livre.</li> <li>Le beignet \"Belgian Dark Chocolate\" de Union Square Donuts, qui n'est pas sans gluten, co\u00fbte 4,00 $, et comprend les ingr\u00e9dients suivants :<ul> <li>Cacao</li> <li>Farine</li> <li>Babeurre</li> <li>Sucre</li> </ul> </li> <li>Le beignet \"Back-To-School Sprinkles\" de Union Square Donuts, qui n'est pas sans gluten, co\u00fbte 4,00 $, et comprend les ingr\u00e9dients suivants :<ul> <li>Farine</li> <li>Babeurre</li> <li>Sucre</li> <li>Vermicelles</li> </ul> </li> <li>Commande 1 de Luis Singh pour 3 beignets Belgian Dark Chocolate et 2 beignets Back-To-School Sprinkles.</li> </ul>"},{"location":"cours3/doghnut/instructions/#utilisation","title":"Utilisation","text":"<p>Pour cr\u00e9er une base de donn\u00e9es \u00e0 partir de votre sch\u00e9ma, dans votre dossier <code>donuts</code>, tapez</p> <pre><code>sqlite3 donuts.db\n</code></pre> <p>Cela cr\u00e9era une base de donn\u00e9es SQLite vide nomm\u00e9e <code>donuts.db</code>.</p> <p>Ensuite, dans l'invite <code>sqlite3</code>, tapez</p> <pre><code>.read schema.sql\n</code></pre> <p>pour lire les instructions de <code>schema.sql</code>.</p> <p>Rappelez-vous que vous pouvez utiliser <code>DROP TABLE tablename</code>, o\u00f9 <code>tablename</code> est le nom de votre table, pour supprimer une table de votre base de donn\u00e9es.</p>"},{"location":"cours4/","title":"Cours 4","text":"<ul> <li>Introduction</li> <li>Sch\u00e9ma de la base de donn\u00e9es (Database Schema)</li> <li>Insertion de donn\u00e9es (Inserting Data)</li> <li>Autres contraintes (Other Constraints)</li> <li>Insertion de plusieurs lignes (Inserting Multiple Rows)</li> <li>Suppression de donn\u00e9es (Deleting Data)</li> <li>Mise \u00e0 jour de donn\u00e9es (Updating Data)</li> <li>Fin</li> </ul>"},{"location":"cours4/#introduction","title":"Introduction","text":"<ul> <li>Dans le cours pr\u00e9c\u00e9dent, nous avons appris \u00e0 cr\u00e9er notre propre sch\u00e9ma de base de donn\u00e9es. Dans ce cours, nous allons explorer comment ajouter, mettre \u00e0 jour et supprimer des donn\u00e9es dans nos bases de donn\u00e9es.</li> <li>Le Boston MFA (Museum of Fine Arts) est un mus\u00e9e centenaire \u00e0 Boston. Le MFA g\u00e8re une vaste collection d'artefacts et d'\u0153uvres d'art historiques et contemporains. Ils utilisent probablement une base de donn\u00e9es pour stocker des informations sur leur art et leurs artefacts.</li> <li>Lorsqu'un nouvel artefact est ajout\u00e9 \u00e0 leur collection, nous pouvons imaginer qu'ils ins\u00e8rent les donn\u00e9es correspondantes dans leur base de donn\u00e9es. De m\u00eame, il existe des cas d'utilisation o\u00f9 les donn\u00e9es peuvent n\u00e9cessiter d'\u00eatre lues, mises \u00e0 jour ou supprim\u00e9es.</li> <li>Nous allons maintenant nous concentrer sur la cr\u00e9ation (ou l'insertion) de donn\u00e9es dans une base de donn\u00e9es du Boston MFA.</li> </ul>"},{"location":"cours4/#schema-de-la-base-de-donnees-database-schema","title":"Sch\u00e9ma de la base de donn\u00e9es (Database Schema)","text":"<ul> <li>Consid\u00e9rons ce sch\u00e9ma que le MFA pourrait utiliser pour sa collection.</li> </ul> <ul> <li>Chaque ligne de donn\u00e9es contient le titre d'une \u0153uvre d'art ainsi que le <code>num\u00e9ro d'accession</code> (accession number), qui est un identifiant unique utilis\u00e9 en interne par le mus\u00e9e. Il y a \u00e9galement une date indiquant quand l'art a \u00e9t\u00e9 acquis.</li> <li>La table contient un ID qui sert de cl\u00e9 primaire (primary key).</li> <li>Nous pouvons imaginer que l'administrateur de la base de donn\u00e9es du MFA ex\u00e9cute une requ\u00eate SQL pour ins\u00e9rer chacune de ces \u0153uvres d'art dans la table.</li> <li> <p>Pour comprendre comment cela fonctionne, cr\u00e9ons d'abord une base de donn\u00e9es appel\u00e9e <code>mfa.db</code>. Ensuite, lisons le fichier de sch\u00e9ma <code>schema0.sql</code> dans la base de donn\u00e9es. Ce fichier de sch\u00e9ma, d\u00e9j\u00e0 fourni, nous aide \u00e0 cr\u00e9er la table <code>collections</code>.</p> </li> <li> <p><code>sqlite     .read schema0.sql</code></p> </li> <li> <p>Pour confirmer que la table a \u00e9t\u00e9 cr\u00e9\u00e9e, nous pouvons s\u00e9lectionner \u00e0 partir de la table. </p> </li> <li> <p>Cela devrait nous donner un r\u00e9sultat vide, car la table n'a pas encore de donn\u00e9es.</p> </li> </ul> <p><code>sql   SELECT * FROM \"collections\";</code></p> <ul> <li>Ou utiliser la commande suivante:</li> </ul> <p><code>sqlite   .schema</code></p> <p>Insertion de donn\u00e9es (Inserting Data)</p> <ul> <li>L'instruction SQL <code>INSERT INTO</code> est utilis\u00e9e pour ins\u00e9rer une ligne de donn\u00e9es dans une table donn\u00e9e.</li> </ul> <p><code>sql   INSERT INTO \"collections\" (\"id\", \"title\", \"accession_number\", \"acquired\")   VALUES (1, 'Profusion de fleurs', '56.257', '1956-04-12');</code></p> <p>Nous pouvons voir que cette commande n\u00e9cessite la liste des colonnes de la table qui recevront les nouvelles donn\u00e9es et les valeurs \u00e0 ajouter \u00e0 chaque colonne, dans le m\u00eame ordre. - L'ex\u00e9cution de la commande <code>INSERT INTO</code> ne retourne rien, mais nous pouvons ex\u00e9cuter une requ\u00eate pour confirmer que la ligne est maintenant pr\u00e9sente dans <code>collections</code>.</p> <p><code>sql   SELECT * FROM \"collections\";</code></p> <ul> <li>Nous pouvons ajouter plus de lignes \u00e0 la base de donn\u00e9es en ins\u00e9rant plusieurs fois. Cependant, saisir manuellement la valeur de la cl\u00e9 primaire (comme 1, 2, 3, etc.) peut entra\u00eener des erreurs. Heureusement, SQLite peut remplir automatiquement les valeurs de la cl\u00e9 primaire. Pour utiliser cette fonctionnalit\u00e9, nous omettons la colonne ID lors de l'insertion d'une ligne.</li> </ul> <p><code>sql   INSERT INTO \"collections\" (\"title\", \"accession_number\", \"acquired\")   VALUES ('Fermiers travaillant \u00e0 l'aube', '11.6152', '1911-08-03');</code></p> <p>Nous pouvons v\u00e9rifier que cette ligne a \u00e9t\u00e9 ins\u00e9r\u00e9e avec un <code>id</code> de 2 en ex\u00e9cutant</p> <p><code>sql   SELECT * FROM \"collections\";</code></p> <p>Remarquez que SQLite remplit les valeurs de la cl\u00e9 primaire en incr\u00e9mentant la cl\u00e9 primaire pr\u00e9c\u00e9dente, dans ce cas, 1.</p>"},{"location":"cours4/#autres-contraintes-other-constraints","title":"Autres contraintes (Other Constraints)","text":"<ul> <li>L'ouverture du fichier <code>schema.sql</code> affiche le sch\u00e9ma de la base de donn\u00e9es.</li> </ul> <p><code>sql   CREATE TABLE \"collections\" (       \"id\" INTEGER,       \"title\" TEXT NOT NULL,       \"accession_number\" TEXT NOT NULL UNIQUE,       \"acquired\" NUMERIC,       PRIMARY KEY(\"id\")   );</code></p> <ul> <li>Il est sp\u00e9cifi\u00e9 que le num\u00e9ro d'accession est unique. Si nous essayons d'ins\u00e9rer une ligne avec un num\u00e9ro d'accession r\u00e9p\u00e9t\u00e9, nous d\u00e9clencherons une erreur indiquant <code>UNIQUE constraint failed: collections.accession_number (19)</code>.</li> <li>Cette erreur nous informe que la ligne que nous essayons d'ins\u00e9rer viole une contrainte dans le sch\u00e9ma, sp\u00e9cifiquement la contrainte <code>UNIQUE</code> dans ce sc\u00e9nario.</li> <li>De m\u00eame, nous pouvons essayer d'ajouter une ligne avec un titre <code>NULL</code>, violant la contrainte <code>NOT NULL</code>.</li> </ul> <p><code>sql   INSERT INTO \"collections\" (\"title\", \"accession_number\", \"acquired\")   VALUES(NULL, NULL, '1900-01-10');</code></p> <p>En ex\u00e9cutant ceci, nous verrons \u00e0 nouveau une erreur indiquant <code>NOT NULL constraint failed: collections.title (19)</code>. - De cette mani\u00e8re, les contraintes de sch\u00e9ma sont des garde-fous qui nous prot\u00e8gent de l'ajout de lignes qui ne suivent pas le sch\u00e9ma de notre base de donn\u00e9es.</p>"},{"location":"cours4/#insertion-de-plusieurs-lignes-inserting-multiple-rows","title":"Insertion de plusieurs lignes (Inserting Multiple Rows)","text":"<ul> <li>Nous pourrions avoir besoin d'ins\u00e9rer plus d'une ligne \u00e0 la fois lors de l'\u00e9criture dans une base de donn\u00e9es. Une fa\u00e7on de le faire est de s\u00e9parer les lignes par des virgules dans la commande <code>INSERT INTO</code>.</li> </ul> <p>L'insertion de plusieurs lignes de cette mani\u00e8re offre une certaine commodit\u00e9 au programmeur. C'est \u00e9galement une m\u00e9thode plus rapide et plus efficace d'ins\u00e9rer des lignes dans une base de donn\u00e9es.</p> <ul> <li>Ins\u00e9rons maintenant deux nouvelles peintures dans la table <code>collections</code>.</li> </ul> <p><code>sql   INSERT INTO \"collections\" (\"title\", \"accession_number\", \"acquired\")   VALUES   ('Paysage imaginatif', '56.496', NULL),   ('Pivoines et papillon', '06.1899', '1906-01-01');</code></p> <p>Le mus\u00e9e ne conna\u00eet pas toujours exactement quand une peinture a \u00e9t\u00e9 acquise, donc il est possible que la valeur <code>acquired</code> soit <code>NULL</code>, comme c'est le cas pour la premi\u00e8re peinture que nous venons d'ins\u00e9rer.</p> <ul> <li>Pour voir la table mise \u00e0 jour, nous pouvons s\u00e9lectionner toutes les lignes de la table comme toujours.</li> </ul> <p><code>sql   SELECT * FROM \"collections\";</code></p> <ul> <li>Nos donn\u00e9es pourraient \u00e9galement \u00eatre stock\u00e9es dans un format de valeurs s\u00e9par\u00e9es par des virgules, ou CSV. Observons dans l'exemple suivant comment les valeurs de chaque ligne sont s\u00e9par\u00e9es par une virgule.</li> </ul> <p></p> <ul> <li>SQLite permet d'importer directement un fichier CSV dans notre base de donn\u00e9es. Pour ce faire, nous devons repartir de z\u00e9ro en supprimant mfa.db. Dans le terminal, on peut utiliser: </li> </ul> <p><code>sqlite   .quit --pour sortir de sqlite</code></p> <p><code>bash   rm mda.db # pour supprimer un ficher (rm = remove)</code></p> <ul> <li> <p>Nous avons d\u00e9j\u00e0 un fichier CSV appel\u00e9 <code>mfa.csv</code> qui contient les donn\u00e9es dont nous avons besoin. En ouvrant ce fichier, nous pouvons noter que la premi\u00e8re ligne contient les noms des colonnes, qui correspondent exactement aux noms des colonnes de notre table <code>collections</code> selon le sch\u00e9ma.</p> </li> <li> <p>Cr\u00e9ons \u00e0 nouveau la base de donn\u00e9es <code>mfa.db</code> et lisons le fichier de sch\u00e9ma comme nous l'avons fait pr\u00e9c\u00e9demment.</p> </li> </ul> <p><code>sqlite   sqlite3 mfa.db</code></p> <ul> <li>Ensuite, nous pouvons importer le CSV en ex\u00e9cutant une commande SQLite.</li> </ul> <p><code>sqlite   .import --csv mfa.csv collections</code></p> <p>Le premier argument, <code>--csv</code>, indique \u00e0 SQLite que nous importons un fichier CSV. Cela aidera SQLite \u00e0 analyser correctement le fichier. Le deuxi\u00e8me argument indique que la premi\u00e8re ligne du fichier CSV (la ligne d'en-t\u00eate) doit \u00eatre ignor\u00e9e, ou non ins\u00e9r\u00e9e dans la table.</p> <ul> <li> <p>Nous pouvons s\u00e9lectionner toutes les donn\u00e9es de la table <code>collections</code> pour voir que chaque peinture de <code>mfa.csv</code> a \u00e9t\u00e9 import\u00e9e avec succ\u00e8s dans la table.</p> </li> <li> <p>Le fichier CSV que nous venons d'ins\u00e9rer contenait des valeurs de cl\u00e9 primaire (1, 2, 3, etc.) pour chaque ligne de donn\u00e9es. Cependant, il est plus probable que les fichiers CSV avec lesquels nous travaillons ne contiennent pas les valeurs d'ID ou de cl\u00e9 primaire. Comment pouvons-nous faire en sorte que SQLite les ins\u00e8re automatiquement ?</p> </li> <li> <p>Pour essayer cela, ouvrons <code>mfa.csv</code> dans notre espace de code et supprimons la colonne <code>id</code> de la ligne d'en-t\u00eate, ainsi que les valeurs de chaque colonne. Voici \u00e0 quoi devrait ressembler <code>mfa.csv</code> une fois que nous aurons fini de le modifier :</p> </li> </ul> <p><code>title,accession_number,acquired   Profusion de fleurs,56.257,1956-04-12   Fermiers travaillant \u00e0 l'aube,11.6152,1911-08-03   Sortie de printemps,14.76,1914-01-08   Paysage imaginatif,56.496,   Pivoines et papillon,06.1899,1906-01-01</code></p> <ul> <li>Nous allons \u00e9galement supprimer toutes les lignes qui sont d\u00e9j\u00e0 dans la table <code>collections</code>.</li> </ul> <p><code>sql   DELETE FROM \"collections\";</code></p> <ul> <li> <p>Maintenant, nous voulons importer ce fichier CSV dans une table. Cependant, la table <code>collections</code> (selon notre sch\u00e9ma) doit avoir quatre colonnes dans chaque ligne. Ce nouveau fichier CSV ne contient que trois colonnes pour chaque ligne. Par cons\u00e9quent, nous ne pouvons pas proc\u00e9der \u00e0 l'importation de la m\u00eame mani\u00e8re que pr\u00e9c\u00e9demment.</p> </li> <li> <p>Pour importer avec succ\u00e8s le fichier CSV sans valeurs d'ID, nous devons utiliser une table temporaire :</p> </li> </ul> <p><code>sqlite   .import --csv mfa_noid.csv temp</code></p> <p>Remarquez que nous n'utilisons pas l'argument <code>--skip 1</code> avec cette commande. C'est parce que SQLite est capable de reconna\u00eetre la toute premi\u00e8re ligne de donn\u00e9es CSV comme la ligne d'en-t\u00eate, et convertit ces donn\u00e9es en noms de colonnes de la nouvelle table <code>temp</code>.</p> <ul> <li>Nous pouvons voir les donn\u00e9es dans la table <code>temp</code> en l'interrogeant.</li> </ul> <p><code>sql   SELECT * FROM \"temp\";</code></p> <ul> <li>Ensuite, nous allons s\u00e9lectionner les donn\u00e9es (sans cl\u00e9s primaires) de <code>temp</code> et les d\u00e9placer vers <code>collections</code>, ce qui \u00e9tait notre objectif depuis le d\u00e9but ! Nous pouvons utiliser la commande suivante pour y parvenir.</li> </ul> <p><code>sql   INSERT INTO \"collections\" (\"title\", \"accession_number\", \"acquired\")   SELECT \"title\", \"accession_number\", \"acquired\" FROM \"temp\";</code></p> <p>Dans ce processus, SQLite ajoutera automatiquement les valeurs de cl\u00e9 primaire dans la colonne <code>id</code>.</p> <ul> <li>Juste pour nettoyer notre base de donn\u00e9es, nous pouvons \u00e9galement supprimer la table <code>temp</code> une fois que nous avons fini de d\u00e9placer les donn\u00e9es.</li> </ul> <p><code>sql   DROP TABLE \"temp\";</code></p>"},{"location":"cours4/#suppression-de-donnees-deleting-data","title":"Suppression de donn\u00e9es (Deleting Data)","text":"<ul> <li>Nous avons vu pr\u00e9c\u00e9demment que l'ex\u00e9cution de la commande suivante supprimait toutes les lignes de la table <code>collections</code>. (Nous ne voulons pas ex\u00e9cuter cette commande maintenant, sinon nous perdrons toutes les donn\u00e9es de la table !)</li> </ul> <p><code>sql   DELETE FROM \"collections\";</code></p> <ul> <li>Nous pouvons \u00e9galement supprimer des lignes qui correspondent \u00e0 des conditions sp\u00e9cifiques. Par exemple, pour supprimer la peinture \"Sortie de printemps\" de notre table <code>collections</code>, nous pouvons ex\u00e9cuter :</li> </ul> <p><code>sql   DELETE FROM \"collections\"   WHERE \"title\" = 'Sortie de printemps';</code></p> <ul> <li>Pour supprimer toute peinture avec la date d'acquisition <code>NULL</code>, nous pouvons ex\u00e9cuter</li> </ul> <p><code>sql   DELETE FROM \"collections\"   WHERE \"acquired\" IS NULL;</code></p> <ul> <li>Comme toujours, nous nous assurerons que la suppression a fonctionn\u00e9 comme pr\u00e9vu en s\u00e9lectionnant toutes les donn\u00e9es de la table.</li> </ul> <p><code>sql   SELECT * FROM \"collections\";</code></p> <p>Nous voyons que les peintures \"Sortie de printemps\" et \"Paysage imaginatif\" ne sont plus dans la table. - Pour supprimer les lignes concernant des peintures ant\u00e9rieures \u00e0 1909, nous pouvons ex\u00e9cuter</p> <p><code>sql   DELETE FROM \"collections\"   WHERE \"acquired\" &lt; '1909-01-01';</code></p> <p>En utilisant l'op\u00e9rateur <code>&lt;</code> ici, nous trouvons les peintures acquises avant le 1er janvier 1909. Ce sont les peintures qui seront supprim\u00e9es lors de l'ex\u00e9cution de la requ\u00eate. - Il peut y avoir des cas o\u00f9 la suppression de certaines donn\u00e9es pourrait affecter l'int\u00e9grit\u00e9 d'une base de donn\u00e9es. Les contraintes de cl\u00e9 \u00e9trang\u00e8re en sont un bon exemple. Une colonne de cl\u00e9 \u00e9trang\u00e8re fait r\u00e9f\u00e9rence \u00e0 la cl\u00e9 primaire d'une table diff\u00e9rente. Si nous devions supprimer la cl\u00e9 primaire, la colonne de cl\u00e9 \u00e9trang\u00e8re n'aurait plus rien \u00e0 r\u00e9f\u00e9rencer ! - Consid\u00e9rons maintenant un sch\u00e9ma mis \u00e0 jour pour la base de donn\u00e9es du MFA, contenant des informations non seulement sur les \u0153uvres d'art mais aussi sur les artistes. Les deux entit\u00e9s Artiste et Collection ont une relation plusieurs-\u00e0-plusieurs : une peinture peut \u00eatre cr\u00e9\u00e9e par plusieurs artistes et un seul artiste peut \u00e9galement cr\u00e9er plusieurs \u0153uvres d'art.</p> <p>[\"Sch\u00e9ma mis \u00e0 jour avec les entit\u00e9s artiste et collection\"]</p> <ul> <li>Voici une base de donn\u00e9es mettant en \u0153uvre le diagramme ER ci-dessus.</li> </ul> <p>[\"Trois tables : artistes, cr\u00e9\u00e9s, collections\"]</p> <p>Les tables <code>artistes</code> et <code>collections</code> ont des cl\u00e9s primaires : les colonnes ID. La table <code>created</code> fait r\u00e9f\u00e9rence \u00e0 ces ID dans ses deux colonnes de cl\u00e9 \u00e9trang\u00e8re. - \u00c9tant donn\u00e9 cette base de donn\u00e9es, si nous choisissons de supprimer l'artiste non identifi\u00e9 (avec l'ID 3), que se passera-t-il avec les lignes de la table <code>created</code> avec un <code>artist_id</code> de 3 ? Essayons-le. - Apr\u00e8s avoir ouvert <code>mfa.db</code>, nous pouvons maintenant voir le sch\u00e9ma mis \u00e0 jour en ex\u00e9cutant la commande <code>.schema</code>. La table <code>created</code> a effectivement deux contraintes de cl\u00e9 \u00e9trang\u00e8re, une pour l'ID de l'artiste et une pour l'ID de la collection. - Maintenant, nous pouvons essayer de supprimer de la table <code>artistes</code>.</p> <p><code>sql   DELETE FROM \"artists\"   WHERE \"name\" = 'Artiste non identifi\u00e9';</code></p> <p>En ex\u00e9cutant ceci, nous obtenons une erreur tr\u00e8s similaire \u00e0 celles que nous avons d\u00e9j\u00e0 vues dans ce cours : <code>Runtime error: FOREIGN KEY constraint failed (19)</code>. Cette erreur nous informe que la suppression de ces donn\u00e9es violerait la contrainte de cl\u00e9 \u00e9trang\u00e8re d\u00e9finie dans la table <code>created</code>. - Comment nous assurer que la contrainte n'est pas viol\u00e9e ? Une possibilit\u00e9 est de supprimer les lignes correspondantes de la table <code>created</code> avant de supprimer de la table <code>artistes</code>.</p> <p><code>sql   DELETE FROM \"created\"   WHERE \"artist_id\" = (       SELECT \"id\"       FROM \"artists\"       WHERE \"name\" = 'Artiste non identifi\u00e9'   );</code></p> <p>Cette requ\u00eate supprime efficacement l'affiliation de l'artiste avec son \u0153uvre. Une fois l'affiliation supprim\u00e9e, nous pouvons supprimer les donn\u00e9es de l'artiste sans violer la contrainte de cl\u00e9 \u00e9trang\u00e8re. Pour ce faire, nous pouvons ex\u00e9cuter</p> <p><code>sql   DELETE FROM \"artists\"   WHERE \"name\" = 'Artiste non identifi\u00e9';</code></p> <ul> <li>Dans une autre possibilit\u00e9, nous pouvons sp\u00e9cifier l'action \u00e0 entreprendre lorsqu'un ID r\u00e9f\u00e9renc\u00e9 par une cl\u00e9 \u00e9trang\u00e8re est supprim\u00e9. Pour ce faire, nous utilisons le mot-cl\u00e9 <code>ON DELETE</code> suivi de l'action \u00e0 entreprendre.</li> <li><code>ON DELETE RESTRICT</code> : Cela nous emp\u00eache de supprimer des ID lorsque la contrainte de cl\u00e9 \u00e9trang\u00e8re est viol\u00e9e.</li> <li><code>ON DELETE NO ACTION</code> : Cela permet la suppression d'ID r\u00e9f\u00e9renc\u00e9s par une cl\u00e9 \u00e9trang\u00e8re et rien ne se passe.</li> <li><code>ON DELETE SET NULL</code> : Cela permet la suppression d'ID r\u00e9f\u00e9renc\u00e9s par une cl\u00e9 \u00e9trang\u00e8re et d\u00e9finit les r\u00e9f\u00e9rences de cl\u00e9 \u00e9trang\u00e8re sur <code>NULL</code>.</li> <li><code>ON DELETE SET DEFAULT</code> : Cela fait la m\u00eame chose que le pr\u00e9c\u00e9dent, mais nous permet de d\u00e9finir une valeur par d\u00e9faut au lieu de <code>NULL</code>.</li> <li><code>ON DELETE CASCADE</code> : Cela permet la suppression d'ID r\u00e9f\u00e9renc\u00e9s par une cl\u00e9 \u00e9trang\u00e8re et supprime \u00e9galement en cascade les lignes de cl\u00e9 \u00e9trang\u00e8re r\u00e9f\u00e9rentes. Par exemple, si nous utilisions ceci pour supprimer un ID d'artiste, toutes les affiliations de l'artiste avec les \u0153uvres d'art seraient \u00e9galement supprim\u00e9es de la table <code>created</code>.</li> <li>La derni\u00e8re version du fichier de sch\u00e9ma met en \u0153uvre la m\u00e9thode ci-dessus. Les contraintes de cl\u00e9 \u00e9trang\u00e8re ressemblent maintenant \u00e0 ceci :</li> </ul> <p><code>sql   FOREIGN KEY(\"artist_id\") REFERENCES \"artists\"(\"id\") ON DELETE CASCADE   FOREIGN KEY(\"collection_id\") REFERENCES \"collections\"(\"id\") ON DELETE CASCADE</code></p> <p>Maintenant, l'ex\u00e9cution de l'instruction <code>DELETE</code> suivante ne r\u00e9sultera pas en une erreur, et supprimera en cascade de la table <code>artistes</code> \u00e0 la table <code>created</code> :</p> <p><code>sql   DELETE FROM \"artists\"   WHERE \"name\" = 'Artiste non identifi\u00e9';</code></p> <p>Pour v\u00e9rifier que cette suppression en cascade a fonctionn\u00e9, nous pouvons interroger la table <code>created</code> :</p> <p><code>sql   SELECT * FROM \"created\";</code></p> <p>Nous observons qu'aucune des lignes n'a un ID de 3 (l'ID de l'artiste supprim\u00e9 de la table <code>artistes</code>).</p>"},{"location":"cours4/#mise-a-jour-de-donnees-updating-data","title":"Mise \u00e0 jour de donn\u00e9es (Updating Data)","text":"<ul> <li>Nous pouvons facilement imaginer des sc\u00e9narios dans lesquels des donn\u00e9es dans une base de donn\u00e9es devraient \u00eatre mises \u00e0 jour. Peut-\u00eatre, dans le cas de la base de donn\u00e9es du MFA, nous d\u00e9couvrons que la peinture \"Fermiers travaillant \u00e0 l'aube\" initialement attribu\u00e9e \u00e0 un \"Artiste non identifi\u00e9\" a en fait \u00e9t\u00e9 cr\u00e9\u00e9e par l'artiste Li Yin.</li> <li>Nous pouvons utiliser la commande de mise \u00e0 jour pour apporter des modifications, par exemple, \u00e0 l'affiliation d'une peinture. Voici la syntaxe de la commande de mise \u00e0 jour.</li> </ul> <p>[\"Syntaxe de la commande de mise \u00e0 jour\"]</p> <ul> <li>Changeons cette affiliation pour \"Fermiers travaillant \u00e0 l'aube\" dans la table <code>created</code> en utilisant la syntaxe ci-dessus.</li> </ul> <p><code>sql   UPDATE \"created\"   SET \"artist_id\" = (       SELECT \"id\"       FROM \"artists\"       WHERE \"name\" = 'Li Yin'   )   WHERE \"collection_id\" = (       SELECT \"id\"       FROM \"collections\"       WHERE \"title\" = 'Fermiers travaillant \u00e0 l'aube'   );</code></p> <p>La premi\u00e8re partie de cette requ\u00eate sp\u00e9cifie la table \u00e0 mettre \u00e0 jour. La partie suivante r\u00e9cup\u00e8re l'ID de Li Yin \u00e0 d\u00e9finir comme nouvel ID. La derni\u00e8re partie s\u00e9lectionne la ou les lignes dans <code>created</code> qui seront mises \u00e0 jour avec l'ID de Li Yin, qui est la peinture \"Fermiers travaillant \u00e0 l'aube\" !</p>"},{"location":"cours4/#fin","title":"Fin","text":"<ul> <li>Cela conclut le Cours 3 sur l'\u00e9criture en SQL !</li> </ul> <p>Si vous avez besoin de plus d'informations ou d'aide suppl\u00e9mentaire, n'h\u00e9sitez pas \u00e0 demander !</p>"},{"location":"cours4/dont-panic/instructions/","title":"Don't Panic // Ne Paniquez Pas ! (Version originale)","text":"<p> \"Un seul ordinateur de bureau pos\u00e9 sur un bureau dans un bureau vide la nuit, dans le style d'un roman noir\", g\u00e9n\u00e9r\u00e9 par DALL\u00b7E 2</p>"},{"location":"cours4/dont-panic/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>Vous \u00eates un \"pentester\" (testeur d'intrusion) entra\u00een\u00e9. Les entreprises vous engagent souvent pour effectuer des tests de p\u00e9n\u00e9tration et signaler les vuln\u00e9rabilit\u00e9s dans leurs syst\u00e8mes de donn\u00e9es. Il n'y a pas si longtemps, vous avez \u00e9t\u00e9 engag\u00e9 par une petite entreprise qui avait besoin de vous pour effectuer un tel test sur une base de donn\u00e9es SQLite : celle qui alimente leur site web \u00e0 faible trafic.</p> <p>Pour r\u00e9ussir cette op\u00e9ration secr\u00e8te, vous devrez :</p> <ul> <li>Modifier le mot de passe du compte administratif du site web.</li> <li>Effacer tous les journaux (logs) de ce changement de mot de passe enregistr\u00e9s par la base de donn\u00e9es.</li> <li>Ajouter de fausses donn\u00e9es pour d\u00e9tourner l'attention de l'entreprise.</li> </ul> <p>Et maintenant, une opportunit\u00e9 en or se pr\u00e9sente : vous vous \u00eates faufil\u00e9 dans les locaux de l'entreprise, juste \u00e0 temps pour voir un ing\u00e9nieur logiciel quitter son bureau. La connexion de l'ing\u00e9nieur \u00e0 la base de donn\u00e9es est toujours ouverte. Vous estimez avoir 5 minutes avant qu'il ne revienne. Pr\u00eat ?</p>"},{"location":"cours4/dont-panic/instructions/#demo","title":"Demo","text":"<p>Vous avez une base de donn\u00e9es nomm\u00e9e <code>dont-panic.db</code> \u00e0 c\u00f4t\u00e9 d'un fichier <code>hack.sql</code> et <code>reset.sql</code>. L'ex\u00e9cution de <code>sqlite3 dont-panic.db</code> devrait ouvrir la base de donn\u00e9es.</p>"},{"location":"cours4/dont-panic/instructions/#schema","title":"Sch\u00e9ma","text":"<p>D\u00e9sol\u00e9, il n'y a pas beaucoup de temps pour expliquer le sch\u00e9ma de la base de donn\u00e9es. N'oubliez pas que vous pouvez acc\u00e9der au sch\u00e9ma d'une base de donn\u00e9es SQLite avec <code>.schema</code>.</p>"},{"location":"cours4/dont-panic/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Dans <code>hack.sql</code>, \u00e9crivez une s\u00e9quence d'instructions SQL pour r\u00e9aliser ce qui suit :</p> <ul> <li>Modifier le mot de passe du compte administratif du site web, <code>admin</code>, pour qu'il soit \"oops!\".</li> <li>Effacer tous les journaux (logs) du changement de mot de passe ci-dessus enregistr\u00e9s par la base de donn\u00e9es.</li> <li>Ajouter de fausses donn\u00e9es pour d\u00e9tourner l'attention des autres. En particulier, pour pi\u00e9ger <code>emily33</code>, faites en sorte qu'il semble seulement - dans la table <code>user_logs</code> - que le mot de passe du compte <code>admin</code> a \u00e9t\u00e9 chang\u00e9 pour celui de <code>emily33</code>.</li> </ul> <p>Lorsque vos instructions SQL dans <code>hack.sql</code> sont ex\u00e9cut\u00e9es sur une nouvelle instance de la base de donn\u00e9es, elles doivent produire les r\u00e9sultats ci-dessus. Sachez simplement que l'ordre dans lequel ces objectifs sont pr\u00e9sent\u00e9s n'est peut-\u00eatre pas l'ordre dans lequel ils sont le mieux accomplis !</p> <p>Gardez \u00e9galement \u00e0 l'esprit que les mots de passe ne sont g\u00e9n\u00e9ralement pas stock\u00e9s \"en clair\" - c'est-\u00e0-dire sous forme de caract\u00e8res simples qui composent le mot de passe. Au lieu de cela, ils sont \"hach\u00e9s\" (hash\u00e9s), ou brouill\u00e9s, pour pr\u00e9server la confidentialit\u00e9. \u00c9tant donn\u00e9 cette r\u00e9alit\u00e9, vous devrez vous assurer que le mot de passe auquel vous changez le mot de passe administratif est \u00e9galement hach\u00e9. Heureusement, vous savez que les mots de passe de la table <code>users</code> sont d\u00e9j\u00e0 stock\u00e9s sous forme de hachages MD5. Vous pouvez g\u00e9n\u00e9rer rapidement de tels hachages \u00e0 partir de texte brut sur md5hashgenerator.com.</p> <p>L'horloge tourne !</p>"},{"location":"cours4/dont-panic/instructions/#indices","title":"Indices","text":"<ul> <li>Rappelez-vous que vous pouvez <code>INSERT</code> (ins\u00e9rer) dans une table les lignes retourn\u00e9es par une instruction <code>SELECT</code>, tant que le nombre de colonnes correspond.</li> <li>Vous pouvez cr\u00e9er une sous-requ\u00eate \u00e0 tout moment dans une instruction SQL, pas seulement dans le cadre d'une clause <code>WHERE</code>. Par exemple, consid\u00e9rez la requ\u00eate SQL suivante sur une table <code>user_logs</code> simplifi\u00e9e :</li> </ul> <pre><code>INSERT INTO \"user_logs\" (\"type\", \"password\")\nSELECT 'update', (\n    SELECT \"password\"\n    FROM \"users\"\n    WHERE \"username\" = 'carter'\n);\n</code></pre> <p>La requ\u00eate ci-dessus ins\u00e9rera une nouvelle ligne dans la table <code>user_logs</code>. La colonne <code>type</code> aura la valeur \"update\" et la colonne <code>password</code> aura le mot de passe actuel de l'utilisateur <code>carter</code>.</p>"},{"location":"cours4/dont-panic/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester votre piratage au fur et \u00e0 mesure que vous l'\u00e9crivez dans vos fichiers <code>hack.sql</code>, vous pouvez interroger la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read hack.sql\n</code></pre> <p>Si vous devez r\u00e9initialiser la base de donn\u00e9es \u00e0 tout moment, vous pouvez ex\u00e9cuter</p> <pre><code>.read reset.sql\n</code></pre> <p>pour la ramener \u00e0 sa forme originale.</p>"},{"location":"cours4/meteorites/instructions/","title":"Nettoyage de M\u00e9t\u00e9orites (Version originale)","text":"<p> \"Astronautes de la NASA nettoyant une grosse m\u00e9t\u00e9orite, dans le style d'une bande dessin\u00e9e de science-fiction\", g\u00e9n\u00e9r\u00e9 par DALL\u00b7E 2</p>"},{"location":"cours4/meteorites/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 R\u00e9soudre","text":"<p>En tant qu'ing\u00e9nieur de donn\u00e9es \u00e0 la NASA, vous passez souvent votre temps \u00e0 nettoyer des m\u00e9t\u00e9orites - ou du moins les donn\u00e9es qu'elles g\u00e9n\u00e8rent.</p> <p>On vous a fourni un fichier CSV des atterrissages historiques de m\u00e9t\u00e9orites ici sur Terre, et il y en a pas mal ! Votre travail consiste \u00e0 importer les donn\u00e9es dans une base de donn\u00e9es SQLite, en les nettoyant au passage. Une fois termin\u00e9, la base de donn\u00e9es sera utilis\u00e9e dans des analyses par certains de vos coll\u00e8gues ing\u00e9nieurs.</p>"},{"location":"cours4/meteorites/instructions/#distribution-code","title":"Distribution Code","text":"<p>et voir un fichier CSV nomm\u00e9 <code>meteorites.csv</code> \u00e0 c\u00f4t\u00e9 d'un fichier <code>import.sql</code>. Si ce n'est pas le cas, revenez sur vos pas et voyez si vous pouvez d\u00e9terminer o\u00f9 vous vous \u00eates tromp\u00e9 !</p>"},{"location":"cours4/meteorites/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Dans <code>import.sql</code>, \u00e9crivez une s\u00e9rie d'instructions SQL (et SQLite) pour importer et nettoyer les donn\u00e9es de <code>meteorites.csv</code> dans une table, <code>meteorites</code>, dans une base de donn\u00e9es appel\u00e9e <code>meteorites.db</code>.</p> <p>Dans <code>meteorites.db</code>, la table <code>meteorites</code> doit avoir les colonnes suivantes :</p> <p>Colonnes dans la table <code>meteorites</code> - <code>id</code>, qui repr\u00e9sente l'ID unique de la m\u00e9t\u00e9orite. - <code>name</code>, qui repr\u00e9sente le nom donn\u00e9 \u00e0 la m\u00e9t\u00e9orite. - <code>class</code>, qui est la classification de la m\u00e9t\u00e9orite, selon le sch\u00e9ma de classification traditionnel. - <code>mass</code>, qui est le poids de la m\u00e9t\u00e9orite, en grammes. - <code>discovery</code>, qui est soit \"Fell\" (chute) soit \"Found\" (trouv\u00e9e). \"Fell\" indique que la m\u00e9t\u00e9orite a \u00e9t\u00e9 vue tombant sur Terre, tandis que \"Found\" indique que la m\u00e9t\u00e9orite n'a \u00e9t\u00e9 trouv\u00e9e qu'apr\u00e8s avoir atterri sur Terre. - <code>year</code>, qui est l'ann\u00e9e de d\u00e9couverte de la m\u00e9t\u00e9orite. - <code>lat</code>, qui est la latitude \u00e0 laquelle la m\u00e9t\u00e9orite a atterri. - <code>long</code>, qui est la longitude \u00e0 laquelle la m\u00e9t\u00e9orite a atterri.</p> <p>Gardez \u00e0 l'esprit que toutes les colonnes du CSV ne doivent pas se retrouver dans la table finale !</p> <p>Pour consid\u00e9rer les donn\u00e9es de la table <code>meteorites</code> comme propres, vous devez vous assurer que...</p> <ol> <li>Toutes les valeurs vides dans <code>meteorites.csv</code> sont repr\u00e9sent\u00e9es par <code>NULL</code> dans la table <code>meteorites</code>.<ul> <li>Gardez \u00e0 l'esprit que les colonnes <code>mass</code>, <code>year</code>, <code>lat</code>, et <code>long</code> ont des valeurs vides dans le CSV.</li> </ul> </li> <li>Toutes les colonnes avec des valeurs d\u00e9cimales (par exemple, 70.4777) doivent \u00eatre arrondies au centi\u00e8me le plus proche (par exemple, 70.4777 devient 70.48).<ul> <li>Gardez \u00e0 l'esprit que les colonnes <code>mass</code>, <code>lat</code>, et <code>long</code> ont des valeurs d\u00e9cimales.</li> </ul> </li> <li>Toutes les m\u00e9t\u00e9orites avec le <code>nametype</code> \"Relict\" ne sont pas incluses dans la table <code>meteorites</code>.</li> <li>Les m\u00e9t\u00e9orites sont tri\u00e9es par <code>year</code>, de la plus ancienne \u00e0 la plus r\u00e9cente, et ensuite - si deux m\u00e9t\u00e9orites ont atterri la m\u00eame ann\u00e9e - par <code>name</code>, dans l'ordre alphab\u00e9tique.</li> <li>Vous avez mis \u00e0 jour les IDs des m\u00e9t\u00e9orites de <code>meteorites.csv</code>, selon l'ordre sp\u00e9cifi\u00e9 en #4.<ul> <li>L'<code>id</code> des m\u00e9t\u00e9orites doit commencer \u00e0 1, en commen\u00e7ant par la m\u00e9t\u00e9orite qui a atterri l'ann\u00e9e la plus ancienne et qui est la premi\u00e8re dans l'ordre alphab\u00e9tique pour cette ann\u00e9e-l\u00e0.</li> </ul> </li> </ol>"},{"location":"cours4/meteorites/instructions/#conseils","title":"Conseils","text":"<p>Il peut sembler accablant de savoir par o\u00f9 commencer pour nettoyer un fichier de donn\u00e9es aussi volumineux ! D\u00e9composons le probl\u00e8me en morceaux plus petits.</p> <p>Commencez par importer <code>meteorites.csv</code> dans une table temporaire</p> <p>Commencez par importer toutes les donn\u00e9es de <code>meteorites.csv</code> dans une table temporaire, appel\u00e9e <code>meteorites_temp</code>. Une table temporaire est un espace r\u00e9serv\u00e9 utile : vous pouvez l'utiliser pour nettoyer vos donn\u00e9es jusqu'\u00e0 ce qu'elles soient sous une forme adapt\u00e9e \u00e0 votre table <code>meteorites</code> finale.</p> <p>Avant d'importer un CSV dans une base de donn\u00e9es SQLite, il est pr\u00e9f\u00e9rable de d\u00e9finir le sch\u00e9ma de la table dans laquelle ces donn\u00e9es seront import\u00e9es. Dans <code>import.sql</code>, essayez ce qui suit :</p> <pre><code>CREATE TABLE \"meteorites_temp\" (\n    -- TODO\n);\n</code></pre> <p>Nous vous laissons le soin de choisir les noms des colonnes.</p> <p>Ensuite, rappelez-vous que <code>.import</code> est une instruction SQLite qui peut importer un CSV dans une table de votre choix. Apr\u00e8s votre instruction <code>CREATE TABLE</code>, \u00e9crivez une instruction <code>.import</code> pour importer les donn\u00e9es de <code>meteorites.csv</code> dans la table <code>meteorites_temp</code>.</p> <p>Enfin, conform\u00e9ment \u00e0 la section Utilisation ci-dessous, essayez de cr\u00e9er <code>meteorites.db</code> en ex\u00e9cutant les instructions dans <code>import.sql</code>.</p> <p>\u00c9crivez des instructions SQL pour nettoyer les donn\u00e9es import\u00e9es</p> <p>Avec vos donn\u00e9es dans une table temporaire, continuez \u00e0 \u00e9crire des instructions SQL pour nettoyer les donn\u00e9es. Consid\u00e9rez comment vous pourriez mettre \u00e0 jour les valeurs de la colonne <code>mass</code>, par exemple :</p> <pre><code>UPDATE \"meteorites_temp\"\nSET \"mass\" = ...\nWHERE ...\n</code></pre> <p>Vous devrez peut-\u00eatre \u00e9crire quelques instructions de ce type, une (ou plus) pour chaque colonne que vous essayez de nettoyer.</p> <p>Transf\u00e9rez les donn\u00e9es de votre table temporaire dans une table <code>meteorites</code></p> <p>Rappelez-vous que vous pouvez <code>INSERT</code> des valeurs dans une nouvelle table en <code>SELECT</code>ionnant des lignes d'une autre :</p> <pre><code>INSERT INTO \"table0\" (\"column0\", \"column1\")\nSELECT \"column0\", \"column1\" FROM \"table1\";\n</code></pre> <p>Lorsque vous le faites, vous pouvez r\u00e9organiser vos donn\u00e9es en utilisant <code>ORDER BY</code>. Et, tant que vous avez sp\u00e9cifi\u00e9 une colonne de cl\u00e9 primaire dans votre nouvelle table, une telle instruction attribuera automatiquement de nouveaux IDs aux lignes ins\u00e9r\u00e9es si aucun n'est sp\u00e9cifi\u00e9.</p> <p>Une fois que vous avez termin\u00e9 avec la table temporaire, il est bon de la supprimer !</p>"},{"location":"cours4/meteorites/instructions/#utilisation","title":"Utilisation","text":"<p>Introduisons quelques commandes de terminal qui pourraient \u00eatre utiles pendant que vous travaillez sur le nettoyage de cet ensemble de donn\u00e9es ! Consid\u00e9rez ce qui suit :</p> <pre><code>cat import.sql | sqlite3 meteorites.db\n</code></pre> <p>La commande ci-dessus peut \u00eatre d\u00e9compos\u00e9e en deux parties :</p> <ul> <li><code>cat import.sql</code> affiche les donn\u00e9es dans <code>import.sql</code>. Essayez-le seul si vous \u00eates curieux.</li> <li><code>sqlite3 meteorites.db</code> ouvre un fichier appel\u00e9 <code>meteorites.db</code> avec le moteur <code>sqlite3</code>, comme vous en avez d\u00e9j\u00e0 l'habitude.</li> </ul> <p>Lorsque ces commandes sont combin\u00e9es avec un pipe, <code>|</code>, les donn\u00e9es de <code>import.sql</code> sont trait\u00e9es comme un ensemble d'instructions pour <code>sqlite3</code> \u00e0 ex\u00e9cuter sur <code>meteorites.db</code>. Si <code>meteorites.db</code> n'existe pas encore, il sera cr\u00e9\u00e9 et les instructions dans <code>import.sql</code> seront ex\u00e9cut\u00e9es dessus.</p> <p>Et si votre <code>import.sql</code> n'est pas parfait et que vous souhaitez recr\u00e9er la base de donn\u00e9es ? Consid\u00e9rez la suppression de la version actuelle de <code>meteorites.db</code> avec :</p> <pre><code>rm meteorites.db\n</code></pre> <p><code>rm</code> signifie remove (supprimer). Si vous y \u00eates invit\u00e9, tapez \"y\" suivi de Entr\u00e9e pour confirmer la suppression de <code>meteorites.db</code>. \u00c0 partir de l\u00e0, vous pouvez r\u00e9ex\u00e9cuter <code>cat import.sql | sqlite3 meteorites.db</code> pour cr\u00e9er <code>meteorites.db</code> \u00e0 partir de z\u00e9ro.</p>"},{"location":"cours5/","title":"Cours 5 (Version originale)","text":"<ul> <li>Introduction</li> <li>Vues (Views)</li> <li>Simplification</li> <li>Agr\u00e9gation</li> <li>Expression Commune de Table (CTE)</li> <li>Partitionnement</li> <li>S\u00e9curisation</li> <li>Suppressions Logiques (Soft Deletions)</li> </ul>"},{"location":"cours5/#introduction","title":"Introduction","text":"<ul> <li>Jusqu'\u00e0 pr\u00e9sent, nous avons appris des concepts qui nous permettent de concevoir des bases de donn\u00e9es complexes et d'y \u00e9crire des donn\u00e9es. Maintenant, nous allons explorer des moyens d'obtenir des vues \u00e0 partir de ces bases de donn\u00e9es.</li> <li>Revenons \u00e0 la base de donn\u00e9es contenant des livres pr\u00e9s\u00e9lectionn\u00e9s pour le International Booker Prize. Voici un aper\u00e7u des tables de cette base de donn\u00e9es.</li> </ul> <p> - Pour trouver un livre \u00e9crit par l'auteur Han Kang, nous devrions parcourir chacune des trois tables ci-dessus \u2014 d'abord en trouvant l'ID de l'auteur, puis les IDs des livres correspondants et enfin les titres des livres. Au lieu de cela, existe-t-il un moyen de regrouper les informations connexes des trois tables dans une seule vue ? - Oui, nous pouvons utiliser la commande <code>JOIN</code> en SQL pour combiner des lignes de deux tables ou plus en fonction d'une colonne li\u00e9e entre elles. Voici une repr\u00e9sentation visuelle de la mani\u00e8re dont ces tables pourraient \u00eatre jointes afin d'aligner les auteurs et leurs livres.</p> <p></p> <p>Cela permet de voir facilement que Han Kang a \u00e9crit \"The White Book\". - On peut aussi imaginer supprimer les colonnes d'ID ici, de sorte que notre vue ressemble \u00e0 ce qui suit.</p> <p></p>"},{"location":"cours5/#vues-views","title":"Vues (Views)","text":"<ul> <li>Une vue est une table virtuelle d\u00e9finie par une requ\u00eate.</li> <li>Supposons que nous \u00e9crivions une requ\u00eate pour joindre trois tables, comme dans l'exemple pr\u00e9c\u00e9dent, puis s\u00e9lectionnons les colonnes pertinentes. La nouvelle table cr\u00e9\u00e9e par cette requ\u00eate peut \u00eatre enregistr\u00e9e en tant que vue, \u00e0 interroger ult\u00e9rieurement.</li> <li>Les vues sont utiles pour :<ul> <li>simplifier : regrouper des donn\u00e9es de diff\u00e9rentes tables pour les interroger plus simplement,</li> <li>agr\u00e9ger : ex\u00e9cuter des fonctions d'agr\u00e9gation, comme trouver la somme, et stocker les r\u00e9sultats,</li> <li>partitionner : diviser les donn\u00e9es en morceaux logiques,</li> <li>s\u00e9curiser : masquer les colonnes qui doivent rester s\u00e9curis\u00e9es. Bien qu'il existe d'autres fa\u00e7ons dont les vues peuvent \u00eatre utiles, dans cette conf\u00e9rence, nous nous concentrerons sur les quatre points ci-dessus.</li> </ul> </li> </ul>"},{"location":"cours5/#simplification","title":"Simplification","text":"<ul> <li>Ouvrons <code>longlist.db</code> sur SQLite et ex\u00e9cutons la commande <code>.schema</code> pour v\u00e9rifier que les trois tables que nous avons vues dans l'exemple pr\u00e9c\u00e9dent sont cr\u00e9\u00e9es : <code>authors</code>, <code>authored</code> et <code>books</code>.</li> <li>Pour s\u00e9lectionner les livres \u00e9crits par Fernanda Melchor, nous \u00e9cririons cette requ\u00eate imbriqu\u00e9e.</li> </ul> <pre><code>SELECT \"title\" FROM \"books\"\nWHERE \"id\" IN (\n    SELECT \"book_id\" FROM \"authored\"\n    WHERE \"author_id\" = (\n        SELECT \"id\" FROM \"authors\"\n        WHERE \"name\" = 'Fernanda Melchor'\n    )\n);\n</code></pre> <ul> <li>La requ\u00eate ci-dessus est complexe \u2014 il y a trois requ\u00eates <code>SELECT</code> dans la requ\u00eate imbriqu\u00e9e. Pour simplifier cela, utilisons d'abord <code>JOIN</code> pour cr\u00e9er une vue contenant les auteurs et leurs livres.</li> <li>Dans un nouveau terminal, connectons-nous \u00e0 nouveau \u00e0 <code>longlist.db</code>, et ex\u00e9cutons la requ\u00eate suivante.</li> </ul> <pre><code>SELECT \"name\", \"title\" FROM \"authors\"\nJOIN \"authored\" ON \"authors\".\"id\" = \"authored\".\"author_id\"\nJOIN \"books\" ON \"books\".\"id\" = \"authored\".\"book_id\";\n</code></pre> <pre><code>- Notez qu'il est important de sp\u00e9cifier comment deux tables sont jointes, ou les colonnes sur lesquelles elles sont jointes.\n- Astuce : La colonne de cl\u00e9 primaire d'une table est g\u00e9n\u00e9ralement jointe \u00e0 la colonne de cl\u00e9 \u00e9trang\u00e8re correspondante de l'autre table !\n- L'ex\u00e9cution de cette requ\u00eate affichera une table contenant tous les noms d'auteurs \u00e0 c\u00f4t\u00e9 des titres des livres qu'ils ont \u00e9crits.\n</code></pre> <ul> <li>Pour enregistrer la table virtuelle cr\u00e9\u00e9e \u00e0 l'\u00e9tape pr\u00e9c\u00e9dente en tant que vue, nous devons modifier la requ\u00eate.</li> </ul> <pre><code>CREATE VIEW \"longlist\" AS\nSELECT \"name\", \"title\" FROM \"authors\"\nJOIN \"authored\" ON \"authors\".\"id\" = \"authored\".\"author_id\"\nJOIN \"books\" ON \"books\".\"id\" = \"authored\".\"book_id\";\n</code></pre> <p>La vue cr\u00e9\u00e9e ici s'appelle <code>longlist</code>. Cette vue peut maintenant \u00eatre utilis\u00e9e exactement comme nous utiliserions une table en SQL. - \u00c9crivons une requ\u00eate pour voir toutes les donn\u00e9es dans cette vue.</p> <pre><code>SELECT * FROM \"longlist\";\n</code></pre> <ul> <li>En utilisant cette vue, nous pouvons consid\u00e9rablement simplifier la requ\u00eate n\u00e9cessaire pour trouver les livres \u00e9crits par Fernanda Melchor.</li> </ul> <pre><code>SELECT \"title\" FROM \"longlist\" WHERE \"name\" = 'Fernanda Melchor';\n</code></pre> <ul> <li>Une vue, \u00e9tant une table virtuelle, ne consomme pas beaucoup plus d'espace disque pour \u00eatre cr\u00e9\u00e9e. Les donn\u00e9es d'une vue sont toujours stock\u00e9es dans les tables sous-jacentes, mais restent accessibles via cette vue simplifi\u00e9e.</li> </ul>"},{"location":"cours5/#questions","title":"Questions","text":"<p>Peut-on manipuler les vues pour les trier ou les afficher diff\u00e9remment ?</p> <ul> <li>Oui, nous pouvons trier les livres dans une vue de la m\u00eame mani\u00e8re que nous le ferions dans une table.<ul> <li>Par exemple, affichons les donn\u00e9es de la vue <code>longlist</code>, tri\u00e9es par les titres des livres.</li> </ul> </li> </ul> <pre><code>SELECT \"name\", \"title\"\nFROM  \"longlist\"\nORDER BY \"title\";\n</code></pre> <pre><code>- Nous pourrions \u00e9galement avoir la vue elle-m\u00eame tri\u00e9e. Nous pouvons le faire en incluant une clause `ORDER BY` dans la requ\u00eate utilis\u00e9e pour cr\u00e9er la vue.\n</code></pre>"},{"location":"cours5/#agregation","title":"Agr\u00e9gation","text":"<ul> <li>Dans <code>longlist.db</code>, nous avons une table contenant des notes individuelles attribu\u00e9es \u00e0 chaque livre. Dans les semaines pr\u00e9c\u00e9dentes, nous avons vu comment trouver la note moyenne de chaque livre, arrondie \u00e0 2 d\u00e9cimales.</li> </ul> <pre><code>SELECT \"book_id\", ROUND(AVG(\"rating\"), 2) AS \"rating\"\nFROM \"ratings\"\nGROUP BY \"book_id\";\n</code></pre> <ul> <li>Les r\u00e9sultats de la requ\u00eate ci-dessus peuvent \u00eatre rendus plus utiles en affichant le titre de chaque livre, et peut-\u00eatre l'ann\u00e9e o\u00f9 chaque livre a \u00e9t\u00e9 pr\u00e9s\u00e9lectionn\u00e9. Ces informations sont pr\u00e9sentes dans la table <code>books</code>.</li> </ul> <pre><code>SELECT \"book_id\", \"title\", \"year\", ROUND(AVG(\"rating\"), 2) AS \"rating\"\nFROM \"ratings\"\nJOIN \"books\" ON \"ratings\".\"book_id\" = \"books\".\"id\"\nGROUP BY \"book_id\";\n</code></pre> <pre><code>- Ici, nous utilisons un `JOIN` pour combiner des informations des tables `ratings` et `books`, en les joignant sur la colonne de l'ID du livre.\n- Remarquez l'ordre des op\u00e9rations dans cette requ\u00eate \u2014 en particulier, le placement de l'op\u00e9ration `GROUP BY` \u00e0 la fin de la requ\u00eate apr\u00e8s la jonction des deux tables.\n</code></pre> <ul> <li>Ces donn\u00e9es agr\u00e9g\u00e9es peuvent \u00eatre stock\u00e9es dans une vue.</li> </ul> <pre><code>CREATE VIEW \"average_book_ratings\" AS\nSELECT \"book_id\" AS \"id\", \"title\", \"year\", ROUND(AVG(\"rating\"), 2) AS \"rating\"\nFROM \"ratings\"\nJOIN \"books\" ON \"ratings\".\"book_id\" = \"books\".\"id\"\nGROUP BY \"book_id\";\n</code></pre> <pre><code>- Maintenant, regardons les donn\u00e9es dans cette vue.\n</code></pre> <pre><code>SELECT * FROM \"average_book_ratings\";\n</code></pre> <ul> <li>En ajoutant plus de donn\u00e9es \u00e0 la table <code>ratings</code>, pour obtenir un agr\u00e9gat \u00e0 jour, il suffit de requ\u00eater \u00e0 nouveau la vue en utilisant une commande <code>SELECT</code> comme ci-dessus !</li> <li>Chaque fois qu'une vue est cr\u00e9\u00e9e, elle est ajout\u00e9e au sch\u00e9ma. Nous pouvons v\u00e9rifier cela en ex\u00e9cutant <code>.schema</code> pour observer que <code>longlist</code> et <code>average_book_ratings</code> font d\u00e9sormais partie du sch\u00e9ma de cette base de donn\u00e9es.</li> <li>Pour cr\u00e9er des vues temporaires qui ne sont pas stock\u00e9es dans le sch\u00e9ma de la base de donn\u00e9es, nous pouvons utiliser <code>CREATE TEMPORARY VIEW</code>. Cette commande cr\u00e9e une vue qui existe uniquement pendant la dur\u00e9e de notre connexion avec la base de donn\u00e9es.</li> <li>Pour trouver la note moyenne des livres par ann\u00e9e, nous pouvons utiliser la vue que nous avons d\u00e9j\u00e0 cr\u00e9\u00e9e.</li> </ul> <pre><code>SELECT \"year\", ROUND(AVG(\"rating\"), 2) AS \"rating\"\nFROM \"average_book_ratings\"\nGROUP BY \"year\";\n</code></pre> <p>Remarquez que nous s\u00e9lectionnons la colonne <code>rating</code> de <code>average_book_ratings</code>, qui contient d\u00e9j\u00e0 les notes moyennes par livre. Ensuite, nous les regroupons par ann\u00e9e et calculons \u00e0 nouveau les notes moyennes, ce qui nous donne la note moyenne par ann\u00e9e ! - Nous pouvons stocker les r\u00e9sultats dans une vue temporaire.</p> <pre><code>CREATE TEMPORARY VIEW \"average_ratings_by_year\" AS\nSELECT \"year\", ROUND(AVG(\"rating\"), 2) AS \"rating\" FROM \"average_book_ratings\"\nGROUP BY \"year\";\n</code></pre>"},{"location":"cours5/#questions_1","title":"Questions","text":"<p>Les vues temporaires peuvent-elles \u00eatre utilis\u00e9es pour tester si une requ\u00eate fonctionne ou non ?</p> <ul> <li>Oui, c'est un excellent cas d'utilisation pour les vues temporaires ! Pour g\u00e9n\u00e9raliser un peu, les vues temporaires sont utilis\u00e9es lorsque nous voulons organiser des donn\u00e9es d'une certaine mani\u00e8re sans r\u00e9ellement stocker cette organisation \u00e0 long terme.</li> </ul>"},{"location":"cours5/#expression-commune-de-table-cte","title":"Expression Commune de Table (CTE)","text":"<ul> <li>Une vue r\u00e9guli\u00e8re existe pour toujours dans notre sch\u00e9ma de base de donn\u00e9es. Une vue temporaire existe pendant la dur\u00e9e de notre connexion avec la base de donn\u00e9es. Une CTE est une vue qui existe pour une seule requ\u00eate.</li> <li>Recr\u00e9ons la vue contenant les notes moyennes des livres par ann\u00e9e en utilisant une CTE au lieu d'une vue temporaire. Tout d'abord, nous devons supprimer la vue temporaire existante afin de pouvoir r\u00e9utiliser le nom <code>average_book_ratings</code>.</li> </ul> <pre><code>DROP VIEW \"average_book_ratings\";\n</code></pre> <ul> <li>Ensuite, nous cr\u00e9ons une CTE contenant les notes moyennes par livre. Nous utilisons ensuite les notes moyennes par livre pour calculer les notes moyennes par ann\u00e9e, de la m\u00eame mani\u00e8re que nous l'avons fait pr\u00e9c\u00e9demment.</li> </ul> <pre><code>WITH \"average_book_ratings\" AS (\n    SELECT \"book_id\", \"title\", \"year\", ROUND(AVG(\"rating\"), 2) AS \"rating\" FROM \"ratings\"\n    JOIN \"books\" ON \"ratings\".\"book_id\" = \"books\".\"id\"\n    GROUP BY \"book_id\"\n)\nSELECT \"year\" ROUND(AVG(\"rating\"), 2) AS \"rating\" FROM \"average_book_ratings\"\nGROUP BY \"year\";\n</code></pre>"},{"location":"cours5/#partitionnement","title":"Partitionnement","text":"<ul> <li>Les vues peuvent \u00eatre utilis\u00e9es pour partitionner des donn\u00e9es, ou les diviser en morceaux plus petits qui seront utiles pour nous ou une application. Par exemple, le site web du International Booker Prize a une page de livres pr\u00e9s\u00e9lectionn\u00e9s pour chaque ann\u00e9e o\u00f9 le prix a \u00e9t\u00e9 d\u00e9cern\u00e9. Cependant, notre base de donn\u00e9es stocke tous les livres pr\u00e9s\u00e9lectionn\u00e9s dans une seule table. Pour cr\u00e9er le site web, ou \u00e0 d'autres fins, il pourrait \u00eatre utile d'avoir une table (ou vue) diff\u00e9rente de livres pour chaque ann\u00e9e.</li> <li>Cr\u00e9ons une vue pour stocker les livres pr\u00e9s\u00e9lectionn\u00e9s en 2022.</li> </ul> <pre><code>CREATE VIEW \"2022\" AS\nSELECT \"id\", \"title\" FROM \"books\"\nWHERE \"year\" = 2022;\n</code></pre> <pre><code>- Nous pouvons \u00e9galement voir les donn\u00e9es dans cette vue.\n</code></pre> <pre><code>SELECT * FROM \"2022\";\n</code></pre>"},{"location":"cours5/#questions_2","title":"Questions","text":"<p>Les vues peuvent-elles \u00eatre mises \u00e0 jour ?</p> <ul> <li>Non, car les vues ne contiennent pas de donn\u00e9es comme les tables. Les vues extraient en fait des donn\u00e9es des tables sous-jacentes chaque fois qu'elles sont interrog\u00e9es. Cela signifie que lorsqu'une table sous-jacente est mise \u00e0 jour, la prochaine fois que la vue est interrog\u00e9e, elle affichera les donn\u00e9es mises \u00e0 jour de la table !</li> </ul>"},{"location":"cours5/#securisation","title":"S\u00e9curisation","text":"<ul> <li>Les vues peuvent \u00eatre utilis\u00e9es pour am\u00e9liorer la s\u00e9curit\u00e9 de la base de donn\u00e9es en limitant l'acc\u00e8s \u00e0 certaines donn\u00e9es.</li> <li>Prenons l'exemple d'une base de donn\u00e9es d'une entreprise de covoiturage avec une table <code>rides</code> qui ressemble \u00e0 ce qui suit.</li> </ul> <p> - Si nous devions donner ces donn\u00e9es \u00e0 un analyste, dont le travail est de trouver les itin\u00e9raires de trajet les plus populaires, il serait inutile et en fait, non s\u00e9curis\u00e9 de lui donner les noms des passagers individuels. Les noms des passagers sont probablement class\u00e9s comme informations personnelles identifiables (PII) que les entreprises ne sont pas autoris\u00e9es \u00e0 partager sans discernement. - Les vues peuvent \u00eatre utiles dans cette situation \u2014 nous pouvons partager avec l'analyste une vue contenant l'origine et la destination des trajets, mais pas les noms des passagers. - Pour essayer cela, ouvrons <code>rideshare.db</code> dans notre terminal. L'ex\u00e9cution de <code>.schema</code> devrait r\u00e9v\u00e9ler une table appel\u00e9e <code>rides</code> dans cette base de donn\u00e9es. - Nous pouvons cr\u00e9er une vue avec les colonnes pertinentes, tout en omettant compl\u00e8tement la colonne <code>rider</code>. Mais nous irons un peu plus loin ici, et cr\u00e9erons une colonne <code>rider</code> pour afficher un passager anonyme pour chaque ligne du tableau. Cela indiquera \u00e0 l'analyste que bien que nous ayons des noms de passagers dans la base de donn\u00e9es, les noms ont \u00e9t\u00e9 anonymis\u00e9s pour des raisons de s\u00e9curit\u00e9.</p> <pre><code>CREATE VIEW \"analysis\" AS\nSELECT \"id\", \"origin\", \"destination\", 'Anonymous' AS \"rider\"\nFROM \"rides\";\n</code></pre> <pre><code>- Nous pouvons interroger cette vue pour nous assurer qu'elle est s\u00e9curis\u00e9e.\n</code></pre> <pre><code>SELECT * FROM \"analysis\";\n</code></pre> <ul> <li>Bien que nous puissions cr\u00e9er une vue qui anonymise les donn\u00e9es, SQLite ne permet pas le contr\u00f4le d'acc\u00e8s. Cela signifie que notre analyste pourrait simplement interroger la table <code>rides</code> d'origine et voir tous les noms de passagers que nous avons pris soin d'omettre dans la vue <code>analysis</code>.</li> </ul>"},{"location":"cours5/#suppressions-logiques-soft-deletions","title":"Suppressions Logiques (Soft Deletions)","text":"<ul> <li>Comme nous l'avons vu dans les semaines pr\u00e9c\u00e9dentes, une suppression logique implique de marquer une ligne comme supprim\u00e9e au lieu de la retirer de la table.</li> <li>Par exemple, une \u0153uvre d'art intitul\u00e9e \"Farmers working at dawn\" est marqu\u00e9e comme supprim\u00e9e de la table <code>collections</code> en changeant la valeur de la colonne <code>deleted</code> de 0 \u00e0 1.</li> </ul> <p> - Nous pouvons imaginer cr\u00e9er une vue pour afficher uniquement l'art qui n'est pas supprim\u00e9. - Pour essayer cela, ouvrons <code>mfa.db</code> dans notre terminal. La table <code>collections</code> n'a pas encore de colonne <code>deleted</code>, nous devons donc l'ajouter. La valeur par d\u00e9faut ici sera 0, pour indiquer que la ligne n'est pas supprim\u00e9e.</p> <pre><code>ALTER TABLE \"collections\"\nADD COLUMN \"deleted\" INTEGER DEFAULT 0;\n</code></pre> <ul> <li>Maintenant, effectuons une suppression logique sur l'\u0153uvre \"Farmers working at dawn\", en la mettant \u00e0 jour pour avoir 1 dans la colonne <code>deleted</code>.</li> </ul> <pre><code>UPDATE \"collections\"\nSET \"deleted\" = 1\nWHERE \"title\" = 'Farmers working at dawn';\n</code></pre> <ul> <li>Nous pouvons cr\u00e9er une vue pour afficher les informations sur les lignes qui ne sont pas supprim\u00e9es.</li> </ul> <pre><code>CREATE VIEW \"current_collections\" AS\nSELECT \"id\", \"title\", \"accession_number\", \"acquired\"\nFROM \"collections\"\nWHERE \"deleted\" = 0;\n</code></pre> <pre><code>- Nous pouvons afficher les donn\u00e9es dans cette vue pour v\u00e9rifier que \"Farmers working at dawn\" n'est pas pr\u00e9sent.\n</code></pre> <pre><code>SELECT * FROM \"current_collections\";\n</code></pre> <pre><code>- Lors de la suppression logique d'une ligne de la table sous-jacente `collections`, elle sera retir\u00e9e de la vue `current_collections` lors de toute interrogation ult\u00e9rieure.\n</code></pre> <ul> <li>Nous savons d\u00e9j\u00e0 qu'il n'est pas possible d'ins\u00e9rer des donn\u00e9es dans une vue ou de les supprimer d'une vue. Cependant, nous pouvons configurer un d\u00e9clencheur qui ins\u00e8re ou supprime de la table sous-jacente ! Le d\u00e9clencheur <code>INSTEAD OF</code> nous permet de le faire.</li> </ul> <pre><code>CREATE TRIGGER \"delete\"\nINSTEAD OF DELETE ON \"current_collections\"\nFOR EACH ROW\nBEGIN\n    UPDATE \"collections\" SET \"deleted\" = 1\n    WHERE \"id\" = OLD.\"id\";\nEND;\n</code></pre> <pre><code>- Chaque fois que nous essayons de supprimer des lignes de la vue, ce d\u00e9clencheur mettra \u00e0 jour la colonne `deleted` de la ligne dans la table sous-jacente `collections`, compl\u00e9tant ainsi la suppression logique.\n- Nous utilisons le mot-cl\u00e9 `OLD` dans notre clause de mise \u00e0 jour pour indiquer que l'ID de la ligne mise \u00e0 jour dans `collections` doit \u00eatre le m\u00eame que l'ID de la ligne que nous essayons de supprimer de `current_collections`.\n</code></pre> <ul> <li>Maintenant, nous pouvons supprimer une ligne de la vue <code>current_collections</code>.</li> </ul> <pre><code>DELETE FROM \"current_collections\"\nWHERE \"title\" = 'Imaginative landscape';\n</code></pre> <p>Nous pouvons v\u00e9rifier que cela a fonctionn\u00e9 en interrogeant la vue.</p> <pre><code>SELECT * FROM \"current_collections\";\n</code></pre> <ul> <li>De m\u00eame, nous pouvons cr\u00e9er un d\u00e9clencheur qui ins\u00e8re des donn\u00e9es dans la table sous-jacente lorsque nous essayons de les ins\u00e9rer dans une vue.</li> <li>Il y a deux situations \u00e0 consid\u00e9rer ici. Nous pourrions essayer d'ins\u00e9rer dans une vue une ligne qui existe d\u00e9j\u00e0 dans la table sous-jacente, mais qui a \u00e9t\u00e9 supprim\u00e9e logiquement. Nous pouvons \u00e9crire le d\u00e9clencheur suivant pour g\u00e9rer cette situation.</li> </ul> <pre><code>CREATE TRIGGER \"insert_when_exists\"\nINSTEAD OF INSERT ON \"current_collections\"\nFOR EACH ROW\nWHEN NEW.\"accession_number\" IN (\n    SELECT \"accession_number\" FROM \"collections\"\n)\nBEGIN\n    UPDATE \"collections\"\n    SET \"deleted\" = 0\n    WHERE \"accession_number\" = NEW.\"accession_number\";\nEND;\n</code></pre> <pre><code>- Le mot-cl\u00e9 `WHEN` est utilis\u00e9 pour v\u00e9rifier si le num\u00e9ro d'accession de l'\u0153uvre existe d\u00e9j\u00e0 dans la table `collections`. Cela fonctionne parce qu'un num\u00e9ro d'accession, comme nous le savons des semaines pr\u00e9c\u00e9dentes, identifie de mani\u00e8re unique chaque \u0153uvre d'art dans cette table.\n- Si l'\u0153uvre existe dans la table sous-jacente, nous d\u00e9finissons sa valeur `deleted` sur 0, indiquant une annulation de la suppression logique.\n</code></pre> <ul> <li>La deuxi\u00e8me situation se produit lorsque nous essayons d'ins\u00e9rer une ligne qui n'existe pas dans la table sous-jacente. Le d\u00e9clencheur suivant g\u00e8re cette situation.</li> </ul> <pre><code>CREATE TRIGGER \"insert_when_new\"\nINSTEAD OF INSERT ON \"current_collections\"\nFOR EACH ROW\nWHEN NEW.\"accession_number\" NOT IN (\n    SELECT \"accession_number\" FROM \"collections\"\n)\nBEGIN\n    INSERT INTO \"collections\" (\"title\", \"accession_number\", \"acquired\")\n    VALUES (NEW.\"title\", NEW.\"accession_number\", NEW.\"acquired\");\nEND;\n</code></pre> <pre><code>- Lorsque le num\u00e9ro d'accession des donn\u00e9es ins\u00e9r\u00e9es n'est pas d\u00e9j\u00e0 pr\u00e9sent dans `collections`, il ins\u00e8re la ligne dans la table.\n</code></pre>"},{"location":"cours5/bnb/instructions/","title":"Bed and Breakfast","text":"<p> \u201cA bed and breakfast in Boston, the style of a realistic photograph\u201d, generated by DALL\u00b7E 2</p>"},{"location":"cours5/bnb/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 r\u00e9soudre","text":"<p>Un Bed and Breakfast (\u201cBnB\u201d en abr\u00e9g\u00e9 !) est un lieu d'h\u00e9bergement \u00e0 court terme o\u00f9 l'on peut s\u00e9journer et payer le propri\u00e9taire pour le service, similaire \u00e0 un h\u00f4tel. Au cours des derni\u00e8res ann\u00e9es, AirBnB a permis \u00e0 presque tout le monde de louer son logement, qu'il s'agisse d'une maison, d'un cottage mignon ou m\u00eame d'une cabane dans les arbres.</p> <p>Vous \u00eates un analyste de donn\u00e9es pour la ville de Boston et vous vous int\u00e9ressez \u00e0 d\u00e9couvrir comment l'essor d'AirBnB a chang\u00e9 la sc\u00e8ne touristique locale. Vous avez m\u00eame compil\u00e9 une base de donn\u00e9es, <code>bnb.db</code>, remplie de donn\u00e9es directement issues d'AirBnB. Dans <code>bnb.db</code>, cr\u00e9ez quelques vues (views) qui donneront une image plus claire de l'influence d'AirBnB sur la ville de Boston.</p>"},{"location":"cours5/bnb/instructions/#demonstration","title":"D\u00e9monstration","text":"<pre><code>$ sqlite3 bnb.db                                                                                    \nsqlite&gt; SELECT \"property_type\", \"host_name\", \"bedrooms\"                                             \n   ...&gt; FROM \"listings\"                                                                             \n   ...&gt; LIMIT 10;\n.quit\n</code></pre>"},{"location":"cours5/bnb/instructions/#code-de-distribution","title":"Code de distribution","text":"<p>Pour ce probl\u00e8me, vous devrez t\u00e9l\u00e9charger <code>bnb.db</code>, ainsi que quelques fichiers <code>.sql</code> dans lesquels vous \u00e9crirez vos requ\u00eates (queries).</p>"},{"location":"cours5/bnb/instructions/#schema","title":"Sch\u00e9ma","text":"<pre><code>erDiagram\n    \"Listing\" ||--o{ \"Review\" : receives\n    \"Listing\" ||--|{ \"Availability\" : has\n</code></pre> <p>Dans <code>bnb.db</code>, vous trouverez trois tables qui impl\u00e9mentent les relations d\u00e9crites dans le diagramme ER ci-dessus. Cliquez sur les d\u00e9roulants ci-dessous pour en savoir plus sur le sch\u00e9ma de chaque table.</p> <p><code>listings</code> table</p> <p>La table <code>listings</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de l'annonce (listing).</li> <li><code>property_type</code>, qui est le type de l'annonce (par exemple, \u201cEntire rental unit\u201d, \u201cPrivate room in rental unit\u201d, etc.).</li> <li><code>host_name</code>, qui est le nom d'utilisateur AirBnB de l'h\u00f4te de l'annonce.</li> <li><code>accommodates</code>, qui est le nombre maximum d'occupants de l'annonce.</li> <li><code>bedrooms</code>, qui est le nombre de chambres de l'annonce.</li> <li><code>description</code>, qui est la description de l'annonce sur AirBnB.</li> </ul> <p><code>reviews</code> table</p> <p>La table <code>reviews</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de l'avis (review).</li> <li><code>listing_id</code>, qui est l'ID de l'annonce qui a re\u00e7u l'avis.</li> <li><code>date</code>, qui est la date de publication de l'avis.</li> <li><code>reviewer_name</code>, qui est le nom d'utilisateur AirBnB du r\u00e9viseur.</li> <li><code>comments</code>, qui est le contenu de l'avis.</li> </ul> <p><code>availabilities</code> table</p> <p>La table <code>availabilities</code> contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de la disponibilit\u00e9 (availability).</li> <li><code>listing_id</code>, qui est l'ID de l'annonce associ\u00e9e \u00e0 la disponibilit\u00e9.</li> <li><code>date</code>, qui est la date de la disponibilit\u00e9.</li> <li><code>available</code>, qui indique si la date est toujours disponible \u00e0 la r\u00e9servation (<code>TRUE</code> ou <code>FALSE</code>).</li> <li><code>price</code>, qui est le prix du s\u00e9jour \u00e0 la date donn\u00e9e.</li> </ul>"},{"location":"cours5/bnb/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Dans chacun des fichiers <code>.sql</code> correspondants, \u00e9crivez une instruction SQL (SQL statement) pour cr\u00e9er chacune des vues (views) suivantes des donn\u00e9es dans <code>bnb.db</code>. Notez que, bien que les vues puissent \u00eatre cr\u00e9\u00e9es \u00e0 partir d'autres vues, chacune de vos vues doit \u00eatre autonome (c'est-\u00e0-dire ne pas d\u00e9pendre d'une vue ant\u00e9rieure).</p>"},{"location":"cours5/bnb/instructions/#no-descriptions","title":"No Descriptions","text":"<p>Vous remarquerez peut-\u00eatre qu'en ex\u00e9cutant</p> <pre><code>SELECT * FROM \"listings\" LIMIT 5;\n</code></pre> <p>les r\u00e9sultats semblent assez bizarres ! La colonne <code>description</code> contient des descriptions avec de nombreux sauts de ligne, chacun \u00e9tant imprim\u00e9 dans votre terminal.</p> <p>Dans <code>no_descriptions.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>no_descriptions</code> qui inclut toutes les colonnes de la table <code>listings</code> sauf <code>description</code>.</p>"},{"location":"cours5/bnb/instructions/#one-bedrooms","title":"One-Bedrooms","text":"<p>Dans <code>one_bedrooms.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>one_bedrooms</code>. Cette vue doit contenir toutes les annonces (listings) qui ont exactement une chambre. Assurez-vous que la vue contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'<code>id</code> de l'annonce de la table <code>listings</code>.</li> <li><code>property_type</code>, de la table <code>listings</code>.</li> <li><code>host_name</code>, de la table <code>listings</code>.</li> <li><code>accommodates</code>, de la table <code>listings</code>.</li> </ul>"},{"location":"cours5/bnb/instructions/#available","title":"Available","text":"<p>Dans <code>available.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>available</code>. Cette vue doit contenir toutes les dates disponibles pour toutes les annonces. Assurez-vous que la vue contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'<code>id</code> de l'annonce de la table <code>listings</code>.</li> <li><code>property_type</code>, de la table <code>listings</code>.</li> <li><code>host_name</code>, de la table <code>listings</code>.</li> <li><code>date</code>, de la table <code>availabilities</code>, qui est la date de la disponibilit\u00e9.</li> </ul>"},{"location":"cours5/bnb/instructions/#frequently-reviewed","title":"Frequently Reviewed","text":"<p>Dans <code>frequently_reviewed.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>frequently_reviewed</code>. Cette vue doit contenir les 100 annonces les plus fr\u00e9quemment comment\u00e9es, tri\u00e9es de la plus \u00e0 la moins fr\u00e9quemment comment\u00e9e. Assurez-vous que la vue contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'<code>id</code> de l'annonce de la table <code>listings</code>.</li> <li><code>property_type</code>, de la table <code>listings</code>.</li> <li><code>host_name</code>, de la table <code>listings</code>.</li> <li><code>reviews</code>, qui est le nombre d'avis que l'annonce a re\u00e7us.</li> </ul> <p>Si deux annonces ont le m\u00eame nombre d'avis, triez par <code>property_type</code> (par ordre alphab\u00e9tique), puis par <code>host_name</code> (par ordre alphab\u00e9tique).</p>"},{"location":"cours5/bnb/instructions/#june-vacancies","title":"June Vacancies","text":"<p>Dans <code>june_vacancies.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>june_vacancies</code>. Cette vue doit contenir toutes les annonces et le nombre de jours en juin 2023 o\u00f9 elles sont rest\u00e9es vacantes. Assurez-vous que la vue contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'<code>id</code> de l'annonce de la table <code>listings</code>.</li> <li><code>property_type</code>, de la table <code>listings</code>.</li> <li><code>host_name</code>, de la table <code>listings</code>.</li> <li><code>days_vacant</code>, qui est le nombre de jours en juin 2023 o\u00f9 l'annonce donn\u00e9e \u00e9tait marqu\u00e9e comme disponible.</li> </ul>"},{"location":"cours5/bnb/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos vues au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez ex\u00e9cuter une requ\u00eate (query) sur la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read no_descriptions.sql\n</code></pre> <p>Gardez \u00e0 l'esprit que vous pouvez \u00e9galement utiliser</p> <pre><code>DROP VIEW name;\n</code></pre> <p>o\u00f9 <code>name</code> est le nom de votre vue, pour supprimer une vue avant de la recr\u00e9er.</p>"},{"location":"cours5/bnb/instructions/#comment-tester","title":"Comment tester","text":"<p>Bien que <code>check50</code> soit disponible pour ce probl\u00e8me, vous \u00eates encourag\u00e9 \u00e0 tester \u00e9galement votre code par vous-m\u00eame. Vous pouvez essayer des requ\u00eates comme celles ci-dessous :</p> <ul> <li>Combien y a-t-il d'annonces au total ? Utilisez votre vue <code>no_descriptions</code> pour trouver qu'il y en a 3 973.</li> <li>Combien y a-t-il d'annonces avec une chambre ? Et combien peuvent accueillir au moins 4 invit\u00e9s ? Utilisez votre vue <code>one_bedrooms</code> pour trouver que parmi les 1 228 annonces avec une chambre, 222 peuvent accueillir votre groupe de 4.</li> <li>Combien d'annonces sont disponibles pour le 31 d\u00e9cembre 2023 (c'est-\u00e0-dire \u201c2023-12-31\u201d) ? Utilisez votre vue <code>available</code> pour trouver qu'il y en a 2 251. Combien d'entre elles sont disponibles sur n'importe quel type de bateau ? Vous devriez trouver qu'il y en a 7. Bonne ann\u00e9e \u00e0 flot !</li> <li>Combien d'avis a la propri\u00e9t\u00e9 la plus fr\u00e9quemment comment\u00e9e ? Et qui est l'h\u00f4te de cette propri\u00e9t\u00e9 ? Utilisez votre vue <code>frequently_reviewed</code> pour trouver que la propri\u00e9t\u00e9 de Tiffany a 860 avis.</li> <li>Combien d'annonces \u00e9taient disponibles en juin 2023 ? Utilisez votre vue <code>june_vacancies</code> pour trouver qu'il y avait 1 895 vacances.</li> </ul>"},{"location":"cours5/census/instructions/","title":"Recenseur","text":"<p> \u00ab Les cha\u00eenes de montagnes de l'Himalaya dans le style d'une peinture n\u00e9palaise \u00bb, g\u00e9n\u00e9r\u00e9e par DALL\u00b7E 2</p>"},{"location":"cours5/census/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 r\u00e9soudre","text":"<p>Vous \u00eates un recenseur (census taker) travaillant pour le gouvernement n\u00e9palais. Alors que vous franchissez une derni\u00e8re colline, votre souffle se coupe \u00e0 la vue d'un lever de soleil himalayen, projetant une lueur sur le village que vous avez parcouru si loin pour atteindre. Votre guide, un local, s'arr\u00eate brusquement. Sous le bruissement constant de vos papiers de recensement (census papers), vous ressentez une d\u00e9mangeaison de curiosit\u00e9. Apr\u00e8s tout, ce n'est pas tous les jours que votre travail vous emm\u00e8ne dans un village comme celui-ci.</p> <p>Dans <code>census.db</code>, traitez vos donn\u00e9es en vues (views) que le gouvernement n\u00e9palais peut utiliser pour la tenue des dossiers.</p>"},{"location":"cours5/census/instructions/#demonstration","title":"D\u00e9monstration","text":"<pre><code>sqlite3 census.db\nSELECT district, locality, families FROM census;\n.quit       \n</code></pre>"},{"location":"cours5/census/instructions/#code-de-distribution","title":"Code de distribution","text":"<p>Pour ce probl\u00e8me, vous devrez t\u00e9l\u00e9charger <code>census.db</code>, ainsi que quelques fichiers <code>.sql</code> dans lesquels vous \u00e9crirez vos requ\u00eates (queries).</p>"},{"location":"cours5/census/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Dans <code>census.db</code>, vous trouverez une seule table, <code>census</code>. Dans la table <code>census</code>, vous trouverez les colonnes suivantes :</p> <ul> <li><code>id</code>, qui identifie de mani\u00e8re unique chaque enregistrement de recensement (census record)</li> <li><code>district</code>, qui est le nom du district de l'enregistrement de recensement</li> <li><code>locality</code>, qui est le nom de la localit\u00e9 de l'enregistrement de recensement au sein du district</li> <li><code>families</code>, qui est le nombre de familles associ\u00e9es \u00e0 l'enregistrement de recensement</li> <li><code>households</code>, qui est le nombre total de m\u00e9nages associ\u00e9s \u00e0 l'enregistrement de recensement (plusieurs familles peuvent vivre dans le m\u00eame m\u00e9nage)</li> <li><code>population</code>, qui est la population associ\u00e9e \u00e0 l'enregistrement de recensement</li> <li><code>male</code>, qui est le nombre de personnes associ\u00e9es \u00e0 l'enregistrement de recensement qui se sont identifi\u00e9es comme \u00e9tant de sexe masculin</li> <li><code>female</code>, qui est le nombre de personnes associ\u00e9es \u00e0 l'enregistrement de recensement qui se sont identifi\u00e9es comme \u00e9tant de sexe f\u00e9minin</li> </ul>"},{"location":"cours5/census/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Dans chacun des fichiers <code>.sql</code> correspondants, \u00e9crivez une instruction SQL (SQL statement) pour cr\u00e9er chacune des vues (views) suivantes des donn\u00e9es dans <code>census.db</code>. Notez que, bien que les vues puissent \u00eatre cr\u00e9\u00e9es \u00e0 partir d'autres vues, chacune de vos vues doit \u00eatre autonome (c'est-\u00e0-dire ne pas d\u00e9pendre d'une vue ant\u00e9rieure).</p>"},{"location":"cours5/census/instructions/#rural","title":"Rural","text":"<p>Dans <code>rural.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>rural</code>. Cette vue doit contenir tous les enregistrements de recensement relatifs \u00e0 une municipalit\u00e9 rurale (identifi\u00e9e par l'inclusion de \u00ab rural \u00bb dans leur nom). Assurez-vous que la vue contient toutes les colonnes de la table <code>census</code>.</p>"},{"location":"cours5/census/instructions/#total","title":"Total","text":"<p>Dans <code>total.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>total</code>. Cette vue doit contenir les sommes pour chaque colonne num\u00e9rique dans <code>census</code>, \u00e0 travers tous les districts et localit\u00e9s. Assurez-vous que la vue contient chacune des colonnes suivantes :</p> <ul> <li><code>families</code>, qui est la somme des familles de chaque localit\u00e9 au N\u00e9pal.</li> <li><code>households</code>, qui est la somme des m\u00e9nages de chaque localit\u00e9 au N\u00e9pal.</li> <li><code>population</code>, qui est la somme de la population de chaque localit\u00e9 au N\u00e9pal.</li> <li><code>male</code>, qui est la somme des personnes s'identifiant comme \u00e9tant de sexe masculin de chaque localit\u00e9 au N\u00e9pal.</li> <li><code>female</code>, qui est la somme des personnes s'identifiant comme \u00e9tant de sexe f\u00e9minin de chaque localit\u00e9 au N\u00e9pal.</li> </ul>"},{"location":"cours5/census/instructions/#par-district","title":"Par District","text":"<p>Dans <code>by_district.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>by_district</code>. Cette vue doit contenir les sommes pour chaque colonne num\u00e9rique dans <code>census</code>, regroup\u00e9es par <code>district</code>. Assurez-vous que la vue contient chacune des colonnes suivantes :</p> <ul> <li><code>district</code>, qui est le nom du district.</li> <li><code>families</code>, qui est le nombre total de familles dans le district.</li> <li><code>households</code>, qui est le nombre total de m\u00e9nages dans le district.</li> <li><code>population</code>, qui est la population totale du district.</li> <li><code>male</code>, qui est le nombre total de personnes s'identifiant comme \u00e9tant de sexe masculin dans le district.</li> <li><code>female</code>, qui est le nombre total de personnes s'identifiant comme \u00e9tant de sexe f\u00e9minin dans le district.</li> </ul>"},{"location":"cours5/census/instructions/#le-plus-peuple","title":"Le plus peupl\u00e9","text":"<p>Dans <code>most_populated.sql</code>, \u00e9crivez une instruction SQL pour cr\u00e9er une vue nomm\u00e9e <code>most_populated</code>. Cette vue doit contenir, dans l'ordre du plus grand au plus petit, les districts les plus peupl\u00e9s du N\u00e9pal. Assurez-vous que la vue contient chacune des colonnes suivantes :</p> <ul> <li><code>district</code>, qui est le nom du district.</li> <li><code>families</code>, qui est le nombre total de familles dans le district.</li> <li><code>households</code>, qui est le nombre total de m\u00e9nages dans le district.</li> <li><code>population</code>, qui est la population totale du district.</li> <li><code>male</code>, qui est le nombre total de personnes s'identifiant comme \u00e9tant de sexe masculin dans le district.</li> <li><code>female</code>, qui est le nombre total de personnes s'identifiant comme \u00e9tant de sexe f\u00e9minin dans le district.</li> </ul>"},{"location":"cours5/census/instructions/#utilisation","title":"Utilisation","text":"<p>Pour tester vos vues au fur et \u00e0 mesure que vous les \u00e9crivez dans vos fichiers <code>.sql</code>, vous pouvez ex\u00e9cuter une requ\u00eate (query) sur la base de donn\u00e9es en ex\u00e9cutant</p> <pre><code>.read FILENAME\n</code></pre> <p>o\u00f9 <code>FILENAME</code> est le nom du fichier contenant votre requ\u00eate SQL. Par exemple,</p> <pre><code>.read rural.sql\n</code></pre> <p>Gardez \u00e0 l'esprit que vous pouvez \u00e9galement utiliser</p> <pre><code>DROP VIEW name;\n</code></pre> <p>o\u00f9 <code>name</code> est le nom de votre vue, pour supprimer une vue avant de la recr\u00e9er.</p>"},{"location":"cours5/private/instructions/","title":"The Private Eye","text":"<p> \u201cA detective\u2019s library in the style of an oil painting,\u201d generated by DALL\u00b7E 2</p>"},{"location":"cours5/private/instructions/#probleme-a-resoudre","title":"Probl\u00e8me \u00e0 r\u00e9soudre","text":"<p>Le d\u00e9bogueur de canard (duck debugger) de CS50 a encore disparu et vous avez d\u00e9sesp\u00e9r\u00e9ment besoin d'un d\u00e9tective. Vous avez entendu des histoires sur un d\u00e9tective qui vit en haut de la ville, toujours secret dans son travail, jamais vu sauf quand il le souhaite. Sans surprise, il s'est av\u00e9r\u00e9 \u00eatre assez insaisissable pour vous. Mais vous voil\u00e0, dans son \u00e9tude, apr\u00e8s avoir r\u00e9cup\u00e9r\u00e9 son adresse aupr\u00e8s d'un certain employ\u00e9 de la poste.</p> <p>Sur son bureau en acajou, du papier blanc frais scintille. Inscrit, vous trouvez le tableau suivant :</p> 14 98 4 114 3 5 618 72 9 630 7 3 932 12 5 2230 50 7 2346 44 10 3041 14 5 <p>Et gliss\u00e9 en dessous, un livre us\u00e9, Les Aventures de Sherlock Holmes.</p>"},{"location":"cours5/private/instructions/#code-de-distribution","title":"Code de distribution","text":"<p>Pour ce probl\u00e8me, vous devrez t\u00e9l\u00e9charger <code>private.db</code> et <code>private.sql</code>.</p>"},{"location":"cours5/private/instructions/#contexte","title":"Contexte","text":"<p>\u00c9tant donn\u00e9 la proximit\u00e9 du papier avec Les Aventures de Sherlock Holmes, ce qui est \u00e9crit sur celui-ci semble \u00eatre une variation d'un chiffre de livre (book cipher). Vous savez que dans une version d'un chiffre de livre, le cr\u00e9ateur du chiffre vous donne une liste de \u201ctriplets\u201d (c'est-\u00e0-dire un ensemble de trois nombres). Chaque triplet est structur\u00e9 comme suit :</p> <ul> <li>Le premier nombre du triplet est le num\u00e9ro de la phrase r\u00e9f\u00e9renc\u00e9e par l'encodeur.</li> <li>Le deuxi\u00e8me nombre du triplet est le num\u00e9ro du caract\u00e8re, dans cette phrase, o\u00f9 le message commence.</li> <li>Le troisi\u00e8me nombre du triplet est la longueur du message en caract\u00e8res (c'est-\u00e0-dire combien de caract\u00e8res lire \u00e0 partir du premier, y compris les espaces et la ponctuation).</li> </ul> <p>Par exemple, consid\u00e9rez le triplet 2, 1, 8 \u00e0 la lumi\u00e8re des phrases suivantes :</p> <p>Quite so! You have not observed. And yet you have seen.</p> <p>2 fait r\u00e9f\u00e9rence \u00e0 la 2\u00e8me phrase, \u201cYou have not observed.\u201d 1 fait r\u00e9f\u00e9rence au 1er caract\u00e8re de cette phrase, \u201cY.\u201d Et 8 fait r\u00e9f\u00e9rence \u00e0 la longueur du message \u00e0 partir de ce premier caract\u00e8re. En commen\u00e7ant par le 1er caract\u00e8re de la 2\u00e8me phrase, en lisant 8 caract\u00e8res (y compris les espaces !) vous obtenez :</p> <p>You have</p> <p>Vous pouvez imaginer, maintenant, encha\u00eener plusieurs tuples pour encoder un message plus long. Peut-\u00eatre que c'est exactement ce que le d\u00e9tective a fait !</p>"},{"location":"cours5/private/instructions/#schema","title":"Sch\u00e9ma","text":"<p>Dans <code>private.db</code>, vous trouverez une table, <code>sentences</code>. La table <code>sentences</code> contient toutes les phrases des Aventures de Sherlock Holmes. En particulier, elle contient les colonnes suivantes :</p> <ul> <li><code>id</code>, qui est l'ID de la phrase</li> <li><code>sentence</code>, qui est la phrase elle-m\u00eame</li> </ul>"},{"location":"cours5/private/instructions/#specification","title":"Sp\u00e9cification","text":"<p>Votre t\u00e2che est de d\u00e9coder le chiffre laiss\u00e9 pour vous par le d\u00e9tective. La mani\u00e8re dont vous le faites d\u00e9pend de vous, mais vous devez vous assurer que\u2014\u00e0 la fin de votre processus\u2014vous avez une vue (view) structur\u00e9e comme suit :</p> <ul> <li>La vue doit \u00eatre nomm\u00e9e <code>message</code></li> <li>La vue doit avoir une seule colonne, <code>phrase</code></li> <li>Lorsque la requ\u00eate SQL (SQL query) suivante est ex\u00e9cut\u00e9e sur <code>private.db</code>, votre vue doit renvoyer une seule colonne dans laquelle chaque ligne est une phrase du message.</li> </ul> <pre><code>SELECT \"phrase\" FROM \"message\";\n</code></pre> <p>Dans <code>private.sql</code>, vous devez \u00e9crire toutes les instructions SQL (SQL statements) n\u00e9cessaires pour reproduire votre cr\u00e9ation de la vue. C'est-\u00e0-dire :</p> <ul> <li>Si la cr\u00e9ation de la vue n\u00e9cessite la cr\u00e9ation d'une table s\u00e9par\u00e9e et l'insertion de donn\u00e9es dans celle-ci, vous devez vous assurer que <code>private.sql</code> contient les instructions pour cr\u00e9er cette table et ins\u00e9rer ces donn\u00e9es. (N'ayez pas peur d'ajouter des tables et d'ajouter des donn\u00e9es comme vous le souhaitez !)</li> <li><code>private.sql</code>, lorsqu'il est ex\u00e9cut\u00e9 sur une nouvelle instance de <code>private.db</code>, doit \u00eatre capable de reconstruire enti\u00e8rement votre vue.</li> </ul>"},{"location":"cours5/private/instructions/#conseil","title":"Conseil","text":"<p>Il s'av\u00e8re que SQLite est \u00e9quip\u00e9 d'une fonction qui impl\u00e9mente exactement la fonctionnalit\u00e9 du chiffre de livre : <code>substr</code>. La fonction <code>substr</code> prend trois entr\u00e9es (\u201carguments\u201d) :</p> <ul> <li>Une cha\u00eene (c'est-\u00e0-dire du texte) \u00e0 partir de laquelle prendre une sous-cha\u00eene (c'est-\u00e0-dire un sous-ensemble des caract\u00e8res de la cha\u00eene)</li> <li>Le caract\u00e8re de d\u00e9but de la sous-cha\u00eene, identifi\u00e9 par son num\u00e9ro (le premier caract\u00e8re est 1)</li> <li>La longueur de la sous-cha\u00eene</li> </ul> <p>Par exemple, supposons que vous ayez une table appel\u00e9e <code>sentences</code> qui inclut ce qui suit :</p> ID sentence 1 Quite so! 2 You have not observed. 3 And yet you have seen. <p>Si vous ex\u00e9cutez la requ\u00eate SQL suivante\u2026</p> <pre><code>SELECT substr(\"sentence\", 1, 2)\nFROM \"sentences\";\n</code></pre> <p>vous recevrez les r\u00e9sultats suivants :</p> ID Substring (1, 2) 1 Qu 2 Yo 3 An <p>Gardez \u00e0 l'esprit que les autres arguments de <code>substr</code> peuvent \u00e9galement \u00eatre des colonnes enti\u00e8res !</p>"},{"location":"cours6/","title":"Cours 5","text":"<ul> <li>Introduction</li> <li>Index</li> <li>Index sur plusieurs tables</li> <li>Compromis espace</li> <li>Compromis temps</li> <li>Index partiel</li> <li>Vacuum</li> <li>Concurrence</li> <li>Transactions</li> <li>Conditions de course</li> <li>Fin</li> </ul>"},{"location":"cours6/#introduction","title":"Introduction","text":"<ul> <li>Cette semaine, nous allons apprendre \u00e0 optimiser nos requ\u00eates SQL, \u00e0 la fois en termes de temps et d'espace. Nous apprendrons \u00e9galement \u00e0 ex\u00e9cuter des requ\u00eates simultan\u00e9ment.</li> <li>Nous ferons tout cela dans le contexte d'une nouvelle base de donn\u00e9es \u2014 la base de donn\u00e9es Internet Movies Database, ou IMDb comme elle est plus commun\u00e9ment connue. Notre base de donn\u00e9es SQLite est compil\u00e9e \u00e0 partir de la grande base de donn\u00e9es en ligne de films que vous avez peut-\u00eatre d\u00e9j\u00e0 vue sur imdb.com.</li> <li>Jetez un \u0153il \u00e0 ces statistiques pour vous faire une id\u00e9e de la taille de cette base de donn\u00e9es ! Elle contient beaucoup plus de donn\u00e9es que toutes les autres bases de donn\u00e9es avec lesquelles nous avons travaill\u00e9 jusqu'\u00e0 pr\u00e9sent.</li> </ul> <ul> <li>Voici le diagramme ER d\u00e9taillant les entit\u00e9s et leurs relations.</li> </ul> <pre><code>erDiagram\n\nACTEURS {\n  INTEGER id\n  TEXT nom\n  NUMERIC date_de_naissance\n}\n\nFILMS {\n  INTEGER id\n  TEXT titre\n  NUMERIC annee\n}\n\nNOTES {\n  INTEGER id\n  REAL note\n  INTEGER votes\n}\n\nACTEURS ||--o{FILMS : jouent\nFILMS ||--o{NOTES : ont\n\n</code></pre>"},{"location":"cours6/#index","title":"Index","text":"<ul> <li>Ouvrons cette base de donn\u00e9es appel\u00e9e <code>movies.db</code> dans SQLite.</li> <li><code>.schema</code> nous montre les tables cr\u00e9\u00e9es dans cette base de donn\u00e9es. Pour impl\u00e9menter la relation plusieurs-\u00e0-plusieurs entre les entit\u00e9s Person et Movie du diagramme ER, nous avons ici une table jointe appel\u00e9e <code>stars</code> qui r\u00e9f\u00e9rence les colonnes ID des deux tables <code>people</code> et <code>movies</code> en tant que colonnes de cl\u00e9 \u00e9trang\u00e8re !</li> <li>Pour jeter un \u0153il \u00e0 la table <code>movies</code>, nous pouvons s\u00e9lectionner dans la table et limiter les r\u00e9sultats.</li> </ul> <pre><code>SELECT * FROM \"movies\" LIMIT 5;\n</code></pre> <ul> <li>Pour trouver les informations concernant le film Cars, nous ex\u00e9cuterions la requ\u00eate suivante.</li> </ul> <pre><code>SELECT * FROM \"movies\"\nWHERE \"title\" = 'Cars';\n</code></pre> <ul> <li>Supposons que nous voulons savoir combien de temps il a fallu pour ex\u00e9cuter cette requ\u00eate. SQLite dispose d'une commande <code>.timer on</code> qui nous permet de chronom\u00e9trer nos requ\u00eates.</li> <li>En ex\u00e9cutant \u00e0 nouveau la requ\u00eate ci-dessus pour trouver Cars, nous pouvons voir trois mesures de temps diff\u00e9rentes affich\u00e9es avec les r\u00e9sultats.</li> <li>Le temps \"r\u00e9el\" indique le temps du chronom\u00e8tre, ou le temps entre l'ex\u00e9cution de la requ\u00eate et l'obtention des r\u00e9sultats. C'est la mesure de temps sur laquelle nous allons nous concentrer. Le temps n\u00e9cessaire pour ex\u00e9cuter cette requ\u00eate pendant le cours \u00e9tait d'environ un dixi\u00e8me de seconde !</li> <li>Sous le capot, lorsque la requ\u00eate pour trouver Cars a \u00e9t\u00e9 ex\u00e9cut\u00e9e, nous avons d\u00e9clench\u00e9 un scan de la table <code>movies</code> \u2014 c'est-\u00e0-dire que la table <code>movies</code> a \u00e9t\u00e9 scann\u00e9e de haut en bas, ligne par ligne, pour trouver toutes les lignes avec le titre Cars.</li> <li>Nous pouvons optimiser cette requ\u00eate pour qu'elle soit plus efficace qu'un scan. De la m\u00eame mani\u00e8re que les manuels scolaires ont souvent un index, les tables de bases de donn\u00e9es peuvent \u00e9galement avoir un index. Un index, en termes de bases de donn\u00e9es, est une structure utilis\u00e9e pour acc\u00e9l\u00e9rer la r\u00e9cup\u00e9ration des lignes d'une table.</li> <li>Nous pouvons utiliser la commande suivante pour cr\u00e9er un index pour la colonne <code>\"title\"</code> dans la table <code>movies</code>.</li> </ul> <pre><code>CREATE INDEX \"title_index\" ON \"movies\" (\"title\");\n</code></pre> <ul> <li>Apr\u00e8s avoir cr\u00e9\u00e9 cet index, nous ex\u00e9cutons \u00e0 nouveau la requ\u00eate pour trouver le film intitul\u00e9 Cars. Lors de cette ex\u00e9cution, le temps n\u00e9cessaire est consid\u00e9rablement plus court (pendant le cours, presque huit fois plus rapide que la premi\u00e8re ex\u00e9cution) !</li> <li>Dans l'exemple pr\u00e9c\u00e9dent, une fois l'index cr\u00e9\u00e9, nous avons simplement suppos\u00e9 que SQL l'utiliserait pour trouver un film. Cependant, nous pouvons \u00e9galement le voir explicitement en utilisant une commande SQLite <code>EXPLAIN QUERY PLAN</code> avant toute requ\u00eate.</li> <li>Pour supprimer l'index que nous venons de cr\u00e9er, ex\u00e9cutez :</li> </ul> <pre><code>DROP INDEX \"title_index\";\n</code></pre> <ul> <li>Apr\u00e8s avoir supprim\u00e9 l'index, l'ex\u00e9cution \u00e0 nouveau de <code>EXPLAIN QUERY PLAN</code> avec la requ\u00eate <code>SELECT</code> d\u00e9montrera que le plan reviendrait \u00e0 scanner toute la base de donn\u00e9es.</li> </ul>"},{"location":"cours6/#questions","title":"Questions","text":"<p>Les bases de donn\u00e9es n'ont-elles pas des algorithmes implicites pour optimiser la recherche ?</p> <ul> <li>Elles en ont, pour certaines colonnes. Dans SQLite et la plupart des autres syst\u00e8mes de gestion de bases de donn\u00e9es, si nous sp\u00e9cifions qu'une colonne est une cl\u00e9 primaire, un index sera automatiquement cr\u00e9\u00e9 via lequel nous pouvons rechercher la cl\u00e9 primaire. Cependant, pour les colonnes r\u00e9guli\u00e8res comme <code>\"title\"</code>, il n'y aurait pas d'optimisation automatique.</li> </ul> <p>Serait-il judicieux de cr\u00e9er un index diff\u00e9rent pour chaque colonne au cas o\u00f9 nous en aurions besoin ?</p> <ul> <li>Bien que cela semble utile, il y a des compromis en termes d'espace et du temps n\u00e9cessaire pour ins\u00e9rer ult\u00e9rieurement des donn\u00e9es dans des tables avec un index. Nous verrons cela plus en d\u00e9tail bient\u00f4t !</li> </ul>"},{"location":"cours6/#index-sur-plusieurs-tables","title":"Index sur plusieurs tables","text":"<ul> <li>Nous ex\u00e9cuterions la requ\u00eate suivante pour trouver tous les films dans lesquels Tom Hanks a jou\u00e9.</li> </ul> <pre><code>SELECT \"title\" FROM \"movies\"\nWHERE \"id\" IN (\n    SELECT \"movie_id\" FROM \"stars\"\n    WHERE \"person_id\" = (\n        SELECT \"id\" FROM \"people\"\n        WHERE \"name\" = 'Tom Hanks'\n    )\n);\n</code></pre> <ul> <li>Pour comprendre quel type d'index pourrait aider \u00e0 acc\u00e9l\u00e9rer cette requ\u00eate, nous pouvons ex\u00e9cuter <code>EXPLAIN QUERY PLAN</code> avant cette requ\u00eate \u00e0 nouveau. Cela nous montre que la requ\u00eate n\u00e9cessite deux scans \u2014 de <code>people</code> et <code>stars</code>. La table <code>movies</code> n'est pas scann\u00e9e car nous recherchons <code>movies</code> par son ID, pour lequel un index est automatiquement cr\u00e9\u00e9 par SQLite !</li> <li>Cr\u00e9ons les deux index pour acc\u00e9l\u00e9rer cette requ\u00eate.</li> </ul> <pre><code>CREATE INDEX \"person_index\" ON \"stars\" (\"person_id\");\nCREATE INDEX \"name_index\" ON \"people\" (\"name\");\n</code></pre> <ul> <li>Maintenant, nous ex\u00e9cutons <code>EXPLAIN QUERY PLAN</code> avec la m\u00eame requ\u00eate imbriqu\u00e9e. Nous pouvons observer que :</li> <li>tous les scans sont maintenant des recherches utilisant des index, ce qui est g\u00e9nial !</li> <li>la recherche sur la table <code>people</code> utilise quelque chose appel\u00e9 un <code>COVERING INDEX</code>.</li> <li>Un index couvrant signifie que toutes les informations n\u00e9cessaires pour la requ\u00eate peuvent \u00eatre trouv\u00e9es dans l'index lui-m\u00eame. Au lieu de deux \u00e9tapes :</li> <li>rechercher les informations pertinentes dans l'index,</li> <li>utiliser l'index pour rechercher ensuite dans la table, un index couvrant signifie que nous effectuons notre recherche en une seule \u00e9tape (juste la premi\u00e8re).</li> <li>Pour que notre recherche sur la table <code>stars</code> utilise \u00e9galement un index couvrant, nous pouvons ajouter <code>\"movie_id\"</code> \u00e0 l'index que nous avons cr\u00e9\u00e9 pour <code>stars</code>. Cela garantira que les informations recherch\u00e9es (movie ID) et la valeur recherch\u00e9e (person ID) soient toutes deux dans l'index.</li> <li>Tout d'abord, supprimons l'impl\u00e9mentation existante de notre index sur la table <code>stars</code>.</li> </ul> <pre><code>DROP INDEX \"person_index\";\n</code></pre> <ul> <li>Ensuite, nous cr\u00e9ons le nouvel index.</li> </ul> <pre><code>CREATE INDEX \"person_index\" ON \"stars\" (\"person_id\", \"movie_id\");\n</code></pre> <ul> <li>L'ex\u00e9cution de ce qui suit d\u00e9montrera que nous avons maintenant deux index couvrants, ce qui devrait r\u00e9sulter en une recherche beaucoup plus rapide !</li> </ul> <pre><code>EXPLAIN QUERY PLAN\nSELECT \"title\" FROM \"movies\" WHERE \"id\" IN (\n    SELECT \"movie_id\" FROM \"stars\" WHERE \"person_id\" = (\n        SELECT \"id\" FROM \"people\" WHERE \"name\" = 'Tom Hanks'\n    )\n);\n</code></pre> <ul> <li>En nous assurant que nous avons ex\u00e9cut\u00e9 <code>.timer on</code>, ex\u00e9cutons la requ\u00eate ci-dessus pour trouver tous les films dans lesquels Tom Hanks a jou\u00e9, et observons le temps qu'il faut pour l'ex\u00e9cuter. La requ\u00eate s'ex\u00e9cute maintenant beaucoup plus rapidement qu'elle ne le faisait sans index (dans le cours, un ordre de grandeur plus rapide) !</li> </ul>"},{"location":"cours6/#compromis-espace","title":"Compromis espace","text":"<ul> <li>Les index semblent incroyablement utiles, mais il y a des compromis associ\u00e9s \u2014 ils occupent un espace suppl\u00e9mentaire dans la base de donn\u00e9es, donc m\u00eame si nous gagnons en vitesse de requ\u00eate, nous perdons en espace.</li> <li>Un index est stock\u00e9 dans une base de donn\u00e9es sous la forme d'une structure de donn\u00e9es appel\u00e9e B-Tree, ou arbre \u00e9quilibr\u00e9. Une structure de donn\u00e9es d'arbre ressemble \u00e0 ceci :</li> </ul> <ul> <li>Remarquez que l'arbre a de nombreux n\u0153uds, chacun connect\u00e9 \u00e0 quelques autres par des fl\u00e8ches. Le n\u0153ud racine, ou le n\u0153ud \u00e0 partir duquel l'arbre prend son origine, a trois enfants. Certains n\u0153uds \u00e0 la p\u00e9riph\u00e9rie de l'arbre ne pointent vers aucun autre n\u0153ud. Ceux-ci sont appel\u00e9s n\u0153uds feuilles.</li> <li>Consid\u00e9rons comment un index est cr\u00e9\u00e9 pour la colonne <code>\"title\"</code> de la table <code>movies</code>. Si les titres des films \u00e9taient tri\u00e9s par ordre alphab\u00e9tique, il serait beaucoup plus facile de trouver un film particulier en utilisant une recherche binaire.</li> <li>Dans ce cas, une copie est faite de la colonne <code>\"titles\"</code>. Cette copie est tri\u00e9e puis li\u00e9e \u00e0 nouveau aux lignes d'origine dans la table <code>movies</code> en pointant vers les ID des films. Cela est visualis\u00e9 ci-dessous.</li> </ul> <ul> <li>Bien que cela nous aide \u00e0 visualiser facilement l'index pour cette colonne, en r\u00e9alit\u00e9, l'index n'est pas une seule colonne mais est divis\u00e9 en de nombreux n\u0153uds. C'est parce que si la base de donn\u00e9es contient beaucoup de donn\u00e9es, comme notre exemple IMDb, stocker une colonne enti\u00e8re ensemble en m\u00e9moire pourrait ne pas \u00eatre faisable.</li> <li>Si nous avons plusieurs n\u0153uds contenant des sections de l'index, nous avons \u00e9galement besoin de n\u0153uds pour naviguer vers les bonnes sections. Par exemple, consid\u00e9rez les n\u0153uds suivants. Le n\u0153ud de gauche nous dirige vers la bonne section de l'index en fonction du fait que le titre du film vient avant Frozen, entre Frozen et Soul, ou apr\u00e8s Soul par ordre alphab\u00e9tique !</li> </ul> <ul> <li>La repr\u00e9sentation ci-dessus est un B-tree ! C'est ainsi que les index sont stock\u00e9s dans SQLite.</li> </ul>"},{"location":"cours6/#compromis-temps","title":"Compromis temps","text":"<ul> <li>De mani\u00e8re similaire au compromis espace dont nous avons discut\u00e9 pr\u00e9c\u00e9demment, il faut \u00e9galement plus de temps pour ins\u00e9rer des donn\u00e9es dans une colonne et ensuite les ajouter \u00e0 un index. Chaque fois qu'une valeur est ajout\u00e9e \u00e0 l'index, le B-tree doit \u00eatre parcouru pour d\u00e9terminer o\u00f9 la valeur doit \u00eatre ajout\u00e9e !</li> </ul>"},{"location":"cours6/#index-partiel","title":"Index partiel","text":"<ul> <li>Il s'agit d'un index qui n'inclut qu'un sous-ensemble de lignes d'une table, nous permettant d'\u00e9conomiser un peu de l'espace qu'un index complet occuperait.</li> <li>Cela est particuli\u00e8rement utile lorsque nous savons que les utilisateurs n'interrogent qu'un sous-ensemble de lignes de la table. Dans le cas d'IMDb, il se peut que les utilisateurs soient plus susceptibles d'interroger un film qui vient de sortir plut\u00f4t qu'un film vieux de 15 ans. Essayons de cr\u00e9er un index partiel qui stocke les titres des films sortis en 2023.</li> </ul> <pre><code>CREATE INDEX \"recents\" ON \"movies\" (\"titles\")\nWHERE \"year\" = 2023;\n</code></pre> <ul> <li>Nous pouvons v\u00e9rifier que la recherche de films sortis en 2023 utilise le nouvel index.</li> </ul> <pre><code>EXPLAIN QUERY PLAN\nSELECT \"title\" FROM \"movies\"\nWHERE \"year\" = 2023;\n</code></pre> <p>Cela nous montre que la table <code>movies</code> est scann\u00e9e en utilisant l'index partiel.</p>"},{"location":"cours6/#questions_1","title":"Questions","text":"<p>Les index sont-ils sauvegard\u00e9s dans le sch\u00e9ma ?</p> <ul> <li>Oui, dans SQLite, ils le sont ! Nous pouvons le confirmer en ex\u00e9cutant <code>.schema</code> et nous verrons les index cr\u00e9\u00e9s list\u00e9s dans le sch\u00e9ma de la base de donn\u00e9es.</li> </ul>"},{"location":"cours6/#vacuum","title":"Vacuum","text":"<ul> <li>Il existe des moyens de supprimer l'espace inutilis\u00e9 dans notre base de donn\u00e9es. SQLite nous permet de \"vacuumiser\" les donn\u00e9es \u2014 cela nettoie les donn\u00e9es pr\u00e9c\u00e9demment supprim\u00e9es (qui ne sont en fait pas supprim\u00e9es, mais simplement marqu\u00e9es comme espace disponible pour la prochaine <code>INSERT</code>).</li> <li>Pour trouver la taille de <code>movies.db</code> sur le terminal, nous pouvons utiliser une commande Unix</li> </ul> <pre><code>du -b movies.db\n</code></pre> <ul> <li>Dans le cours, cette commande nous a montr\u00e9 que la taille de la base de donn\u00e9es est d'environ 158 millions d'octets, soit 158 m\u00e9gaoctets.</li> <li>Nous pouvons maintenant nous connecter \u00e0 notre base de donn\u00e9es et supprimer un index que nous avions pr\u00e9c\u00e9demment cr\u00e9\u00e9.</li> </ul> <pre><code>DROP INDEX \"person_index\";\n</code></pre> <ul> <li>Maintenant, si nous ex\u00e9cutons \u00e0 nouveau la commande Unix, nous constatons que la taille de la base de donn\u00e9es n'a pas diminu\u00e9 ! Pour r\u00e9ellement nettoyer l'espace supprim\u00e9, nous devons le vacuumiser. Nous pouvons ex\u00e9cuter la commande suivante dans SQLite.</li> </ul> <pre><code>VACUUM;\n</code></pre> <p>Cela peut prendre une seconde ou deux pour s'ex\u00e9cuter. En ex\u00e9cutant \u00e0 nouveau la commande Unix pour v\u00e9rifier la taille de la base de donn\u00e9es, nous devrions voir une taille plus petite. Une fois que nous avons supprim\u00e9 tous les index et vacuumis\u00e9 \u00e0 nouveau, la base de donn\u00e9es sera consid\u00e9rablement plus petite que 158 Mo (dans le cours, environ 100 Mo).</p>"},{"location":"cours6/#questions_2","title":"Questions","text":"<p>Est-il possible de vacuumiser plus rapidement ?</p> <ul> <li>Chaque vacuumisation peut prendre une quantit\u00e9 de temps diff\u00e9rente, en fonction de la quantit\u00e9 d'espace que nous essayons de vacuumiser et de la facilit\u00e9 avec laquelle nous pouvons trouver les bits et les octets qui doivent \u00eatre lib\u00e9r\u00e9s !</li> </ul> <p>Si une requ\u00eate pour supprimer certaines lignes ne les supprime pas r\u00e9ellement, mais les marque seulement comme supprim\u00e9es, pourrions-nous toujours r\u00e9cup\u00e9rer ces lignes ?</p> <ul> <li>Les personnes form\u00e9es \u00e0 la m\u00e9decine l\u00e9gale sont capables de trouver des donn\u00e9es que nous pensons supprim\u00e9es mais qui sont en fait toujours sur nos ordinateurs. Dans le cas de SQLite, apr\u00e8s avoir effectu\u00e9 un vacuum, il ne serait plus possible de retrouver les lignes supprim\u00e9es.</li> </ul>"},{"location":"cours6/#concurrence","title":"Concurrence","text":"<ul> <li>Jusqu'\u00e0 pr\u00e9sent, nous avons vu comment optimiser des requ\u00eates individuelles. Maintenant, nous allons voir comment permettre non seulement une requ\u00eate, mais plusieurs \u00e0 la fois.</li> <li>La concurrence est la gestion simultan\u00e9e de plusieurs requ\u00eates ou interactions par la base de donn\u00e9es. Imaginez une base de donn\u00e9es pour un site web, ou un service financier, qui re\u00e7oit beaucoup de trafic en m\u00eame temps. La concurrence est particuli\u00e8rement importante dans ces cas.</li> <li>Certaines transactions de base de donn\u00e9es peuvent \u00eatre multipartites. Par exemple, consid\u00e9rons la base de donn\u00e9es d'une banque. Voici une vue de la table <code>accounts</code> qui stocke les soldes des comptes.</li> </ul> <ul> <li>Une transaction pourrait consister \u00e0 envoyer de l'argent d'un compte \u00e0 un autre. Par exemple, Alice essaie d'envoyer 10 $ \u00e0 Bob.</li> <li>Pour compl\u00e9ter cette transaction, nous devrions ajouter 10 $ au compte de Bob et \u00e9galement soustraire 10 $ du compte d'Alice. Si quelqu'un voit l'\u00e9tat de la base de donn\u00e9es <code>accounts</code> apr\u00e8s la premi\u00e8re mise \u00e0 jour du compte de Bob mais avant la deuxi\u00e8me mise \u00e0 jour du compte d'Alice, il pourrait obtenir une compr\u00e9hension incorrecte du montant total d'argent d\u00e9tenu par la banque.</li> </ul>"},{"location":"cours6/#transactions","title":"Transactions","text":"<ul> <li>Pour un observateur ext\u00e9rieur, il devrait sembler que les diff\u00e9rentes parties d'une transaction se produisent toutes en m\u00eame temps. En termes de bases de donn\u00e9es, une transaction est une unit\u00e9 individuelle de travail \u2014 quelque chose qui ne peut pas \u00eatre d\u00e9compos\u00e9 en morceaux plus petits.</li> <li>Les transactions ont certaines propri\u00e9t\u00e9s, qui peuvent \u00eatre rappel\u00e9es en utilisant l'acronyme ACID :</li> <li>atomicit\u00e9 : ne peut pas \u00eatre d\u00e9compos\u00e9e en morceaux plus petits,</li> <li>coh\u00e9rence : ne doit pas violer une contrainte de base de donn\u00e9es,</li> <li>isolation : si plusieurs utilisateurs acc\u00e8dent \u00e0 une base de donn\u00e9es, leurs transactions ne peuvent pas interf\u00e9rer les unes avec les autres,</li> <li>durabilit\u00e9 : en cas de d\u00e9faillance dans la base de donn\u00e9es, toutes les donn\u00e9es modifi\u00e9es par les transactions resteront.</li> <li>Ouvrons <code>bank.db</code> dans notre terminal afin que nous puissions impl\u00e9menter une transaction pour transf\u00e9rer de l'argent d'Alice \u00e0 Bob !</li> <li>Tout d'abord, nous voulons voir les donn\u00e9es d\u00e9j\u00e0 pr\u00e9sentes dans la table <code>accounts</code>.</li> </ul> <pre><code>SELECT * FROM \"accounts\";\n</code></pre> <p>Nous notons ici que l'ID de Bob est 2 et celui d'Alice est 1, ce qui sera utile pour notre requ\u00eate. - Pour transf\u00e9rer 10 $ du compte d'Alice \u00e0 celui de Bob, nous pouvons \u00e9crire la transaction suivante.</p> <pre><code>BEGIN TRANSACTION;\nUPDATE \"accounts\" SET \"balance\" = \"balance\" + 10 WHERE \"id\" = 2;\nUPDATE \"accounts\" SET \"balance\" = \"balance\" - 10 WHERE \"id\" = 1;\nCOMMIT;\n</code></pre> <p>Remarquez que les instructions <code>UPDATE</code> sont \u00e9crites entre les commandes pour commencer la transaction et la valider. Si nous ex\u00e9cutons la requ\u00eate apr\u00e8s avoir \u00e9crit les instructions <code>UPDATE</code>, mais sans les valider, aucune des deux instructions <code>UPDATE</code> ne sera ex\u00e9cut\u00e9e ! Cela aide \u00e0 garder la transaction atomique. En mettant \u00e0 jour notre table de cette mani\u00e8re, nous ne pouvons pas voir les \u00e9tapes interm\u00e9diaires. - Si nous essayions d'ex\u00e9cuter \u00e0 nouveau la transaction ci-dessus \u2014 Alice essaie de payer Bob encore 10 $ \u2014 elle devrait \u00e9chouer car le solde du compte d'Alice est \u00e0 0. (La colonne <code>\"balance\"</code> dans <code>accounts</code> a une contrainte de v\u00e9rification pour s'assurer qu'elle a une valeur non n\u00e9gative. Nous pouvons ex\u00e9cuter <code>.schema</code> pour v\u00e9rifier cela.) - La mani\u00e8re dont nous impl\u00e9mentons l'annulation de la transaction est en utilisant <code>ROLLBACK</code>. Une fois que nous avons commenc\u00e9 une transaction et \u00e9crit quelques instructions SQL, si l'une d'elles \u00e9choue, nous pouvons la terminer avec un <code>ROLLBACK</code> pour revenir toutes les valeurs \u00e0 leur \u00e9tat pr\u00e9-transaction. Cela aide \u00e0 garder les transactions coh\u00e9rentes.</p> <pre><code>BEGIN TRANSACTION;\nUPDATE \"accounts\" SET \"balance\" = \"balance\" + 10 WHERE \"id\" = 2;\nUPDATE \"accounts\" SET \"balance\" = \"balance\" - 10 WHERE \"id\" = 1; -- Invokes constraint error\nROLLBACK;\n</code></pre>"},{"location":"cours6/#conditions-de-course","title":"Conditions de course","text":"<ul> <li>Les transactions peuvent aider \u00e0 se pr\u00e9munir contre les conditions de course.</li> <li>Une condition de course se produit lorsque plusieurs entit\u00e9s acc\u00e8dent simultan\u00e9ment \u00e0 une valeur partag\u00e9e et prennent des d\u00e9cisions bas\u00e9es sur celle-ci, potentiellement causant des incoh\u00e9rences dans la base de donn\u00e9es. Des conditions de course non r\u00e9solues peuvent \u00eatre exploit\u00e9es par des hackers pour manipuler la base de donn\u00e9es.</li> <li>Dans le cours, un exemple de condition de course est discut\u00e9 dans lequel deux utilisateurs travaillant ensemble peuvent exploiter des incoh\u00e9rences momentan\u00e9es dans la base de donn\u00e9es pour voler la banque.</li> <li>Cependant, les transactions sont trait\u00e9es en isolation pour \u00e9viter les incoh\u00e9rences d\u00e8s le d\u00e9part. Chaque transaction traitant des donn\u00e9es similaires de notre base de donn\u00e9es sera trait\u00e9e s\u00e9quentiellement. Cela aide \u00e0 pr\u00e9venir les incoh\u00e9rences qu'une attaque adversariale pourrait exploiter.</li> <li>Pour rendre les transactions s\u00e9quentielles, SQLite et d'autres syst\u00e8mes de gestion de bases de donn\u00e9es utilisent des verrous sur les bases de donn\u00e9es. Une table dans une base de donn\u00e9es pourrait \u00eatre dans quelques \u00e9tats diff\u00e9rents :</li> <li>UNLOCKED : c'est l'\u00e9tat par d\u00e9faut lorsqu'aucun utilisateur n'acc\u00e8de \u00e0 la base de donn\u00e9es,</li> <li>SHARED : lorsqu'une transaction lit des donn\u00e9es de la base de donn\u00e9es, elle obtient un verrou partag\u00e9 qui permet \u00e0 d'autres transactions de lire simultan\u00e9ment de la base de donn\u00e9es,</li> <li>EXCLUSIVE : si une transaction doit \u00e9crire ou mettre \u00e0 jour des donn\u00e9es, elle obtient un verrou exclusif sur la base de donn\u00e9es qui ne permet pas \u00e0 d'autres transactions de se produire en m\u00eame temps (pas m\u00eame une lecture).</li> </ul>"},{"location":"cours6/#questions_3","title":"Questions","text":"<p>Comment d\u00e9cidons-nous quand une transaction peut obtenir un verrou exclusif ? Comment priorisons-nous diff\u00e9rents types de transactions ?</p> <ul> <li>Diff\u00e9rents algorithmes pourraient \u00eatre utilis\u00e9s pour prendre ces d\u00e9cisions. Par exemple, nous pourrions toujours choisir la transaction qui est arriv\u00e9e en premier. Si une transaction exclusive est n\u00e9cessaire, aucune autre transaction ne peut s'ex\u00e9cuter en m\u00eame temps, ce qui est un inconv\u00e9nient n\u00e9cessaire pour assurer la coh\u00e9rence de la table.</li> </ul> <p>Quelle est la granularit\u00e9 du verrouillage ? Verrouillons-nous une base de donn\u00e9es, une table ou une ligne d'une table ?</p> <ul> <li>Cela d\u00e9pend du SGBD. Dans SQLite, nous pouvons le faire en ex\u00e9cutant une transaction exclusive comme suit :</li> </ul> <pre><code>BEGIN EXCLUSIVE TRANSACTION;\n</code></pre> <p>Si nous ne compl\u00e9tons pas cette transaction maintenant, et essayons de nous connecter \u00e0 la base de donn\u00e9es via un autre terminal pour lire depuis la table, nous obtiendrons une erreur indiquant que la base de donn\u00e9es est verrouill\u00e9e ! Cela, bien s\u00fbr, est une mani\u00e8re tr\u00e8s grossi\u00e8re de verrouiller car elle verrouille toute la base de donn\u00e9es. Comme SQLite est grossier de cette mani\u00e8re, il a un module pour prioriser les transactions et s'assurer qu'un verrou exclusif est obtenu uniquement pour la dur\u00e9e la plus courte n\u00e9cessaire.</p>"},{"location":"cours6/#fin","title":"Fin","text":"<ul> <li>Cela conclut le Cours 5 sur l'Optimisation en SQL !</li> </ul>"}]}